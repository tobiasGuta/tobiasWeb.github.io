<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <title>CTF Rooms</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Background container for animated GIF */
        .background-container {
    position: fixed; /* Cover the entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color:  #14161E; /* Dracula dark background */
    color: #f8f8f2; /* Light text color for contrast */
    font-family: 'Courier New', Courier, monospace; /* Monospace font for hacker aesthetic */
    z-index: -1; /* Ensure it stays behind other content */
}

        /* Main page styling */
        body {
            color: #00ff00;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            background: rgba(0, 0, 0, 0.85);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-x: hidden; /* Hide horizontal overflow */
            overflow-y: auto; /* Allow vertical scrolling */
        }

        /* Content styling */
        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-top: 120px;
            width: 100%;
        }

        /* Glitch Text Effect */
        .glitch-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            padding-top: 20px;
        }

        .glitch {
            font-size: 2.5em;
            color: #00ff00;
            animation: glitch 1s infinite;
            white-space: nowrap;
            position: relative;
        }

        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            color: #ff00ff;
            opacity: 0.8;
            clip: rect(0, 900px, 0, 0);
            animation: glitch 1s infinite;
        }

        .glitch::after {
            color: #00ffff;
            left: 2px;
            animation: glitch 1.2s infinite;
        }

        @keyframes glitch {
            0% { clip: rect(42px, 9999px, 44px, 0); transform: translate(0px, 0px); }
            20% { clip: rect(0px, 9999px, 44px, 0); transform: translate(2px, -2px); }
            40% { clip: rect(10px, 9999px, 38px, 0); transform: translate(-2px, 0px); }
            60% { clip: rect(15px, 9999px, 44px, 0); transform: translate(0px, 2px); }
            80% { clip: rect(30px, 9999px, 40px, 0); transform: translate(-1px, -1px); }
            100% { clip: rect(20px, 9999px, 40px, 0); transform: translate(1px, 1px); }
        }

        /* Room Section Styling */
        .room-section {
            border: 1px solid #00ff00;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            text-align: left;
            transition: transform 0.3s ease-in-out, margin 0.3s ease;
            width: 100%;
            max-width: 800px; /* Constrain width for larger screens */
        }

        /* When room section is expanded */
        .room-section.open {
            transform: scale(1.05);
            margin-bottom: 40px;
        }

        h2 {
            font-size: 1.5em;
            cursor: pointer;
        }

        h2:hover {
            color: #ffff00;
        }

        /* Collapsible content */
        .collapsible-content {
            display: none;
            padding-top: 10px;
            position: relative;
            animation: fadeIn 0.5s ease-in;
        }

        /* Fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hacking themed Back Button */
.back-button {
    background-color: transparent; /* Transparent background */
    color: white; /* White text by default */
    border: none; /* No border initially */
    padding: 12px 24px;
    border-radius: 5px;
    font-size: 1.2em;
    cursor: pointer;
    text-align: center;
    position: relative;
    overflow: hidden;
    outline: none; /* Remove the default outline (browser specific) */
    transition: color 0.3s, box-shadow 0.3s; /* Smooth transition for color and shadow */
}

/* Normal link hover (for back button) */
.back-button:hover {
    color: #2AF7A5; /* Change text color to #2AF7A5 */
    animation: pulse 1s infinite; /* Apply pulse effect */
    box-shadow: 0 0 10px #2AF7A5, 0 0 20px #2AF7A5, 0 0 30px #2AF7A5; /* Glowing effect */
    border: 2px solid #2AF7A5; /* Border appears only when hovering */
}

/* Pulse animation for hacker vibes */
@keyframes pulse {
    0% { 
        transform: scale(1);
        opacity: 1; 
    }
    50% { 
        transform: scale(1.1); 
        opacity: 0.8; 
    }
    100% { 
        transform: scale(1); 
        opacity: 1; 
    }
}

/* Back Button Container */
.back-button-container {
    position: relative;
    text-align: center;
    margin-top: 130px; /* Keep the position as it was */
}

        /* Navigation links styling */
        nav {
            display: inline-block;
            position: relative;
        }

        nav a {
            margin: 5px;
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            transition: background 0.3s;
        }

        nav a:hover {
            background: #00ff00;
            color: #1c1c1c;
        }

        /* Responsive styling for small screens (iPhone) */
        @media only screen and (max-width: 600px) {
            .glitch {
                font-size: 2em;
            }

            .glitch-container {
                padding-top: 10px;
            }

            h2 {
                font-size: 1.2em;
            }

            .room-section {
                padding: 10px;
                width: 90%;
                margin: 10px;
            }

            .back-button {
                font-size: 1em;
                margin-top: 70px;
                padding: 8px 16px;
            }

            .back-button-container {
                margin-top: 20px;
            }

            /* Ensure the back button stays centered */
            .content {
                margin-top: 70px;
            }

            .room-section h2 {
                font-size: 1.2em;
            }

            .collapsible-content {
                font-size: 0.9em;
                padding: 8px;
            }
        }
        .solution-button {
            background-color: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            margin-top: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: color 0.4s, background-color 0.4s;
            box-shadow: 0 0 5px #00ff00;
        }

        .solution-button:hover {
            color: #1c1c1c;
            background-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        .terminal {
      background-color: #1e1e1e; /* Dark terminal background */
      color: #d4d4d4; /* Light text for contrast */
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', Courier, monospace; /* Monospace font for terminal look */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); /* Subtle shadow for depth */
      overflow-x: auto; /* Handles long commands gracefully */
    }
    .prompt {
      color: #00ff00; /* Green color for the terminal prompt */
    }

/* General table styling */
table {
      width: 100%; /* Full-width table */
      margin: 20px auto;
      border-collapse: collapse;
      background-color: black;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Table header styling */
    th {
      background-color: #4CAF50;
      color: white;
      padding: 12px;
      text-align: left;
      font-size: 16px;
    }

    /* Table cell styling */
    td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
    }

    /* Hover effect for rows */
    tr:hover {
      background-color: black;
    }

    /* Styling for the first row */
    tr:first-child {
      border-top: 2px solid #4CAF50;
    }

    /* Responsive design for small screens */
    @media (max-width: 600px) {
      table {
        width: 100%; /* Full width */
        font-size: 12px; /* Smaller text */
        margin: 10px; /* Smaller margin */
      }

      th, td {
        padding: 8px; /* Less padding */
      }

      th {
        font-size: 14px;
      }

      td {
        font-size: 12px;
      }

      /* Add horizontal scrolling for small screens */
      .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on mobile */
      }

      table {
        min-width: 600px; /* Prevent table from getting too small */
      }
    }
    </style>
</head>
<body>
    <!-- Background Container -->
    <div class="background-container"></div>

    <!-- Glitch Heading -->
    <div class="glitch-container">
        <h1 class="glitch" data-text="CTF Rooms & Sec Tips">CTF Rooms & Sec Tips</h1>
    </div>

    <div class="back-button-container">
        <button class="back-button" onclick="window.location.href='index.html'">
            <i class="fas fa-users"></i> Intro
        </button>
    </div>
    

    <!-- Content with Room Sections -->
    <div class="content">

<!-- Room 1 -->
<div class="room-section">
    <h2 onclick="toggleContent('room1')">Tryhackme: Summit 🚀</h2>
    <div id="room1" class="collapsible-content">
        <img src="summit.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Can you chase a simulated adversary up the Pyramid of Pain until they finally back down?</p>
        <p><strong>Challenge Approach:</strong> The tester will be attempting to execute malware samples on a simulated internal user workstation. At the same time, you will need to configure PicoSecure's security tools to detect and prevent the malware from executing.</p>
        
        <!-- Question 1 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the first flag you receive after successfully detecting sample1.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q1" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl1[.]exe to see what we can find.</p>
            <img src="sample1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus doesn't do much damage, so we can block it by using its hash: MD5 cbda8ae000aa9cbe7c8b982bae006c2a</p>
            <img src="hasblock.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q1', event)">Show Solution</button>

        <!-- New Question 2 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the second flag you receive after successfully detecting sample2.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q2" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="sample2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="sample22.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does more things, such as networking activity like making GET requests to an IP and establishing connections.</p>
            <img src="firewal.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a firewall rule to block any connection to a specific IP.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q2', event)">Show Solution</button>

        <!-- New Question 3 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the third flag you receive after successfully detecting sample3.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q3" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl3[.]exe to see what we can find.</p>
            <img src="dnns.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus also makes requests, but this time to specific domains instead of direct IP addresses. This method is advantageous for hackers because it helps them hide their true IP address, making it harder for security systems to trace the origin of the attack. By using domain names, attackers can also leverage techniques like Dynamic DNS or cloud-based services to further obscure their location.</p>
            <img src="dnsrule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a DNS rule to block any connection to this Domain, Creating a DNS rule to block a domain involves configuring your network or firewall to prevent any device on your network from resolving a specific domain to its associated IP address. When a device tries to access a domain, the DNS server translates the domain name into an IP address. By creating a DNS block rule, you're essentially telling the DNS server to deny the request to resolve that domain, making it impossible for the malware or malicious activity to reach its destination.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q3', event)">Show Solution</button>

        <!-- New Question 4 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fourth flag you receive after successfully detecting sample4.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q4" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="email4.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl4[.]exe to see what we can find.</p>
            <img src="registrac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does even worse things, such as modifying the registry at Microsoft\Windows Defender\Real-Time Protection. This is the key for Windows Defender's Real-Time Protection. By tampering with it, the virus disables Windows Defender, preventing it from alerting the user to any malicious activity.</p>
            <img src="sigmarule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect this type of event, Sigma rules are a standardized, flexible way to define detection logic for various security events across different security platforms. They are designed to be platform-agnostic, meaning they can be used with any SIEM (Security Information and Event Management) system to identify suspicious activities.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q4', event)">Show Solution</button>
        
        <!-- New Question 5 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fifth flag you receive after successfully detecting sample5.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q5" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a log file</p>
            <img src="mail5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="logfile.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl5[.]exe to see what we can find.</p>
            <img src="sample5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is even worse because it makes a lot of POST requests to a specific IP. To avoid detection, it establishes a connection every 30 minutes and sends a request of size 97 bytes. It's like it's communicating with a C2 (Command and Control) server</p>
            <img src="c2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect and block any attempts to connect to this specific Command and Control (C2) server. Sigma rules allow us to define detection patterns for suspicious activities across different security platforms. In this case, the rule would be designed to identify any network traffic trying to establish a connection with the identified C2 server, and then block it to prevent the malware from communicating with its attacker. By implementing this rule, we can strengthen our defenses and prevent the malware from receiving further commands or exfiltrating data</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q5', event)">Show Solution</button>

        <!-- New Question 6 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the final flag you receive from Sphinx?</p>
        </div>

        <div class="solution-section" id="solution-room1-q6" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a  Commands log file </p>
            <img src="sample6.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="commandlog.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="comvir.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is running a series of commands on the infected system to gather important information. It collects system details and network configuration data, likely to be used for reconnaissance or further exploitation.</p>
            <img src="sigmareco.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect a specific string being run, in this case: %temp%\exfiltr8[.]log.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q6', event)">Show Solution</button>
    </div>
</div>





<!-- Room 2 -->
<div class="room-section">
    <h2 onclick="toggleContent('room2')">Tactical Detection 🛡️</h2>
    <div id="room2" class="collapsible-content">
        <img src="tacticaldetection.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> understand the mindset behind choosing a tactical approach in alerting and detecting threats, IOAs, IOCs, etc.</p>
        <p><strong>Challenge Approach:</strong> the most efficient ways to bolster an organization's security posture by leveraging detection mechanisms and walking the user through setting them up tactically. This should serve as a baseline where the user will be able to learn the basics, implement them in their functions, and make them truly their own.</p>
        <div class="question-section">
            <p><strong>Setting up a Basic Tripwire</strong></p>
        </div>

        <div class="solution-section" id="solution-room2" style="display: none;">
            <p><strong>Info:</strong> Open The local security policy application, then navigate to Security Settings → Local Policies → Audit Policy and Open the Audit object access policy.</p>
            <img src="localapplication.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Check the boxes next to Success and Failure, then click Apply and OK to ensure that all access attempts—whether successful or not—will be logged. Once you're done, you can close the Local Security Policy application.</p>
            <img src="succandfai.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> After configuring the Local Security Policy, monitoring won’t start automatically. We need to specify which files or folders to track. To set this up, right-click on the desktop, choose New → Text Document, and name the file Secret Document.</p>
            <img src="note.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Infor:</strong>  Then, right-click the file, select Properties → Security → Advanced → Auditing to set up monitoring for this document in our tripwire configuration</p>
            <img src="properties.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This is where we will create and specify an audit entry for our Secret Document. Click on Add → Select a principal.</p>
            <img src="propertiesname.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This pop-up allows us to specify which users or groups we want to be notified about when they access the Secret Document. While you can be very specific, for this example, we’ll keep it simple. In the text box, type "Everyone" and press Enter to monitor all users.</p>
            <img src="propn.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="donevery.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> The Principal should now show "Everyone," and the permissions will allow you to specify which actions to audit on the Secret Document. For a broader selection, click Show advanced permissions in the top-right corner. Once you're done, click OK, then Apply and OK on the Audit entry page, and finally, click OK on the Secret Document properties. If you're tracking multiple files, it’s recommended to organize them into folders for easier auditing. The setup is now complete, and auditing is active for the Secret Document. Any access attempts will be logged in the Security event log with Event ID 4663, which can be filtered and used to generate alerts, allowing analysts to quickly detect when a tripwire is triggered, thereby enhancing the organization's security.</p>
            <img src="done.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Detecting:</strong> Now it's time to detect it.</p>
            <p><strong>Info:</strong> Let's open this file using CMD.</p>
            <img src="notcm.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Now, let's use the FullEventLogView application to view the logs.</p>
            <img src="loappl.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Lessons Learned:</strong> Applying tactical detection is important because it enables proactive monitoring of system activities and potential security threats in real-time. By auditing access to sensitive files, such as the Secret Document, and logging every interaction with them, you can quickly identify suspicious or unauthorized behavior. This helps in detecting potential security breaches early, enabling swift response and mitigation.</p>
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room2', event)">Show Solution</button>
    </div>
</div>

<!-- Room 3 -->
<div class="room-section">
    <h2 onclick="toggleContent('room3')">Tryhackme: Friday Overtime 🐼</h2>
    <div id="room3" class="collapsible-content">
        <img src="evilpanda.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> It's a Friday evening at PandaProbe Intelligence when a notification appears on your CTI platform. While most are already looking forward to the weekend, you realise you must pull overtime because SwiftSpend Finance has opened a new ticket, raising concerns about potential malware threats. The finance company, known for its meticulous security measures, stumbled upon something suspicious and wanted immediate expert analysis.</p>
        <p><strong>Challenge Approach:</strong> As the only remaining CTI Analyst on shift at PandaProbe Intelligence, you quickly took charge of the situation, realising the gravity of a potential breach at a financial institution. The ticket contained multiple file attachments, presumed to be malware samples. With a deep breath, a focused mind, and the longing desire to go home, you began the process of:</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room3" style="display: none;">
            <p><strong>Question:</strong> Who shared the malware samples?</p>
            <img src="emailpanda1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the file "pRsm.dll" inside samples.zip?</p>
            <img src="unzisam.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="shh1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Which MITRE ATT&CK Technique is linked to using pRsm.dll in this malware framework?</p>
            <img src="techniq.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="techni2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the CyberChef defanged URL of the malicious download location first seen on 2020-11-02? let's visit this site: hxxps[://]tinyurl[.]com/AptGroup for more information</p>
            <img src="url.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="urllin.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the CyberChef defanged IP address of the C&C server first detected on 2020-09-14 using these modules?</p>
            <img src="ippand.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the spyagent family spyware hosted on the same IP targeting Android devices on November 16, 2022?</p>
            <img src="checckip.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="androtar.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="andrhas.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room3', event)">Show Solution</button>
    </div>
</div>

<!-- Room 4 -->
<div class="room-section">
    <h2 onclick="toggleContent('room4')">Tryhackme: Trooper 
        <img src="https://flagcdn.com/w40/cn.png" alt="China Flag" width="20" height="15">
    </h2>
    <div id="room4" class="collapsible-content">
        <img src="grouptropper.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> A multinational technology company has been the target of several cyber attacks in the past few months. The attackers have been successful in stealing sensitive intellectual property and causing disruptions to the company's operations. A threat advisory report about similar attacks has been shared, and as a CTI analyst, your task is to identify the Tactics, Techniques, and Procedures (TTPs) being used by the Threat group and gather as much information as possible about their identity and motive. .</p>
        <p><strong>Challenge Approach:</strong> you will utilise the OpenCTI platform as well as the MITRE ATT&CK navigator</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room4" style="display: none;">
            <p><strong>Question:</strong> What kind of phishing campaign does APT X use as part of their TTPs?</p>
            <embed src="APT X_USBFerry.pdf" type="application/pdf" width="100%" height="500px">
            <p style="font-family: 'Courier New', monospace; color: #00ff00; text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;">
                If the PDF doesn’t display, 
                <a href="APT X_USBFerry.pdf" download style="color: #00ff00; text-decoration: none;">
                    click here to download it
                </a>
                <span class="cursor">|</span>.
            </p>
            <p><strong>Question:</strong> What is the name of the malware used by APT X?</p>
            <p><strong>Question:</strong>What is the malware's STIX ID?</p>
            <img src="usbb1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="usbb2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>With the use of a USB, what technique did APT X use for initial access?</p>
            <img src="subb3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the identity of APT X? </p>
            <img src="ggrroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>On OpenCTI, how many Attack Pattern techniques are associated with the APT?</p>
            <img src="attackpattern.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the name of the tool linked to the APT?</p>
            <img src="togroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Load up the Navigator. What is the sub-technique used by the APT under Valid Accounts?</p>
            <img src="locgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Under what Tactics does the technique above fall?</p>
            <img src="iatac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="tecgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What technique is the group known for using under the tactic Collection?</p>
            <img src="autgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room4', event)">Show Solution</button>
    </div>
</div>

<!-- Room 5 -->
<div class="room-section">
    <h2 onclick="toggleContent('room5')">Snort - Intrusion Detection System (IDS) and an Intrusion Prevention System (IPS) 🐷 </h2>
    <div id="room5" class="collapsible-content">
        <img src="snort.png" alt="Room 5 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Snort is a powerful open-source network intrusion detection system (IDS) and intrusion prevention system (IPS) developed by Martin Roesch and maintained by Cisco Systems. It analyzes network traffic in real-time, identifying suspicious patterns or behaviors that may indicate a security threat. With its extensive rule-based language, Snort can detect attacks, log malicious traffic, and even block it when configured as an IPS.</p>
        <p><strong>Challenge Approach:</strong> Setting up Snort</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room5" style="display: none;">
            <p><strong>Info:</strong>Let's start by installing Snort. You can find the information on this website: snort[.]org.</p>
            <p><strong>Installation:</strong> If you're using Linux, you can install Snort by running the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo apt install snort -y
            </div>
            <p><strong>Info:</strong>  Setting up Snort using the -X option for full packet dump mode.</p>
            <p><strong>Info:</strong>  These are different switches, such as verbose mode (-v), using the interface (-i), dumping packet data mode (-d), dump (-d), and link-layer header grabbing (-e).</p>
            <p><strong>Info:</strong> Sending a ping request to the machine to check if Snort is able to detect it</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -X
            </div>
            <img src="pin1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <div class="terminal">
                <span class="prompt">$</span> ping -c 5 VICTIM-IP
            </div>
            <img src="pin2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong>  Run Snort in Logger Mode.</p>
            <p><strong>Important:</strong> Before diving into generating and analyzing logs, it's crucial to understand Linux file ownership and permissions. Snort requires superuser (root) privileges to sniff network traffic. When you run Snort using the sudo command, any log files it creates will be owned by the root account. As a result, you'll need root privileges to access and analyze these log files.</p>
            <p><strong>Info:</strong>  Logging with parameter "-l".</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -l .
            </div>
            <p><strong>Info:</strong> Snort captures and logs packets to a specified directory, which can be set in the snort.config file. Alternatively, you can use the -l option to specify a custom directory for log files. While the default log directory is ideal for ongoing monitoring, the -l option is particularly handy for testing scenarios, For example, using -l . in the command saves the logs directly to the current working directory.</p>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                snort.log.123456789
            </div>
            <p><strong>Info:</strong> Logging with parameter "-K ASCII"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -K ASCII -l .
            </div>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                192.168.43.112  172.16.87.25  snort.log.123456789
            </div>
            <p><strong>Info:</strong> On examining the generated folders, you'll notice that the logs are stored in an organized, categorized format and saved as ASCII files. This means the logs can be easily read and analyzed directly, without requiring a Snort instance to interpret them.</p>
            <p><strong>Info:</strong> In ASCII mode, logs are stored in a human-readable format and split into multiple files, making it easy to view them with a simple text editor. On the other hand, logs in binary format are not readable by humans and must be analyzed using tools like Snort or tcpdump to make sense of the data.</p>
            <p><strong>Info:</strong> Reading generated logs with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r snort.log.123456789       
                <br>
                <br>
                Running in packet dump mode

                        --== Initializing Snort ==--
                Initializing Output Plugins!
                pcap DAQ configured to read-file.
                Acquiring network traffic from "snort.log.123456789".

                        --== Initialization Complete ==--
                ...
                Commencing packet processing (pid=3025)
                WARNING: No preprocessors configured for policy 0.
                12/02-08:15:05.567834 10.0.0.5 -> 8.8.8.8
                UDP TTL:128 TOS:0x10 ID:10045 IpLen:20 DgmLen:72
                SrcPort:55444 DstPort:53  
                DNS Query: www.example.com
                =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
                WARNING: No preprocessors configured for policy 0.
                12/02-08:16:12.789654 192.168.1.101 -> 93.184.216.34
                TCP TTL:64 TOS:0x0 ID:34560 IpLen:20 DgmLen:52 DF
                Seq:123456789  Ack:987654321 Win:8192
                Flags: S  SYN Packet
                ===============================================================================
                Packet I/O Totals:
                Received:           75
                Analyzed:           75 (100.000%)
                    Dropped:            0 (  0.000%)
                Filtered:            0 (  0.000%)
                Outstanding:            0 (  0.000%)
                Injected:            0
                ===============================================================================
                Breakdown by protocol (includes rebuilt packets):
                ...
                    Total:           75
                ===============================================================================
                Snort exiting
            </div>
            <p><strong>Inportant:</strong> It's important to note that Snort can process and interpret binary-format logs, which can also be viewed using tools like tcpdump and Wireshark. However, if you generate logs using the -K ASCII parameter, Snort will be unable to read them. As shown in the output above, Snort successfully read and displayed the log file in the same way it would when operating in sniffer mode.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo tcpdump -r snort.log.123456789 -ntc 10       
                <br>
                <br>
                reading from file snort.log.123456789, link-type EN10MB (Ethernet)
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [SYN] Seq=1 Ack=0 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [SYN, ACK] Seq=1 Ack=2 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [ACK] Seq=2 Ack=1 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: HTTP GET /index.html HTTP/1.1
                IP 10.1.2.3 > 192.168.0.5: HTTP 200 OK
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [FIN, ACK] Seq=1000 Ack=2000 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [FIN, ACK] Seq=2000 Ack=1001 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: UDP 12345 > 53 Len=50
                IP 10.1.2.3 > 192.168.0.5: UDP 53 > 12345 Len=50
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [RST] Seq=1000 Win=0 Len=0
            </div>
            <p><strong>Info:</strong> The -r parameter enables users to apply filters to binary log files. By using this parameter along with Berkeley Packet Filters (BPF), you can narrow down the processed logs to view only specific packets that match your filter criteria.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r myfile.log -X
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log icmp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log tcp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log 'udp and port 53'
            </div>
            <p><strong>Inportant:</strong> The result will be similar to the previous one, but it will display only packets that match the specified protocol. You can also control how many packets to process by using the -n parameter. For example, the following command will process just the first 10 packets from the log: </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dvr logname.log -n 10
            </div>
            <p><strong>Resources about BPF:</strong> https://tinyurl.com/42kymtty <br>https://tinyurl.com/2k4ha737<br>https://tinyurl.com/3nx43hpp<br></p>
            <p><strong>Important:</strong> IDS/IPS mode helps you manage the traffic according to user-defined rules, (N)IDS/IPS mode depends on the rules and configuration.</p>
            <p><strong>Info:</strong> NIDS mode parameters</p>
            <p><strong>paramater -c:</strong> Defining the configuration file.</p>
            <p><strong>paramater -T:</strong> Testing the configuration file.</p>
            <p><strong>paramater -N:</strong> Disable logging.</p>
            <p><strong>paramater -D:</strong> Background mode.</p>
            <p><strong>paramater -A:</strong> Alert modes;<br>full: Full alert mode, providing all possible<br>information about the alert. This one also is the default mode; once you use -A and don't specify any mode, snort uses this mode.<br>fast:  Fast mode shows the alert message, timestamp, source and destination IP, along with port numbers.<br>console: Provides fast style alerts on the console screen.<br>cmg: CMG style, basic header details with payload in hex and text format.<br>none: Disabling alerting<br></p>
            <p><strong>Info:</strong> Once you start running IDS/IPS mode, you need to use rules.</p>
            <p><strong>Rule ICMP:</strong> pre-defined ICMP rule as an example</p>
            <div class="terminal">
                <span class="prompt"></span> alert icmp any any <> any any  (msg: "ICMP Packet Found"; sid: 100001; rev:1;)
            </div>
            <p><strong>Info:</strong> This rule is located in "/etc/snort/rules/local.rules"</p>
            <p><strong>Info:</strong> Snort generates an "alert" file whenever it detects traffic that matches one of its alert rules. Additionally, when you run Snort in IPS (Intrusion Prevention System) or IDS (Intrusion Detection System) mode, its sniffing and logging functions operate in a semi-passive manner by default. To fully utilize these features, you can enable them explicitly using various parameters, such as:</p>
            <p><strong>paramaters:</strong><br>-i: Specify the network interface to monitor.<br>-v: Run in verbose mode to display packet details.<br>-d: Decode application layer data.<br>-e: Include link-layer information.<br>-X: Display full packet details in hexadecimal and ASCII.<br>-l: Define the logging directory.<br>-K ASCII: Save logs in plain text format for easier reading.<br></p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-N" (disable logging)</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -N
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump), the requested information will be displayed directly in the terminal. However, this means Snort won't save any logs to the designated log folder. Essentially, enabling these options redirects the output to the console instead of creating log files.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-D" background mode</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump) with packet logger mode (-l) you will still have the logs in the logs folder, but there will be no output in the console.</p>
            <p><strong>Info:</strong> Background mode will create a process, and you can check this process by executing this command in Linux:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -Dps -ef | grep snort
                <br>
                <br>
                root        1030    1800  0 02:05 ?        00:00:00 snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Info:</strong> If you want to kill this process, you need to execute the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo kill 1030
            </div>
            <p><strong>Important:</strong> It is not recommended to use this mode unless you have a working knowledge of Snort and stable configuration.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A console" </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A console
            </div>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A cmg"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A cmg
            </div>
            <p><strong>cmg mode:</strong> Cmg mode provides full packet details along with rule information.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A fast"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A fast
            </div>
            <p><strong>fast mode:</strong> fast style alerts contain summary information on the action like direction and alert header.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A full"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A full
            </div>
            <p><strong>full mode:</strong> full style alerts contain all possible information on the action.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A none"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A none
            </div>
            <p><strong>Important:</strong> here is no alert file. Snort only generated the log file.</p>
            <p><strong>Info:</strong> IDS/IPS mode: "Using rule file without configuration file"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/rules/local.rules -A console
            </div>
            <p><strong>Info:</strong> IPS mode and dropping packets</p>
            <p><strong>Note:</strong> To activate Snort in IPS mode, you can use the -Q parameter along with --daq afpacket. Alternatively, you can enable IPS mode by modifying the snort.conf file. The Data Acquisition (DAQ) modules are essential for IPS functionality. Using the afpacket module allows Snort to act as an IPS. For example, specify the interfaces like this: -i eth0:eth1. It's important to note that Snort in IPS mode requires at least two network interfaces—one for incoming traffic and another for outgoing traffic.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -Q --daq afpacket -i eth0:eth1 -A console
                <br>
                <br>
                10/14-02:30:50.80000  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.180.100.15 -> 192.180.100.114
            </div>
            <p><strong>Important:</strong> Snort is not just for monitoring network traffic, logging data, or identifying and blocking threats. It also has a feature called "PCAP read/investigate mode," which allows you to analyze PCAP files. When you load a PCAP file into Snort, it processes the data and provides you with traffic statistics by default, along with any alerts based on the rules you've set up. This means you can investigate network traffic that has already been captured in a PCAP file, not just live traffic.</p>
            <p><strong>Info:</strong> When you read a PCAP file without using any specific settings or parameters, Snort will just give you a basic overview of the packets and provide general statistics about the file. This is usually not very helpful. The real advantage of using Snort to analyze a PCAP file comes when you apply Snort's rules, which allow you to identify known threat patterns. This makes the investigation process faster and more efficient by automatically detecting potential threats based on these predefined patterns.</p>
            <p><strong>Snort Mode:</strong> PCAP mode parameters</p>
            <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>-r / --pcap-single=  </td>
                        <td>    Read a single pcap</td>
                    </tr>
                    <tr>
                        <td>--pcap-list=""  </td>
                        <td>    Read pcaps provided in command (space separated).</td>
                    </tr>
                    <tr>
                        <td>--pcap-show</td>
                        <td>    Show pcap name on console during processing.</td>
                    </tr>
                </tbody>
            </table>
            </div>
            <p><strong>Info:</strong> Investigating single PCAP with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n 10
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-list"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-show"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show 
                <br>
                <br>
                Reading network traffic from "icmp-test.pcap" with snaplen = 1514
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                Reading network traffic from "http2.pcap" with snaplen = 1514
                12/12-12:13:35.213176  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong>  snort identified the traffic, distinguished each pcap file and prompted the alerts according to our ruleset. </p>
            <p><strong>Question:</strong> How does a Snort rule really work?</p>
            <img src="snorul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> A Snort rule defines an action, protocol, source and destination IPs, source and destination ports, and options to specify conditions for detecting or responding to network traffic.</p>
            <p><strong>Important:</strong> By default, Snort operates in passive mode, meaning it only monitors network traffic and alerts you about suspicious activity, functioning as an Intrusion Detection System (IDS). To enable Intrusion Prevention System (IPS) functionality, where Snort can actively block malicious traffic, you need to switch it to "inline mode."</p>
            <p><strong>Info:</strong> The Snort rule structure is easy to understand but difficult to produce. You should be familiar with rule options and related details to create efficient rules. </p>
            <p><strong>Info:</strong> Rules cannot be processed without a header, which is mandatory, while rule options are optional. However, without using rule options, it becomes nearly impossible to detect complex or advanced attacks.</p>
            <div class="table-container">
            <table border="1">
                <tr>
                  <th>Component</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Action</b></td>
                  <td>There are different actions a rule can take. It's important to understand how they work and test them before applying rules to live systems. Common actions include:</td>
                </tr>
                <tr>
                  <td>Alert</td>
                  <td>Triggers an alert and logs the packet.</td>
                </tr>
                <tr>
                  <td>Log</td>
                  <td>Simply logs the packet without triggering an alert.</td>
                </tr>
                <tr>
                  <td>Drop</td>
                  <td>Blocks the packet and logs it for review.</td>
                </tr>
                <tr>
                  <td>Reject</td>
                  <td>Blocks the packet, logs it, and also terminates the session associated with the packet.</td>
                </tr>
                <tr>
                  <td><b>Protocol</b></td>
                  <td>This defines the type of protocol that the rule is designed to filter. Snort supports four protocols in the rules: IP, TCP, UDP, and ICMP. While specific protocols like FTP aren't directly available, you can filter traffic based on port numbers, such as TCP traffic on port 21 to detect FTP traffic.</td>
                </tr>
              </table>
            </div>
            <p><strong>Info:</strong> IP and Port Numbers</p>
            <p><strong>Note:</strong> These parameters identify the source and destination IP addresses and associated port numbers filtered for the rule.</p>
            <div class="table-container">
              <table border="1" style="width: 100%;">
                  <tr>
                    <th>Rule Type</th>
                    <th>Description</th>
                  </tr>
                  <tr>
                    <td><b>IP Filtering</b></td>
                    <td>This rule creates an alert for each ICMP packet originating from the 192.168.1.56 IP address.</td>
                  </tr>
                  <tr>
                    <td><b>Filter an IP Range</b></td>
                    <td>This rule creates an alert for each ICMP packet from the 192.168.1.0/24 subnet.</td>
                  </tr>
                  <tr>
                    <td><b>Filter Multiple IP Ranges</b></td>
                    <td>This rule creates an alert for each ICMP packet from either the 192.168.1.0/24 or 10.1.1.0/24 subnets.</td>
                  </tr>
                  <tr>
                    <td><b>Exclude IP Addresses/Ranges</b></td>
                    <td>This rule creates an alert for each ICMP packet not originating from the 192.168.1.0/24 subnet.</td>
                  </tr>
                  <tr>
                    <td><b>Port Filtering</b></td>
                    <td>This rule creates an alert for each TCP packet sent to port 21.</td>
                  </tr>
                  <tr>
                    <td><b>Exclude a Specific Port</b></td>
                    <td>This rule creates an alert for each TCP packet not sent to port 21.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 1)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to ports between 1-1024.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 2)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to ports less than or equal to 1024.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 3)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to source ports higher than or equal to 1025.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 4)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to port 21 or 23.</td>
                  </tr>
                </table>
              </div>
              <p><strong>Info:</strong> The direction operator indicates the traffic flow to be filtered by Snort. The left side of the rule shows the source, and the right side shows the destination. see the picture above</p>
              <div class="table-container">
              <table border="1" style="width: 30%;">
                <tr>
                  <th>Flow Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>-></b></td>
                  <td>Source to destination flow.</td>
                </tr>
                <tr>
                  <td><b><></b></td>
                  <td>Bidirectional flow.</td>
                </tr>
              </table>              
              <p><strong>Note:</strong> that there is no "<-" operator in Snort.</p>
              <p><strong>Info:</strong> three main rule options in Snort</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Option Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>General Rule Options</b></td>
                  <td>Fundamental rule options for Snort.</td>
                </tr>
                <tr>
                  <td><b>Payload Rule Options</b></td>
                  <td>Rule options that help investigate the payload data and detect specific payload patterns.</td>
                </tr>
                <tr>
                  <td><b>Non-Payload Rule Options</b></td>
                  <td>Rule options that focus on non-payload data to create specific patterns and identify network issues.</td>
                </tr>
              </table>
              </div>
              <p><strong>Info:</strong> General Rule Options</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Msg</b></td>
                  <td>The message field is a basic prompt and identifier for the rule. When triggered, it displays a summary of the event in the console or log.</td>
                </tr>
                <tr>
                  <td><b>Sid</b></td>
                  <td>Snort rule IDs (SID) must have a proper format and unique value. There are three scopes for SIDs:
                    <ul>
                      <li>&lt;100: Reserved rules</li>
                      <li>100-999,999: Rules that come with the build</li>
                      <li>&gt;=1,000,000: User-created rules</li>
                    </ul>
                    Rules created by users should have SIDs greater than 100,000,000, and each SID must be unique.</td>
                </tr>
                <tr>
                  <td><b>Reference</b></td>
                  <td>This field provides additional information or references, such as CVE IDs or external links, explaining the purpose of the rule or associated threat patterns. It helps analysts during alert investigations.</td>
                </tr>
                <tr>
                  <td><b>Rev</b></td>
                  <td>The rev field tracks rule revisions. Analysts can use this to understand rule improvements, as each rule has a unique revision number. No auto-backup is available, so analysts must maintain rule history manually.</td>
                </tr>
                <tr>
                  <td><b>Example Rule</b></td>
                  <td>alert icmp any any &lt;&gt; any any (msg: "ICMP Packet Found"; sid: 100001; reference: cve, CVE-XXXX; rev: 1;)</td>
                </tr>
              </table>    
              </div>          
              <p><strong>Info:</strong> Payload Detection Rule Options</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Content</b></td>
                  <td>Matches specific payload data by ASCII, HEX, or both. This option can be used multiple times in a rule. However, the more specific patterns you add, the more time it takes to investigate packets.</td>
                </tr>
                <tr>
                  <td><b>Example: ASCII Mode</b></td>
                  <td>Creates an alert for each HTTP packet containing the keyword "GET". Case-sensitive.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ASCII)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Example: HEX Mode</b></td>
                  <td>Creates an alert for HTTP packets with the HEX representation of "GET".</td>
                </tr>
                <tr>
                  <td><b>Example Rule (HEX)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"|47 45 54|"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Nocase</b></td>
                  <td>Disables case sensitivity in the content match, making searches more flexible.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Nocase)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; nocase; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Fast_pattern</b></td>
                  <td>Optimizes the content search by prioritizing a specific content match for faster packet analysis. It is case-insensitive and can only be used once per rule. It's especially useful when there are multiple content options.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Fast_pattern)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; fast_pattern; content:"www"; sid: 100001; rev:1;)</td>
                </tr>
              </table>    
              </div>           
              <p><strong>Info:</strong> Non-Payload Detection Rule Options</p>
              <p><strong>Note:</strong> There are rule options that focus on non-payload data. These options will help create specific patterns and identify network issues.</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>ID</b></td>
                  <td>Filters based on the IP ID field. The ID field can be used to identify packets with a specific IP identification number.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ID)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "ID TEST"; id:123456; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Flags</b></td>
                  <td>Filters based on TCP flags. The following flags can be used:
                    <ul>
                      <li>F - FIN</li>
                      <li>S - SYN</li>
                      <li>R - RST</li>
                      <li>P - PSH</li>
                      <li>A - ACK</li>
                      <li>U - URG</li>
                    </ul>
                  </td>
                </tr>
                <tr>
                  <td><b>Example Rule (Flags)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "FLAG TEST"; flags:S; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Dsize</b></td>
                  <td>Filters based on the packet payload size. You can define a size range or use conditions like greater than or less than a specified size.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Dsize)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SEQ TEST"; dsize:100<>300; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Sameip</b></td>
                  <td>Filters for duplication of source and destination IP addresses in the packet.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Sameip)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SAME-IP TEST"; sameip; sid: 100001; rev:1;)</td>
                </tr>
              </table>
              </div>              
              <p><strong>Important:</strong>  once you create a rule, it is a local rule and should be in your "local.rules" file. This file is located under "/etc/snort/rules/local.rules". </p>
              <div class="terminal">
                <span class="prompt">$</span> sudo nano /etc/snort/rules/local.rules 
            </div>
              <p><strong>Info:</strong>  That is your "local.rules" file. </p>
              <img src="locrul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>Info:</strong> Note that there are some default rules activated with snort instance. </p>
              <br>
              <br>
              <br>
              <br>
              <H1>Hands-on experience challenge.</H1>
              <p><strong>Problem:</strong> Write a single rule to detect "all TCP port 80 traffic" packets in the given pcap file.</p>
              <p><strong>My Rule:</strong> This is the rule that I have come for this challenge.
              <img src="mysnorule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <div class="terminal">
                <span class="prompt">$</span> alert tcp any any <> any 80 (msg: "detect port 80 trafic"; sid: 100001; rev:1;)
              </div>
              <p><strong>1:</strong> What is the number of detected packets?
              <img src="solvpac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="numbofpack.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>2:</strong> What is the destination address of packet 63?
              <p><strong>Info:</strong> Investigate the log file.
              <p><strong>Note:</strong> Remember that we have a lot of packages to analyze, so we need to find packet 63. This can be shortened by using the switch
              <img src="ques3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>3:</strong> What is the ACK number of packet 64?
              <img src="ques64.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>4:</strong> What is the SEQ number of packet 62?
              <img src="seq62.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>5:</strong> What is the TTL of packet 65??
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>6:</strong> What is the source IP of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>7:</strong> What is the source port of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a single rule to detect "all TCP port 21"
                <p><strong>8:</strong> What is the number of detected packets?
              <img src="detec21.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>9:</strong> What is the FTP service name?
              <img src="commandforx.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="readingservice.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect failed FTP login attempts
              <p><strong>10:</strong> What is the number of detected packets?
              <p><strong>Important:</strong> "For this, I would recommend using this link: https://tinyurl.com/ms9njv75
              <img src="530login.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect successful FTP logins
              <p><strong>11:</strong> What is the number of detected packets?
              <img src="230.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with a valid username but no password entered yet.
              <p><strong>12:</strong> What is the number of detected packets?
              <img src="331.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with the "Administrator" username but no password entered yet.
                <p><strong>13:</strong> What is the number of detected packets?
                <img src="ADMINYAYA.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room5', event)">Show Solution</button>
    </div>
</div>

<!-- Room 6 -->
<div class="room-section">
  <h2 onclick="toggleContent('room6')">Undertanding Cyber Kill Chain ⛓️ </h2>
  <div id="room6" class="collapsible-content">
      <img src="cyberkillchain.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> The Cyber Kill Chain is a systematic model developed by Lockheed Martin that outlines the stages of a cyberattack, providing organizations with a framework to understand, detect, and disrupt adversary activities. This chain highlights the steps attackers take, from initial reconnaissance to achieving their final objectives, such as data theft or operational disruption. By breaking the attack into stages, defenders can develop strategies to protect systems and stop adversaries before significant damage occurs.</p>
      <p><strong>Challenge Approach:</strong> Understanding and leveraging the Cyber Kill Chain requires knowledge of the Tactics, Techniques, and Procedures (TTPs) used by attackers. Tools like OpenCTI and the MITRE ATT&CK Navigator help security professionals map these TTPs to each stage of the chain, enabling precise identification of vulnerabilities and appropriate countermeasures. These platforms also allow analysts to cross-reference threat intelligence reports and gain insights into threat actor motives and methods, ultimately enhancing an organization's defensive posture.</p>

      <div class="solution-section" id="solution-room6" style="display: none;">
        <p><strong>Question:</strong> What is the Cyber Kill Chain?</p>
        <p>The Cyber Kill Chain is a framework that describes the steps attackers take to execute a cyberattack. It helps organizations understand the attacker’s workflow and identify opportunities to disrupt the attack. The chain includes seven stages: Recon, Weaponization, Delivery, Exploitation, Installation, Command and Control (C2), and Actions on Objectives. Understanding and intervening at each stage can prevent attacks from succeeding.</p>
        <p><strong>Question:</strong> What is the first stage of the Cyber Kill Chain?</p>
        <p><strong>1. Recon:</strong> During the reconnaissance stage, attackers gather information about their target. This could involve:
        <ul>
          <li>Passive Recon: Searching public sources (e.g., LinkedIn, Shodan, social media, company websites).</li>
          <li>Active Recon: Scanning for vulnerabilities, open ports, or exposed services using tools like Nmap or Nessus.</li>
        </ul>
        To protect against this stage:
        <ul>
          <li>Limit the information available publicly (e.g., remove unnecessary metadata from documents).</li>
          <li>Implement network monitoring to detect scanning activities.</li>
          <li>Use deception technologies, such as honeypots, to mislead attackers.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> What happens in the weaponization stage?</p>
        <p><strong>2. Weaponize:</strong> Attackers create a payload (e.g., malware, exploit) based on the information gathered. The payload is designed to exploit a vulnerability and deliver a foothold in the target system. For example, an attacker may create a malicious document with embedded macros.
        To protect against weaponization:
        <ul>
          <li>Maintain up-to-date patching to reduce exploitable vulnerabilities.</li>
          <li>Conduct threat intelligence to anticipate and block known malware types.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> How does the payload reach the target?</p>
        <p><strong>3. Delivery:</strong> In this stage, attackers deliver the payload to the victim. Common methods include phishing emails with malicious attachments, drive-by downloads from compromised websites, or physical methods like USB drives.
        To disrupt delivery:
        <ul>
          <li>Implement email filtering to detect and block phishing attempts.</li>
          <li>Educate employees about recognizing phishing and suspicious links.</li>
          <li>Limit access to unnecessary USB ports or external devices.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> What marks the transition from delivery to exploitation?</p>
        <p><strong>4. Exploitation:</strong> The delivered payload is executed on the victim’s machine, exploiting a vulnerability to gain access. For example, this could be a zero-day exploit or a macro-enabled document triggering malicious code.
        To mitigate exploitation:
        <ul>
          <li>Use application whitelisting to block unauthorized programs.</li>
          <li>Enforce strong user permissions and minimize admin rights.</li>
          <li>Deploy endpoint protection tools to detect suspicious activity.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> How does the attacker maintain their presence?</p>
        <p><strong>5. Installation:</strong> Malware is installed on the system, creating persistence. This could involve backdoors, droppers, or rootkits to maintain control of the compromised system.
        To disrupt installation:
        <ul>
          <li>Use application monitoring to detect unauthorized installations.</li>
          <li>Deploy anti-malware tools to identify and block malicious files.</li>
          <li>Conduct regular scans for anomalies in file integrity.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> What is the purpose of command and control (C2)?</p>
        <p><strong>6. Command and Control:</strong> Attackers establish a communication channel with the compromised machine. This allows them to issue commands, exfiltrate data, or download additional tools. They may use encrypted channels or legitimate protocols to avoid detection.
        To disrupt C2:
        <ul>
          <li>Monitor for unusual outbound connections or traffic patterns.</li>
          <li>Block access to known malicious IP addresses or domains.</li>
          <li>Use DNS filtering to prevent connections to malicious sites.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> What is the final stage of the Cyber Kill Chain?</p>
        <p><strong>7. Actions on Objectives:</strong> This is the attacker’s end goal, which may involve data exfiltration, deploying ransomware, or further lateral movement within the network.
        To protect against this stage:
        <ul>
          <li>Implement robust data encryption to protect sensitive information.</li>
          <li>Use monitoring tools to detect and respond to unusual data access or transfer.</li>
          <li>Conduct regular incident response drills to prepare for potential attacks.</li>
        </ul>
        </p>
        <p><strong>Question:</strong> Can the stages of the Cyber Kill Chain repeat?</p>
        <p>Yes, attackers may revisit earlier stages, such as recon or exploitation, to expand their foothold. For example, once inside the network, they might perform internal reconnaissance to find additional targets. 
        Proactively disrupting the attack early in the chain minimizes damage and reduces the attacker’s chances of success.</p>
      </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room6', event)">More</button>
  </div>
</div>

<div class="room-section">
  <h2 onclick="toggleContent('room7')">Incident Handling Process 👲 </h2>
  <div id="room7" class="collapsible-content">
      <img src="incidenthan.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> The Incident Handling Process is a systematic approach designed to help organizations respond to and recover from security incidents. The process consists of four stages: Preparation, Detection and Analysis, Containment/Eradication/Recovery, and Post-Incident Activities. It enables incident handlers to proactively prepare for potential threats, detect malicious events early, contain and recover from incidents effectively, and learn from past incidents to improve future responses. By following this cyclical process, organizations can ensure a swift and coordinated response to security breaches and minimize the impact of cyberattacks.</p>
      <p><strong>Challenge Approach:</strong> The Incident Handling Process requires a strong understanding of the tools, techniques, and procedures (TTPs) used during an incident. By utilizing frameworks like NIST’s guidelines and leveraging technologies for monitoring, detection, and recovery, organizations can stay ahead of potential threats. Incident response teams use these resources to identify compromised systems, mitigate ongoing attacks, and restore normal operations. After an incident, post-incident activities, such as lessons learned and root cause analysis, ensure that organizations can improve their preparedness for future attacks.</p>

      <div class="solution-section" id="solution-room7" style="display: none;">
        <p><strong>Question:</strong> What is the Incident Handling Process?</p>
        <p>The Incident Handling Process is a structured framework used by organizations to prepare for, detect, respond to, and learn from security incidents. It enables organizations to minimize damage, recover efficiently, and prevent similar incidents in the future. The process, as defined by NIST, has four key stages: Preparation, Detection and Analysis, Containment/Eradication/Recovery, and Post-Incident Activities. It is dynamic and cyclic, meaning steps may need to be revisited as new evidence arises.</p>
        <p><strong>Question:</strong> What are the stages of the Incident Handling Process?</p>
        <p><strong>1. Preparation:</strong> This stage focuses on equipping the organization with the tools, plans, and skills needed to respond to incidents. Examples include creating an incident response plan, conducting regular training, and ensuring the availability of key tools like firewalls, intrusion detection systems, and logging mechanisms.</p>
        <p><strong>2. Detection and Analysis:</strong> The focus here is identifying potential incidents and determining their scope and impact. Organizations monitor systems for unusual activities using tools like SIEMs, analyze logs, and use threat intelligence to identify malicious events. Quick and accurate detection is critical to minimize damage.</p>
        <p><strong>3. Containment, Eradication, and Recovery:</strong> After an incident is identified, this stage focuses on stopping the threat (containment), removing it (eradication), and restoring systems to normal operations (recovery). For example, isolating infected machines, removing malware, and restoring clean backups.</p>
        <p><strong>4. Post-Incident Activities:</strong> Once the incident is resolved, the organization documents the cause, impact, and response actions in an incident report. A "lessons learned" session is conducted to identify improvements in processes and defenses to prevent similar incidents in the future.</p>
        <p><strong>Question:</strong> Why is the process considered cyclic?</p>
        <p>The Incident Handling Process is cyclic because, as new evidence is uncovered, teams may need to revisit earlier stages. For example, during recovery, additional infected machines might be discovered, requiring further containment and analysis. This ensures no gaps are left in the response process.</p>
        <p><strong>Question:</strong> What are the two main activities in incident handling?</p>
        <p><strong>1. Investigation:</strong> This involves determining the "patient zero" (the first system compromised), understanding the attacker’s tools and techniques, and documenting affected systems and actions.</p>
        <p><strong>2. Recovery:</strong> After the investigation, organizations create and execute a recovery plan to remove threats and restore systems. Normal business operations should resume as quickly as possible.</p>
        <p><strong>Question:</strong> What happens after the incident is resolved?</p>
        <p>Once an incident is fully handled, a detailed report is created to document the cause, impact, and response actions. Additionally, "lessons learned" activities are conducted to identify weaknesses in current defenses and implement measures to prevent future incidents of the same nature.</p>
        <h1>the Preparation Stage</h1>

        <ol>
          <li><strong>Establishing Incident Handling Capability:</strong> This involves setting up a team and processes to effectively manage incidents when they occur. The team needs to be ready to identify, respond to, and mitigate security incidents in an organized way.</li>
          <li><strong>Implementing Protective Measures:</strong> Although incident handling is not responsible for protection, having protective measures in place is vital for minimizing the likelihood and impact of incidents. These measures include things like securing endpoints, hardening servers, using multi-factor authentication, and managing privileged access.</li>
        </ol>

        <p><strong>Preparation Prerequisites</strong></p>
        <p>Before an incident occurs, several foundational elements must be in place:</p>

        <ol>
          <li><strong>Skilled Incident Handling Team Members:</strong> The organization should have knowledgeable team members, either in-house or outsourced, who understand incident handling. At a minimum, basic knowledge must exist internally.</li>
          <li><strong>Trained Workforce:</strong> Employees should be trained through security awareness activities or other training programs to recognize and report potential incidents.</li>
          <li><strong>Clear Policies and Documentation:</strong> Written procedures and policies should cover incident handling steps, roles, responsibilities, and communication plans. These documents will guide the team during an actual incident.</li>
          <li><strong>Tools:</strong> Both software and hardware tools are necessary for incident handling, such as forensic tools, network capture tools, and communication systems.</li>
        </ol>

        <p><strong>Clear Policies and Documentation</strong></p>
        <p>The documentation created in the preparation phase must include the following:</p>

        <ul>
          <li><strong>Incident Handling Team Contacts:</strong> Ensure all team members' roles and contact info are clearly outlined.</li>
          <li><strong>Legal and Compliance Contacts:</strong> Information for the legal team, law enforcement, external teams, and other departments that may need to be contacted during or after an incident.</li>
          <li><strong>Incident Response Procedures:</strong> Well-defined response plans, including procedures for information sharing, escalation, and collaboration.</li>
          <li><strong>Baseline Information:</strong> Knowledge of system configurations and network diagrams to understand what's "normal" and to quickly spot deviations during an incident.</li>
          <li><strong>User Accounts with Elevated Privileges:</strong> Pre-configured accounts with necessary privileges to allow the incident team to act swiftly during an incident, and that can be disabled after the incident is resolved.</li>
          <li><strong>Procurement Flexibility:</strong> The ability to quickly acquire tools or resources without bureaucratic delays to avoid slowdowns during critical moments.</li>
          <li><strong>Forensic/Investigative Cheat Sheets:</strong> Predefined checklists or procedures to guide investigators during the forensic process, minimizing mistakes in the heat of the moment.</li>
          <li><strong>Compliance Knowledge:</strong> Familiarize the team with legal and compliance requirements related to incidents, such as data breach notification laws (e.g., GDPR).</li>
          <li><strong>Effective Reporting Capability:</strong> During an incident, accurate documentation is essential. Teams should document every step taken with precise timestamps, results, and personnel involved, focusing on the "who, what, when, where, why, and how."</li>
        </ul>

        <p><strong>Tools (Software & Hardware)</strong></p>
        <p>Having the right tools is crucial. These tools should enable the team to capture, preserve, and analyze evidence, as well as respond to incidents effectively:</p>

        <ul>
          <li><strong>Laptops/Workstations:</strong> Devices used for investigation, free of corporate security software (e.g., antivirus), to prevent interference with the analysis of malware.</li>
          <li><strong>Forensic Tools:</strong> Software for acquiring disk images, capturing memory, analyzing logs, and identifying Indicators of Compromise (IOCs).</li>
          <li><strong>Network Tools:</strong> Network capture and analysis tools, network cables, and switches for investigating network traffic during an incident.</li>
          <li><strong>Hardware Tools:</strong> Items like write blockers (to preserve evidence), screwdrivers, and power cables for dealing with physical devices or equipment during investigations.</li>
          <li><strong>Incident Handling System:</strong> A system for tracking incidents, documenting actions, and managing the incident lifecycle.</li>
          <li><strong>Jump Bag:</strong> A portable set of tools that the team can grab quickly to respond to an incident without wasting time gathering resources.</li>
        </ul>

        <p><strong>Additional Considerations</strong></p>
        <ul>
          <li><strong>Independent Documentation System:</strong> It's critical that the incident documentation system is separate from the organization's infrastructure. This ensures that in case of a compromise, the documentation remains safe and available.</li>
          <li><strong>Communication Channels:</strong> Use communication tools that are separate from the organization's systems. If adversaries have control over your network, email and internal systems may be compromised, so secure external communication channels are needed.</li>
        </ul>
        <p><strong>Protecting Against Incidents</strong></p>
        <p>Although protecting against incidents isn't directly the responsibility of an incident handling team, it’s crucial for them to be aware of protection efforts. By understanding what protective measures are in place, they can better identify and analyze threats, and know where to look for evidence during an incident investigation.</p>

        <p><strong>Key Protective Measures</strong></p>

        <p><strong>DMARC (Domain-based Message Authentication, Reporting, and Conformance)</strong></p>
        <p><strong>Purpose</strong>: DMARC is an email protection mechanism that helps prevent phishing by verifying the authenticity of incoming emails. It works on top of <strong>SPF</strong> (Sender Policy Framework) and <strong>DKIM</strong> (DomainKeys Identified Mail).</p>
        <p><strong>How it works</strong>: If an email pretends to come from your organization, DMARC helps reject it before it reaches the recipient.</p>
        <p><strong>Challenge</strong>: While easy to set up, thorough testing is necessary to avoid blocking legitimate emails unintentionally. False positives can occur, especially with emails sent from third-party services that may fail DMARC checks.</p>

        <p><strong>Endpoint Hardening & EDR (Endpoint Detection and Response)</strong></p>
        <p><strong>Endpoint Hardening</strong>: This involves securing endpoint devices (like workstations and laptops), which are often the primary entry points for attackers. Recommended actions include:</p>
        <ul>
          <li>Disabling <strong>LLMNR</strong> and <strong>NetBIOS</strong> to reduce risks from local network-based attacks.</li>
          <li>Implementing <strong>LAPS</strong> (Local Administrator Password Solution) to manage admin privileges.</li>
          <li>Restricting <strong>PowerShell</strong> to prevent misuse by attackers.</li>
          <li>Enabling <strong>Attack Surface Reduction</strong> rules in security tools like <strong>Microsoft Defender</strong>.</li>
          <li>Whitelisting applications, which involves blocking the execution of unauthorized files from places like user directories.</li>
          <li>Using <strong>host-based firewalls</strong> to limit unnecessary network traffic.</li>
        </ul>
        <p><strong>EDR Solutions</strong>: Implement <strong>EDR</strong> tools to detect malicious behavior and provide deeper visibility into threats on endpoints.</p>

        <p><strong>Network Protection</strong></p>
        <p><strong>Network Segmentation</strong>: Isolating business-critical systems to prevent attackers from easily spreading across the network. Systems should only have access as required for their business function.</p>
        <p><strong>IDS/IPS</strong> (Intrusion Detection/Prevention Systems): These tools help detect and prevent malicious traffic. When <strong>SSL/TLS interception</strong> is used, these systems can analyze traffic content directly, improving detection accuracy.</p>
        <p><strong>Device Control</strong>: Implement solutions like <strong>802.1x</strong> or <strong>Conditional Access</strong> to ensure only approved devices can access the network.</p>

        <p><strong>Privilege Identity Management, MFA, and Strong Passwords</strong></p>
        <p><strong>Privilege Identity Management</strong>: Protect administrative accounts by reducing exposure to attacks that steal privileged credentials.</p>
        <p><strong>MFA (Multi-factor Authentication)</strong>: Implement MFA, particularly for administrative access to sensitive systems and applications.</p>
        <p><strong>Password Management</strong>: Encourage employees to use <strong>strong passphrases</strong> rather than weak passwords. Passphrases are longer and more difficult to guess, e.g., “i LIK3 my coffeE warm.” A combination of languages can enhance security further.</p>

        <p><strong>Vulnerability Scanning</strong></p>
        <p>Conduct continuous scans of your environment to identify vulnerabilities. Critical or high-risk vulnerabilities should be prioritized for patching. Systems that can’t be patched should be segmented to limit potential exposure.</p>

        <p><strong>User Awareness Training</strong></p>
        <p><strong>Security Awareness</strong>: Regularly train users to recognize and report suspicious activity. Conduct surprise tests like <strong>phishing</strong> simulations to gauge employee vigilance.</p>

        <p><strong>Active Directory Security Assessment</strong></p>
        <p><strong>Active Directory</strong> (AD) is often targeted for privilege escalation attacks. Conduct regular assessments of AD configurations and security controls to ensure that attackers can’t easily escalate their privileges.</p>
        <p><strong>Third-Party Audits</strong>: If the in-house team lacks expertise, hire third-party auditors to help identify vulnerabilities.</p>

        <p><strong>Purple Team Exercises</strong></p>
        <p><strong>Purple Teaming</strong> combines the efforts of both red teams (attackers) and blue teams (defenders). These exercises help test the organization's security posture by simulating real-world attacks, identifying gaps in detection, and improving incident handling procedures.</p>
        <ul>
          <li><strong>Red Team</strong>: Simulates the attacks.</li>
          <li><strong>Blue Team</strong>: Works to detect, respond, and defend against the attacks.</li>
          <li><strong>Goal</strong>: Improve collaboration and effectiveness of both teams, enhance detection capabilities, and refine incident response playbooks.</li>
        </ul>
        <h1>Detection & Analysis Stage</h1>
        <p>At this point, we have created processes, procedures, and guidelines on how to act upon security incidents.</p>
        <p>The <strong>Detection & Analysis</strong> phase involves detecting an incident using various sources, such as sensors, logs, and trained personnel. It also includes information and knowledge sharing, as well as utilizing context-based threat intelligence. Additionally, segmentation of the architecture and having clear visibility within the network are critical factors for effective detection.</p>

        <h3>Threat Detection Sources</h3>
        <p>Threats can be introduced to the organization via an infinite number of attack vectors, and detection can come from several sources:</p>
        <ul>
          <li><strong>Employee Reports</strong>: An employee noticing abnormal behavior.</li>
          <li><strong>Alerts from Tools</strong>: Alerts from tools like EDR, IDS, firewalls, SIEM, etc.</li>
          <li><strong>Threat Hunting</strong>: Proactively looking for threats.</li>
          <li><strong>Third-Party Notifications</strong>: A third-party organization notifying you that your systems may be compromised.</li>
        </ul>

        <h3>Levels of Detection</h3>
        <p>It’s crucial to create layers of detection across the network:</p>
        <ol>
          <li><strong>Network Perimeter Detection</strong>: Using firewalls, IDS/IPS systems at the perimeter, and demilitarized zones (DMZs).</li>
          <li><strong>Internal Network Detection</strong>: Using local firewalls, host intrusion detection/prevention systems (HIDS/HIPS), etc.</li>
          <li><strong>Endpoint Detection</strong>: Using antivirus software, endpoint detection & response (EDR) systems, etc.</li>
          <li><strong>Application Detection</strong>: Using application logs, service logs, etc.</li>
        </ol>

        <h3>Initial Investigation</h3>
        <p>When a security incident is detected, it’s essential to conduct some initial investigation to establish context before assembling the incident response team. Information must be gathered about:</p>
        <ul>
          <li>Date/Time of the incident and who reported it.</li>
          <li>How the incident was detected.</li>
          <li>What the incident is (e.g., phishing, system unavailability).</li>
          <li>Impacted systems (if relevant).</li>
          <li>Who accessed impacted systems and what actions were taken.</li>
          <li>Physical location, OS, IP addresses, hostnames, and system owner information.</li>
          <li>If malware is involved, include relevant information such as IP addresses, date/time of detection, malware type, and forensic data (e.g., file hashes, copies of the files).</li>
        </ul>

        <h3>Incident Timeline</h3>
        <p>With the gathered information, start building an <strong>incident timeline</strong>. This timeline keeps you organized and provides a clear picture of what happened. The events are time-sorted based on when they occurred, but later investigation might reveal evidence in an unordered sequence.</p>

        <div class="table-container">
          <table border="1" style="width: 30%;">
            <thead>
              <tr>
                <th>Date</th>
                <th>Time of the event</th>
                <th>Hostname</th>
                <th>Event Description</th>
                <th>Data Source</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>09/09/2021</td>
                <td>13:31 CET</td>
                <td>SQLServer01</td>
                <td>Hacker tool 'Mimikatz' detected</td>
                <td>Antivirus Software</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3>Incident Severity & Extent Questions</h3>
        <p>When handling a security incident, answer the following questions to assess the severity and extent:</p>
        <ul>
          <li>What is the exploitation impact?</li>
          <li>What are the exploitation requirements?</li>
          <li>Can any business-critical systems be affected?</li>
          <li>Are there suggested remediation steps?</li>
          <li>How many systems have been impacted?</li>
          <li>Is the exploit being used in the wild?</li>
          <li>Does the exploit have worm-like capabilities?</li>
        </ul>

        <h3>Incident Confidentiality & Communication</h3>
        <p>Incident-related information is highly confidential. All information should be kept on a need-to-know basis unless instructed otherwise. The appointed person will handle communication according to legal requirements.</p>
        <p>When an investigation begins, set expectations and goals, which may include the incident type, sources of evidence, and rough time estimates. As the investigation evolves, expectations and findings may change.</p>


          <p>In the <strong>Detection & Analysis</strong> stage, the focus is on understanding what happened during an incident and how it unfolded. It’s not enough to simply rebuild affected systems and move on. If we don't know how the attacker gained access or what was impacted, any remediation steps we take might not prevent them from regaining access. The goal is to figure out exactly how the adversary entered, what tools were used, and which systems were compromised. This detailed knowledge allows the response team to plan more effective remediation strategies that prevent the attack from recurring.</p>

          <h3>Investigation Process</h3>

          <p>The investigation starts with limited, initial information about the incident. Using this data, the incident handling team embarks on a <strong>cyclic process</strong> of investigation that iterates as new information is discovered. The three main steps in this process are:</p>

          <ol>
              <li><strong>Creation and usage of Indicators of Compromise (IOCs)</strong></li>
              <li><strong>Identification of new leads and impacted systems</strong></li>
              <li><strong>Data collection and analysis from the new leads and impacted systems</strong></li>
          </ol>

          <p>These steps are continuously repeated as more evidence comes in, refining the understanding of the attack.</p>

          <h3>Initial Investigation Data</h3>

          <p>The investigation must be based on reliable leads that are identified throughout the entire process. The initial phase is just the beginning. Investigators shouldn’t solely focus on one specific finding, such as a known malicious tool. Narrowing the investigation too early leads to incomplete conclusions and can miss important parts of the attack, resulting in a lack of full understanding of the incident’s impact.</p>

          <h3>Creation & Usage of IOCs</h3>

          <p><strong>Indicators of Compromise (IOCs)</strong> are evidence that an incident has taken place. These include things like IP addresses, file hashes, and file names. IOCs are used to track and document signs of compromise. OpenIOC and Yara are common standards used to create and share IOCs. Special tools, like Mandiant's IOC Editor, allow for creating and editing these indicators in a standardized format.</p>

          <p>Once IOCs are created, investigators use them with tools (native or third-party) to search for signs of compromise in systems. It's crucial to ensure that no privileged credentials are cached during this search process, as this can create new vulnerabilities. Using the correct tools that don't cache credentials (like WinRM or certain PowerShell commands) is essential during an investigation to avoid leaving traces on compromised systems.</p>

          <h3>Identification of New Leads & Impacted Systems</h3>

          <p>Once IOCs are applied to systems, hits (matches) can reveal additional compromised systems. However, not all hits will be directly related to the incident. Some may be false positives, or IOCs could be too broad. In such cases, investigators need to prioritize which systems to focus on, ideally starting with those that offer new leads that might be valuable in the investigation.</p>

          <h3>Data Collection & Analysis from New Leads & Impacted Systems</h3>

          <p>After identifying potentially impacted systems, data needs to be collected to understand the extent of the compromise. There are two main approaches to this:</p>

          <ul>
              <li><strong>Live Response</strong>: In this approach, the system is analyzed while it’s still running, collecting real-time data. This method is most commonly used, as it preserves running memory and other volatile data that might provide crucial evidence.</li>
              <li><strong>Shutting Down the System</strong>: In some cases, it may be necessary to shut down the system to prevent further harm. However, this risks losing valuable information stored in the system's volatile memory (RAM). Therefore, decisions on whether to shut down a system must be carefully considered.</li>
          </ul>

          <p>Regardless of the method, it’s vital to minimize interaction with the system to avoid altering or corrupting any evidence.</p>

          <p>Once the data is collected, it’s analyzed, which often involves tasks like malware analysis and disk forensics. The process can be time-consuming, but it’s crucial for identifying how the attack unfolded. Memory forensics has also become an increasingly important capability, especially in more sophisticated attacks.</p>

          <h3>Chain of Custody</h3>

          <p>During the entire investigation, maintaining a <strong>chain of custody</strong> is essential. This ensures that any evidence collected can be legally used in court, if necessary. Proper documentation of each step in the collection process helps maintain the integrity of the evidence.</p>

          <h2>1. Containment</h2>
          <p><strong>Containment</strong> refers to actions taken to prevent the incident from spreading and causing further damage. It is divided into <strong>short-term</strong> and <strong>long-term</strong> containment:</p>

          <h3>Short-term Containment</h3>
          <p>The goal here is to quickly stop the attack's spread while keeping the system as intact as possible to preserve evidence for investigation. Examples of short-term containment include:</p>
          <ul>
            <li><strong>Isolating affected systems</strong>: This could involve placing compromised systems in a separate network segment (VLAN) to prevent further communication with other systems.</li>
            <li><strong>Disconnecting from the network</strong>: Physically disconnecting systems from the network, such as pulling the network cables, can stop further exploitation.</li>
            <li><strong>Blocking Command and Control (C2) communication</strong>: If the attacker is using a specific domain or IP address for communication with compromised systems, redirecting or blocking that address can cut off the attacker's access.</li>
          </ul>

          <h3>Long-term Containment</h3>
          <p>This involves more permanent actions to ensure that the attacker cannot continue their activities in the system. Examples include:</p>
          <ul>
            <li><strong>Changing passwords</strong>: Especially for administrative accounts that may have been compromised.</li>
            <li><strong>Applying security patches</strong>: Fixing any vulnerabilities that were exploited during the attack.</li>
            <li><strong>Adding security monitoring</strong>: Implementing host intrusion detection systems (HIDS) and more comprehensive firewall rules to detect any new malicious activity.</li>
          </ul>
          <p>It's important that both short-term and long-term containment are coordinated across all impacted systems. Otherwise, the attacker might become aware of the response and change their tactics, evading detection.</p>

          <h2>2. Eradication</h2>
          <p><strong>Eradication</strong> focuses on completely removing the threat from the environment and fixing the root cause of the incident. The goal is to make sure the adversary is no longer present and that any remaining traces of the attack are eliminated.</p>
          <ul>
            <li><strong>Removing malware</strong>: Any malware discovered during the investigation phase should be completely removed from all affected systems.</li>
            <li><strong>Rebuilding systems</strong>: In some cases, it may be necessary to rebuild compromised systems from scratch to ensure that no hidden threats remain.</li>
            <li><strong>Restoring from backups</strong>: Systems that were heavily affected might need to be restored from known good backups.</li>
            <li><strong>Applying additional patches</strong>: If certain patches were not immediately applied during containment, they should be implemented now to further secure the system.</li>
            <li><strong>Hardening systems</strong>: Additional hardening measures (like improving system security configurations) should be taken to prevent similar attacks in the future.</li>
          </ul>

          <h2>3. Recovery</h2>
          <p><strong>Recovery</strong> involves bringing the affected systems back to normal operation. This stage focuses on ensuring that the systems are functional, secure, and able to support business operations once again. It's a careful and gradual process:</p>
          <ul>
            <li><strong>System verification</strong>: The business or the relevant stakeholders need to verify that the systems are functioning correctly and that they contain all necessary data. This ensures the systems are not only operational but also safe from compromise.</li>
            <li><strong>Reintroducing systems into the production environment</strong>: Once verified, the systems are returned to normal operations and connected back to the production environment.</li>
            <li><strong>Ongoing monitoring</strong>: After recovery, systems need to be monitored closely, as they are often prime targets for attackers looking to re-enter the environment. Suspicious events to look out for include:
              <ul>
                <li>Unusual login attempts (e.g., unfamiliar user accounts or service accounts).</li>
                <li>Unexpected or suspicious processes running on systems.</li>
                <li>Unauthorized changes to system settings, particularly in areas commonly altered by malware (e.g., system registries).</li>
              </ul>
            </li>
          </ul>

          <h3>Phased Recovery</h3>
          <p>In large-scale incidents, recovery may take a long time and can happen in phases. Early stages may focus on quick fixes like applying basic security measures (e.g., updating software, implementing firewalls), while later phases may focus on more permanent changes like improving overall security and performing system-wide hardening.</p>

          <h3>Post-Incident Activities</h3>
          <p>The recovery stage may also involve reviewing lessons learned and updating the organization’s incident response plan to better handle future attacks. During this time, the team will identify weaknesses in the existing defenses and work on improving security posture to prevent future incidents.</p>

          <h2>Key Takeaways</h2>
          <ul>
            <li><strong>Containment</strong> stops the spread of the incident and limits damage by isolating affected systems and applying immediate fixes.</li>
            <li><strong>Eradication</strong> removes the root cause of the issue, such as malware, vulnerabilities, and compromised data.</li>
            <li><strong>Recovery</strong> brings systems back online in a secure state while closely monitoring for any signs of the attacker trying to regain access.</li>
          </ul>
          <p>The main idea of these stages is to ensure that once the incident is contained, the organization works toward fully eradicating the threat and bringing systems back online securely, without leaving vulnerabilities that could be exploited again.</p>

          <h2>Post-Incident Activity Stage</h2>
          <p>The <strong>Post-Incident Activity Stage</strong> is the final phase of an incident response process, where the focus shifts from dealing with the immediate threat to learning from the experience and improving the organization’s response capabilities. The key objectives during this stage are to analyze what happened, document the incident, and reflect on how the response can be improved for future incidents. This stage also offers an opportunity to involve all the stakeholders who were part of the incident handling process to share insights and lessons learned. Here's a breakdown of the main components:</p>

          <h3>1. Objective of the Post-Incident Activity Stage</h3>
          <p>The primary goal here is to <strong>reflect and learn</strong> from the incident. By understanding the details of what happened, the actions taken, and their outcomes, the organization can strengthen its ability to respond to future incidents. This stage is typically conducted through a meeting where key team members and stakeholders (such as incident responders, security team, IT staff, legal team, etc.) gather to analyze the incident's impact and response effectiveness. The meeting usually takes place <strong>days after the incident</strong> once the incident report is complete.</p>

          <h3>2. Reporting</h3>
          <p>A <strong>final incident report</strong> is created at the end of this stage. This report provides a comprehensive overview of the incident and answers several important questions:</p>
          <ul>
            <li><strong>What happened and when?</strong>: Details about the incident timeline, the nature of the attack, and how it unfolded.</li>
            <li><strong>Team performance</strong>: How well did the team respond based on existing plans, playbooks, policies, and procedures? Were the responses effective, or were there any gaps?</li>
            <li><strong>Business involvement</strong>: Did the business respond quickly and provide necessary information? Were there any delays or obstacles that impacted the response?</li>
            <li><strong>Containment and eradication actions</strong>: What specific actions were taken to stop the incident and eliminate the threat?</li>
            <li><strong>Preventive measures</strong>: What steps can be taken to prevent a similar incident from happening in the future?</li>
            <li><strong>Detection and analysis improvements</strong>: What tools or resources are needed to better detect and analyze future incidents?</li>
          </ul>

          <h3>3. Measurable Results</h3>
          <p>By documenting the entire incident response, the report provides valuable metrics that help evaluate the effectiveness of the team and the incident response process. For example, it may provide:</p>
          <ul>
            <li>The number of incidents handled</li>
            <li>Time spent per incident</li>
            <li>The actions performed during each incident</li>
          </ul>
          <p>This data can also help identify trends, such as recurring issues or areas that require improvement in the response process.</p>

          <h3>4. Training and Knowledge Sharing</h3>
          <p>The post-incident phase is also an important time to <strong>train new team members</strong>. New hires can learn how experienced team members handled the incident, and what strategies were successful or needed improvement. This knowledge-sharing can help <strong>accelerate their learning</strong> and prepare them for future incidents.</p>

          <h3>5. Reevaluating Plans, Procedures, and Tools</h3>
          <p>During this stage, the organization should <strong>evaluate its internal processes</strong>. This includes:</p>
          <ul>
            <li>Whether the existing plans, playbooks, and procedures need to be updated based on the lessons learned.</li>
            <li>Reviewing the tools and resources used during the incident to identify gaps and assess whether better tools are needed in the future.</li>
            <li>Reassessing the <strong>team’s training</strong>, readiness, and structure. Are there areas where the team could improve its skill set? Are there gaps in knowledge or processes that need to be addressed?</li>
          </ul>

          <h3>6. Legal Considerations</h3>
          <p>In cases where legal action is needed, the incident report will be crucial. It can be used as a reference in legal proceedings and may help assess the <strong>financial and operational impact</strong> of the incident. For example, the report might be used to calculate damages or to determine whether a breach has violated laws or regulations.</p>

      </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room7', event)">More</button>
  </div>
</div>

<!-- Room 8 -->

<div class="room-section">
  <h2 onclick="toggleContent('room8')">Security Monitoring & SIEM 📝</h2>
  <div id="room8" class="collapsible-content">
      <img src="siemm.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> Gain insight into how SIEM solutions adopt a tactical approach to detect and alert on threats. This includes understanding the fundamentals of Indicators of Compromise (IOCs), Indicators of Attack (IOAs), and how to analyze them effectively to enhance security monitoring.</p>
      <p><strong>Challenge Approach:</strong> Explore the most efficient methods to strengthen an organization's security posture using SIEM’s detection mechanisms. This guide walks the user through setting up and fine-tuning these systems tactically. By understanding these processes, users will establish a foundational knowledge base, learn to implement detection strategies, and adapt them to suit their unique security requirements.</p>

      <div class="solution-section" id="solution-room8" style="display: none;">
        <p><strong>What Is SIEM?</strong></p>
        <p>SIEM is a system used to keep computers, networks, and digital data safe by monitoring, managing, and analyzing security events and data. It combines software tools that collect and process security data from different devices like servers, firewalls, and applications. These tools help security teams spot threats quickly, sometimes even before they happen, allowing for faster responses to security incidents. SIEM systems are essential for protecting a company’s digital environment and are a key part of an organization's overall security strategy.</p>
        <img src="https://academy.hackthebox.com/storage/modules/211/elastic.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="https://academy.hackthebox.com/storage/modules/211/elastic1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">

        <p><strong>The Evolution of SIEM Technology</strong></p>
        <p>SIEM technology started as two separate concepts—SIM (Security Information Management) and SEM (Security Event Management)—both of which had their own specialized ways of collecting and analyzing security data. In 2005, two analysts combined these technologies to create SIEM, a more comprehensive solution that handles both data collection and event monitoring. SIEM systems today help organizations keep track of and analyze logs and security events from various sources to detect and manage threats more effectively.</p>
        
        <p><strong>How Does SIEM Work?</strong></p>
        <p>SIEM systems gather security data from different sources like computers, network devices, and servers. This data is then standardized and organized so that it’s easy to analyze. Security experts use SIEM to look for patterns that could indicate a security issue. When a potential threat is detected, the system sends an alert to the IT security team, who investigate further. SIEM systems are designed to reduce the overwhelming number of alerts that could happen by filtering out less critical issues and focusing on the most urgent threats. Unlike other tools like Intrusion Detection Systems (IDS), SIEM collects and processes data from many sources to give a complete view of security events.</p>
        
        <p><strong>Key Functions of SIEM</strong></p>
        <div class="table-container">
        <table border="1" style="width: 100%;">
            <tr>
                <th><strong>Function</strong></th>
                <th><strong>Description</strong></th>
            </tr>
            <tr>
                <td><strong>Log Aggregation and Normalization</strong></td>
                <td>SIEM systems collect logs from various sources and convert them into a common format. This helps the security team easily analyze and track potential security incidents.</td>
            </tr>
            <tr>
                <td><strong>Threat Alerting</strong></td>
                <td>When a threat is identified, SIEM notifies security teams with alerts, making it easier for them to act quickly and prevent or limit damage.</td>
            </tr>
            <tr>
                <td><strong>Contextualization & Response</strong></td>
                <td>Instead of overwhelming security teams with too many alerts, SIEM systems provide context for the threats, helping teams understand the importance of each alert and prioritize responses.</td>
            </tr>
            <tr>
                <td><strong>Compliance</strong></td>
                <td>SIEM also helps organizations comply with regulations like HIPAA and GDPR by ensuring proper monitoring, analysis, and reporting of security data.</td>
            </tr>
        </table>
        </div>
        
        <p><strong>Benefits of Using a SIEM</strong></p>
        <p>Using SIEM offers several important advantages. It gives security teams a centralized view of all security-related data, allowing them to spot potential threats that may have been missed otherwise. It can also help detect threats before they become full-blown attacks, saving the organization from financial losses and reputational damage. Additionally, SIEM helps businesses comply with legal and regulatory standards, ensuring that logs and security events are properly recorded and monitored.</p>
        
        <h1>What is the Elastic Stack?</h1>
    <p>The Elastic Stack, created by Elastic, is an open-source collection of tools primarily comprising three key components: Elasticsearch, Logstash, and Kibana. These tools work together to provide a comprehensive solution for real-time data search, analysis, and visualization from log files and other data sources.</p>

    <p>In larger, resource-intensive environments, the Elastic Stack can integrate with tools like Kafka, RabbitMQ, Redis (for buffering and resiliency), and nginx (for enhanced security).</p>

    <h2>Components of the Elastic Stack</h2>

    <h3>1. Elasticsearch</h3>
    <p><strong>Elasticsearch</strong> is a distributed, JSON-based search engine with RESTful APIs. It serves as the core of the Elastic Stack and is responsible for:</p>
    <ul>
        <li>Indexing, storing, and querying data.</li>
        <li>Enabling advanced search and analytics capabilities on the data processed by Logstash.</li>
    </ul>

    <h3>2. Logstash</h3>
    <p><strong>Logstash</strong> is a data collection and processing tool designed to:</p>
    <ul>
        <li><strong>Collect:</strong> Gather log data from various sources (e.g., files, TCP sockets, syslogs).</li>
        <li><strong>Transform:</strong> Normalize and enrich log data using filters and predefined conditions.</li>
        <li><strong>Transport:</strong> Send processed data to Elasticsearch for storage and analysis.</li>
    </ul>

    <h3>3. Kibana</h3>
    <p><strong>Kibana</strong> is a visualization tool used to explore and analyze data stored in Elasticsearch. It offers:</p>
    <ul>
        <li>Custom dashboards, charts, and tables for better insights.</li>
        <li>An intuitive interface to run queries and interact with data visually.</li>
    </ul>

    <h3>4. Beats</h3>
    <p><strong>Beats</strong> are lightweight data shippers designed to forward logs and metrics from remote machines to Logstash or Elasticsearch.</p>

    <p><strong>Data flow examples:</strong></p>
    <div>
        <ul>
            <li>Beats -> Logstash -> Elasticsearch -> Kibana</li>
            <img src="https://academy.hackthebox.com/storage/modules/211/beats1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <li>Beats -> Elasticsearch -> Kibana</li>
            <img src="https://academy.hackthebox.com/storage/modules/211/beats2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </ul>
    </div>

    <h2>Using Elastic Stack as a SIEM Solution</h2>
    <p>The Elastic Stack is often implemented as a Security Information and Event Management (SIEM) solution. It allows for:</p>
    <ul>
        <li>Ingestion of security-related data from sources like firewalls, IDS/IPS, and endpoints using Logstash.</li>
        <li>Storing and indexing security data in Elasticsearch.</li>
        <li>Creating dashboards in Kibana for analyzing and visualizing security events.</li>
    </ul>
    <img src="https://academy.hackthebox.com/storage/modules/211/discover.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">

    <h2>Kibana Query Language (KQL)</h2>
    <p><strong>What is KQL?</strong> It is a user-friendly query language for running searches in Kibana. Here’s how it works:</p>
    <ul>
        <li><strong>Basic Structure:</strong> Queries are written in <code>field:value</code> format. Example:
            <div class="terminal">
                <span class="prompt"></span> event.code:4625
            </div>
        </li>
        <li><strong>Free Text Search:</strong> Search for terms across fields without specifying a field name. Example:
            <div class="terminal">
                <span class="prompt"></span> "svc-sql1"
            </div>
        </li>
        <li><strong>Logical Operators:</strong> Combine conditions using AND, OR, and NOT. Example:
            <div class="terminal">
                <span class="prompt"></span> event.code:4625 AND winlog.event_data.SubStatus:0xC0000072
            </div>
        </li>
        <li><strong>Comparison Operators:</strong> Match conditions precisely using <code>:>, :>=, :<, :<=, :!</code>. Example:
            <div class="terminal">
                <span class="prompt"></span> event.code:4625 AND winlog.event_data.SubStatus:0xC0000072 AND @timestamp >= "2023-03-03T00:00:00.000Z" AND @timestamp <= "2023-03-06T23:59:59.999Z"
            </div>
        </li>
        <li><strong>Wildcards:</strong> Search using patterns. Example:
            <div class="terminal">
                <span class="prompt"></span> event.code:4625 AND user.name: admin*
            </div>
        </li>
    </ul>

    <h2>How to Identify Available Data</h2>
    <p>There are two main approaches:</p>
    <ol>
        <li><strong>Using KQL’s Free Text Search:</strong> Explore fields and values using the "Discover" feature in Kibana. For example, searching for <code>"4625"</code> reveals event codes and timestamps.</li>
        <li><strong>Leveraging Elastic Documentation:</strong> Refer to Elastic’s documentation to understand field structures, including:</li>
        <ul>
            <li>Elastic Common Schema (ECS)</li>
            <li>Winlogbeat fields</li>
            <li>Filebeat fields</li>
        </ul>
    </ol>

    <h2>Elastic Common Schema (ECS)</h2>
    <p>The Elastic Common Schema standardizes field names across data sources, offering:</p>
    <div class="table-container">
    <table border="1" style="width: 100%;">
        <tr>
            <th>Feature</th>
            <th>Benefit</th>
        </tr>
        <tr>
            <td>Unified Data View</td>
            <td>Allows correlation across multiple sources with consistent field names.</td>
        </tr>
        <tr>
            <td>Improved Query Efficiency</td>
            <td>Simplifies query writing in KQL.</td>
        </tr>
        <tr>
            <td>Better Visualizations</td>
            <td>Enables seamless dashboard creation.</td>
        </tr>
        <tr>
            <td>Advanced Elastic Features</td>
            <td>Integrates well with Elastic’s Security and Observability tools.</td>
        </tr>
    </table>
    </div>

    <p>Using ECS fields ensures consistency, future-proofing, and efficient investigation of cybersecurity incidents.</p>
        
      </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room8', event)">Show Solution</button>
  </div>
</div>

<!-- Room9 -->
<div class="room-section">
  <h2 onclick="toggleContent('room9')"> Azure Fundamental
    <img src="azureicon.png" alt="azure icon" width="25" height="20">
</h2>
  <div id="room9" class="collapsible-content">
      <img src="azurewall.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> Cloud computing refers to accessing and using computing resources over the internet rather than relying on local servers or physical hardware. These resources include things like virtual machines, storage, databases, and networking. The cloud also offers advanced services such as Internet of Things (IoT), machine learning (ML), and artificial intelligence (AI), which go beyond the traditional IT setup. Since cloud computing operates over the internet, it’s not limited by physical infrastructure like a traditional data center. This means that businesses can quickly scale up their IT resources without the need to build new data centers. They can just tap into the cloud to expand their operations on demand.</p>

      <div class="solution-section" id="solution-room9" style="display: none;">
          <img src="cloudcomputer.jpg" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>1: What is cloud computing?</strong> Cloud computing is like having a computer, but instead of buying one and storing it yourself, you access it over the internet. It offers more advanced features compared to owning a physical computer. It's similar to owning a computer at home, but with cloud computing, you can access it from anywhere, For example, if you're running a commercial website from your own computer, you'll likely have databases and resources running on that computer. As your website grows, you may run into problems like running out of storage or overloading your computer. This can cause issues like downtime or slow performance, That's where cloud computing comes in. With cloud computing, you don't need to worry about these limitations. The cloud provides more storage and resources when you need them, and the maintenance, backups, and updates are handled by other people. This makes it easier for businesses to scale and focus on their work without worrying about technical problems.</p>
          <img src="sharerescloud.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>2: shared responsibility model </strong> In a traditional corporate data center, the company handles everything—maintaining the physical space, ensuring security, and taking care of the servers. The IT team is in charge of keeping all systems updated, patched, and running smoothly, With the shared responsibility model in cloud computing, the duties are split between the cloud provider and the customer. The provider manages the physical aspects, such as security, power, cooling, and network connectivity, since the customer isn't on-site with the data center, The customer, however, is responsible for the data stored in the cloud. They must ensure that their information is secure and accessible only to authorized users. For example, while the cloud provider may handle a cloud SQL database, the customer still owns the data in it and must manage who has access, Some responsibilities are dependent on the specific service. For instance, if you’re using a cloud database service (PaaS), the provider handles the maintenance of the database, but the customer remains responsible for managing the data. However, if the customer sets up their own virtual machine and installs a database (IaaS), they’re responsible for both the database and the data within it, In a physical data center, the company owns all responsibilities, but with cloud computing, the shared responsibility model varies depending on the type of service—whether it's Infrastructure as a Service (IaaS), Platform as a Service (PaaS), or Software as a Service (SaaS). IaaS places more responsibility on the consumer, while SaaS puts most of the burden on the provider. PaaS is a middle ground, where the responsibilities are more evenly distributed.</p>
          <p><strong>Info:</strong> This diagram highlights how the Shared Responsibility Model informs who is responsible for what.</p>
          <img src="diagramshareres.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <ul>
            <li><strong>You’ll always be responsible for:</strong>
              <ul>
                <li>The information and data stored in the cloud</li>
                <li>Devices that are allowed to connect to your cloud (cell phones, computers, and so on)</li>
                <li>The accounts and identities of the people, services, and devices within your organization</li>
              </ul>
            </li>
            <li><strong>The cloud provider is always responsible for:</strong>
              <ul>
                <li>The physical datacenter</li>
                <li>The physical network</li>
                <li>The physical hosts</li>
              </ul>
            </li>
            <li><strong>Your service model will determine responsibility for things like:</strong>
              <ul>
                <li>Operating systems</li>
                <li>Network controls</li>
                <li>Applications</li>
                <li>Identity and infrastructure</li>
              </ul>
            </li>
          </ul>        
          <h3>cloud models</h3>
          <img src="pubicprivatebriate.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">  
          <p> Private Cloud: A private cloud is similar to a corporate datacenter but with the added benefit of cloud technologies. It's a cloud service dedicated to a single organization, offering more control for the company's IT team. However, private clouds are often more expensive and do not offer the same scalability or flexibility as public clouds. A private cloud can be hosted within your own data center or in a dedicated offsite facility, potentially managed by a third-party.</p>
          <p> Public Cloud: A public cloud is owned and operated by a third-party provider, making cloud services available to anyone who wants to use them. These clouds are accessible to the general public, which sets them apart from private clouds. Public clouds are typically more cost-effective and offer greater scalability, but users have less control over the infrastructure.</p>
          <p> Hybrid Cloud: A hybrid cloud combines both private and public clouds, enabling seamless integration between the two. This setup allows businesses to scale their private cloud with public cloud resources during peak demand. It also provides flexibility, letting organizations choose which workloads should stay in the private cloud for added security and which can move to the public cloud for cost efficiency.</p>
          <img src="multi-cloudand more.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Multi-cloud: In a multi-cloud setup, a company utilizes multiple cloud providers, often combining different services from each one. This can happen if the company uses features from several providers or is transitioning from one to another. The main idea is managing resources and security across two or more public cloud environments, giving businesses more flexibility and options for their cloud services.</p>
          <p>Azure Arc: Azure Arc is a set of tools that help you manage and oversee your cloud resources, whether they are in a public cloud (like Azure), a private cloud in your own data center, a hybrid setup, or a multi-cloud environment with resources spread across different providers. It simplifies managing various cloud configurations from a single interface.</p>
          <p>Azure VMware Solution: If you're already using VMware in a private cloud but want to take advantage of the scalability and flexibility of public or hybrid clouds, Azure VMware Solution allows you to run your VMware-based workloads in Azure. It integrates VMware seamlessly with Azure, making it easier to scale and manage workloads in the cloud.</p>
          <h3>consumption-based model</h3>
          <img src="datacomu.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>When comparing IT infrastructure models, there are two main types of costs to consider: CapEx and OpEx. CapEx is a one-time investment made to acquire or establish physical assets, such as purchasing land, constructing buildings, or setting up a data center. It's a large, upfront expenditure that results in ownership of the resources. In contrast, OpEx involves ongoing, recurring expenses for services or products. This includes costs like renting space, leasing equipment, or subscribing to cloud services. With OpEx, you pay for the use of something over time rather than owning it outright. Cloud computing follows the OpEx model because it’s based on how much you use. Instead of investing in physical infrastructure and managing it, you only pay for the cloud resources you consume, which can vary month to month depending on your needs. If you don’t use any services, there’s no cost for that period.</p>
          <p>This consumption-based model has many benefits, including:</p>
          <ul>
            <li>No upfront costs.</li>
            <li>No need to purchase and manage costly infrastructure that users might not use to its fullest potential.</li>
            <li>The ability to pay for more resources when they're needed.</li>
            <li>The ability to stop paying for resources that are no longer needed.</li>
          </ul>
          <p>In a traditional data center, you have to estimate how much resources you'll need in the future. If you overestimate, you'll end up spending more money than necessary on hardware that isn't fully used. If you underestimate, your data center may quickly run out of capacity, causing performance issues for your applications and services. Fixing this usually involves ordering and installing new hardware, along with adding power, cooling, and networking, which can be time-consuming.</p>
          <p>With cloud computing, you don’t need to worry about getting your resource needs exactly right. If you need more virtual machines, you can add them easily. If the demand drops, you can remove them just as easily. You only pay for the virtual machines you use, so there's no need to worry about paying for unused "extra capacity" that cloud providers keep available.</p>
          <p>Cloud computing involves accessing computing resources, like storage, processing power, and software, over the internet, rather than relying on local infrastructure. It uses a pay-as-you-go model, meaning you only pay for the services you actually use. This approach helps you:</p>
          <ul>
            <li>Plan and manage your operating costs.</li>
            <li>Run your infrastructure more efficiently.</li>
            <li>Scale as your business needs change.</li>
          </ul>          
          </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room9', event)">Show Solution</button>
  </div>
</div>

<!-- Room 10 -->
<div class="room-section">
  <h2 onclick="toggleContent('room10')">Microsoft Defender XDR 
      <img src="https://cdn-dynmedia-1.microsoft.com/is/content/microsoftcorp/FINAL-Icon-Defender-28x28?resMode=sharp2&op_usm=1.5,0.65,15,0&wid=40&hei=40&qlt=100&fit=constrain" alt="China Flag" width="20" height="15">
  </h2>
  <div id="room10" class="collapsible-content">
      <img src="MicrosoftDefenderXDR.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> Microsoft Defender XDR is a powerful security tool designed to uncover and stop cyber threats across various parts of your IT environment—like emails, devices, apps, and user identities. It pieces together the details of an attack, giving you a clear picture of how it started, spread, and impacted your systems. This deeper understanding helps you take swift action to fix the issue and strengthens your defenses against similar attacks in the future.</p>

      <div class="solution-section" id="solution-room10" style="display: none;">
        <h3>Example:</h3>
          <p> see the attacker activity visible to each Microsoft Defender XDR product.</p>
          <img src="defend-attack-chains.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>This diagram demonstrates how Microsoft Defender and its associated security solutions work together to protect organizations from both external threats and insider risks throughout the attack chain. Below is a detailed breakdown:</p>

          <ul>
            <li>
              <p><strong>External Threats</strong> (originate from outside the organization):</p>
              <ul>
                <li>
                  <p><strong>Defender for Office 365:</strong></p>
                  <ul>
                    <li>Detects phishing attempts and blocks malicious emails.</li>
                    <li>Prevents threats such as opening malicious attachments, clicking harmful URLs, and browsing compromised websites.</li>
                  </ul>
                </li>
                <li>
                  <p><strong>Defender for Endpoint:</strong></p>
                  <ul>
                    <li>Protects devices from exploitation and malware installation.</li>
                    <li>Detects and disrupts command and control (C2) communication.</li>
                  </ul>
                </li>
                <li>
                  <p><strong>Defender for IoT (and OT):</strong></p>
                  <ul>
                    <li>Secures IoT devices and operational technology systems.</li>
                    <li>Prevents IoT device exploitation and disruption of critical infrastructure.</li>
                  </ul>
                </li>
                <li>
                  <p><strong>Microsoft Defender for Cloud:</strong> Monitors and protects cloud environments by detecting threats and misconfigurations.</p>
                </li>
              </ul>
            </li>

            <li>
              <p><strong>Identity-based Attacks</strong> (target user accounts):</p>
              <ul>
                <li>
                  <p><strong>Microsoft Entra ID Protection:</strong></p>
                  <ul>
                    <li>Defends against brute force attacks and stolen credentials.</li>
                  </ul>
                </li>
                <li>
                  <p><strong>Defender for Identity:</strong></p>
                  <ul>
                    <li>Identifies compromised accounts and suspicious behaviors.</li>
                    <li>Monitors lateral movement as attackers search for high-value targets.</li>
                  </ul>
                </li>
                <li>
                  <p><strong>Defender for Cloud Apps:</strong></p>
                  <ul>
                    <li>Tracks reconnaissance activities and configuration data collection.</li>
                    <li>Protects sensitive data from unauthorized access or exfiltration.</li>
                    <li>Detects domain compromises and privileged account abuse.</li>
                  </ul>
                </li>
              </ul>
            </li>

            <li>
              <p><strong>Insider Risks</strong> (come from within the organization):</p>
              <ul>
                <li>
                  <p><strong>Microsoft Purview Insider Risk Management:</strong></p>
                  <ul>
                    <li>Monitors insider behaviors, such as careless actions or intentional sabotage.</li>
                    <li>Identifies indicators like a history of violations, distraction, or disgruntled employees.</li>
                    <li>Detects sensitive data access, anomalous activity, and potential sabotage.</li>
                  </ul>
                </li>
              </ul>
            </li>

            <li>
              <p><strong>Microsoft Sentinel (Central Hub):</strong></p>
              <ul>
                <li>Acts as a centralized platform for threat detection and response.</li>
                <li>Correlates insights from various tools to provide a complete attack overview.</li>
                <li>Automates threat detection and enables proactive defense strategies.</li>
              </ul>
            </li>
          </ul>


          <h3>How Extended Detection and Response (XDR) works </h3>

          <ul>
            <li>
              <p><strong>Simplified Explanation:</strong></p>
              <p>XDR works by gathering information from different areas like endpoints, user identities, emails, and applications. It analyzes these signals together to spot and stop threats effectively.</p>
            </li>
            <li>
              <p><strong>Focus on Integration:</strong></p>
              <p>Extended Detection and Response (XDR) integrates data from endpoints, identity systems, email platforms, and applications. This unified approach helps detect malicious activity and take action to prevent harm.</p>
            </li>
            <li>
              <p><strong>Threat-Centric View:</strong></p>
              <p>To combat threats efficiently, XDR pulls data from multiple sources—endpoints, identity systems, emails, and apps. By analyzing these signals collectively, it provides a clearer picture of suspicious activity and enables swift mitigation.</p>
            </li>
            <li>
              <p><strong>Holistic Protection:</strong></p>
              <p>XDR brings together security insights from endpoints, identity tools, email systems, and applications. This consolidated view helps identify threats faster and respond to them across different parts of the IT environment.</p>
            </li>
            <li>
              <p><strong>Step-by-Step Process:</strong></p>
              <p>
                <ul>
                  <li>XDR collects signals from:</li>
                  <ul>
                    <li>Devices (endpoints)</li>
                    <li>User accounts (identity)</li>
                    <li>Communication tools (email)</li>
                    <li>Software platforms (applications)</li>
                  </ul>
                  <li>It then analyzes these signals as a whole to detect, understand, and neutralize security threats.</li>
                </ul>
              </p>
            </li>
            <li>
              <p><strong>Real-World Analogy:</strong></p>
              <p>Think of XDR as a security control room. It monitors activity across your devices, user accounts, emails, and software, piecing together clues from all these areas to identify and stop threats before they spread.</p>
            </li>
            <li>
              <p><strong>Tech-Oriented Approach:</strong></p>
              <p>Extended Detection and Response merges data streams from endpoints, identities, emails, and apps. Using advanced analytics, it detects patterns that indicate potential threats and coordinates mitigation across all these layers.</p>
            </li>
          </ul>


      </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room10', event)">Show Solution</button>
                <!-- Read Aloud Button -->
        <button class="solution-button" onclick="readAloud()">Read Aloud</button>
  </div>
</div>

<script>
    function toggleContent(room) {
        var content = document.getElementById(room);
        content.style.display = (content.style.display === 'none' || content.style.display === '') ? 'block' : 'none';
    }

    function toggleSolution(room, event) {
        var solution = document.getElementById("solution-" + room);
        var button = event.target;

        if (solution.style.display === 'none' || solution.style.display === '') {
            solution.style.display = 'block';
            button.textContent = "Hide Solution";
        } else {
            solution.style.display = 'none';
            button.textContent = "Show Solution";
        }
    }

    // Read Aloud function
function readAloud() {
    let selectedText = window.getSelection().toString(); // Get the highlighted text
    
    if (selectedText) {
        // If text is highlighted, read it aloud
        let speech = new SpeechSynthesisUtterance(selectedText);
        window.speechSynthesis.speak(speech);
    } else {
        alert("Please highlight some text to read aloud.");
    }
}

</script>
</body>
</html>
