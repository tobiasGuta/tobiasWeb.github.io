<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <title>CTF Rooms</title>
    <style>
        /* Background container for animated GIF */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://i.pinimg.com/originals/38/1c/63/381c630b05c0e00afe8f986acb8658b6.gif') no-repeat center center fixed;
            background-size: cover;
            z-index: -1;
            opacity: 0.2;
        }

        /* Main page styling */
        body {
            color: #00ff00;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            background: rgba(0, 0, 0, 0.85);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-x: hidden; /* Hide horizontal overflow */
            overflow-y: auto; /* Allow vertical scrolling */
        }

        /* Content styling */
        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-top: 120px;
            width: 100%;
        }

        /* Glitch Text Effect */
        .glitch-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            padding-top: 20px;
        }

        .glitch {
            font-size: 2.5em;
            color: #00ff00;
            animation: glitch 1s infinite;
            white-space: nowrap;
            position: relative;
        }

        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            color: #ff00ff;
            opacity: 0.8;
            clip: rect(0, 900px, 0, 0);
            animation: glitch 1s infinite;
        }

        .glitch::after {
            color: #00ffff;
            left: 2px;
            animation: glitch 1.2s infinite;
        }

        @keyframes glitch {
            0% { clip: rect(42px, 9999px, 44px, 0); transform: translate(0px, 0px); }
            20% { clip: rect(0px, 9999px, 44px, 0); transform: translate(2px, -2px); }
            40% { clip: rect(10px, 9999px, 38px, 0); transform: translate(-2px, 0px); }
            60% { clip: rect(15px, 9999px, 44px, 0); transform: translate(0px, 2px); }
            80% { clip: rect(30px, 9999px, 40px, 0); transform: translate(-1px, -1px); }
            100% { clip: rect(20px, 9999px, 40px, 0); transform: translate(1px, 1px); }
        }

        /* Room Section Styling */
        .room-section {
            border: 1px solid #00ff00;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            text-align: left;
            transition: transform 0.3s ease-in-out, margin 0.3s ease;
            width: 100%;
            max-width: 800px; /* Constrain width for larger screens */
        }

        /* When room section is expanded */
        .room-section.open {
            transform: scale(1.05);
            margin-bottom: 40px;
        }

        h2 {
            font-size: 1.5em;
            cursor: pointer;
        }

        h2:hover {
            color: #ffff00;
        }

        /* Collapsible content */
        .collapsible-content {
            display: none;
            padding-top: 10px;
            position: relative;
            animation: fadeIn 0.5s ease-in;
        }

        /* Fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hacking themed Back Button */
        .back-button {
            background-color: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: color 0.4s, background-color 0.4s;
            box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00;
        }

        .back-button:hover {
            color: #1c1c1c;
            background-color: #00ff00;
            box-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00, 0 0 40px #00ff00;
            animation: pulse 1s infinite;
        }

        /* Pulse animation for hacker vibes */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .back-button:before {
            content: '‚Üê';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.8em;
            opacity: 0;
            animation: typewriter 1.2s steps(10) infinite;
        }

        /* Typewriter effect */
        @keyframes typewriter {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Center Back Button */
        .back-button-container {
            position: relative;
            text-align: center;
            margin-top: 130px;
        }


        /* Navigation links styling */
        nav {
            display: inline-block;
            position: relative;
        }

        nav a {
            margin: 5px;
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            transition: background 0.3s;
        }

        nav a:hover {
            background: #00ff00;
            color: #1c1c1c;
        }

        /* Responsive styling for small screens (iPhone) */
        @media only screen and (max-width: 600px) {
            .glitch {
                font-size: 2em;
            }

            .glitch-container {
                padding-top: 10px;
            }

            h2 {
                font-size: 1.2em;
            }

            .room-section {
                padding: 10px;
                width: 90%;
                margin: 10px;
            }

            .back-button {
                font-size: 1em;
                margin-top: 70px;
                padding: 8px 16px;
            }

            .back-button-container {
                margin-top: 20px;
            }

            /* Ensure the back button stays centered */
            .content {
                margin-top: 70px;
            }

            .room-section h2 {
                font-size: 1.2em;
            }

            .collapsible-content {
                font-size: 0.9em;
                padding: 8px;
            }
        }
        .solution-button {
            background-color: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            margin-top: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: color 0.4s, background-color 0.4s;
            box-shadow: 0 0 5px #00ff00;
        }

        .solution-button:hover {
            color: #1c1c1c;
            background-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
    </style>
</head>
<body>
    <!-- Background Container -->
    <div class="background-container"></div>

    <!-- Glitch Heading -->
    <div class="glitch-container">
        <h1 class="glitch" data-text="CTF Rooms">CTF Rooms</h1>
    </div>

    <!-- Back Button Container (Centered) -->
    <div class="back-button-container">
        <button class="back-button" onclick="window.location.href='community.html'">Back</button>
    </div>

    <!-- Content with Room Sections -->
    <div class="content">

<!-- Room 1 -->
<div class="room-section">
    <h2 onclick="toggleContent('room1')">Tryhackme: Summit üöÄ</h2>
    <div id="room1" class="collapsible-content">
        <img src="summit.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Can you chase a simulated adversary up the Pyramid of Pain until they finally back down?</p>
        <p><strong>Challenge Approach:</strong> The tester will be attempting to execute malware samples on a simulated internal user workstation. At the same time, you will need to configure PicoSecure's security tools to detect and prevent the malware from executing.</p>
        
        <!-- Question 1 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the first flag you receive after successfully detecting sample1.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q1" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl1[.]exe to see what we can find.</p>
            <img src="sample1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus doesn't do much damage, so we can block it by using its hash: MD5 cbda8ae000aa9cbe7c8b982bae006c2a</p>
            <img src="hasblock.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q1', event)">Show Solution</button>

        <!-- New Question 2 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the second flag you receive after successfully detecting sample2.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q2" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="sample2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="sample22.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does more things, such as networking activity like making GET requests to an IP and establishing connections.</p>
            <img src="firewal.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a firewall rule to block any connection to a specific IP.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q2', event)">Show Solution</button>

        <!-- New Question 3 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the third flag you receive after successfully detecting sample3.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q3" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl3[.]exe to see what we can find.</p>
            <img src="dnns.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus also makes requests, but this time to specific domains instead of direct IP addresses. This method is advantageous for hackers because it helps them hide their true IP address, making it harder for security systems to trace the origin of the attack. By using domain names, attackers can also leverage techniques like Dynamic DNS or cloud-based services to further obscure their location.</p>
            <img src="dnsrule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a DNS rule to block any connection to this Domain, Creating a DNS rule to block a domain involves configuring your network or firewall to prevent any device on your network from resolving a specific domain to its associated IP address. When a device tries to access a domain, the DNS server translates the domain name into an IP address. By creating a DNS block rule, you're essentially telling the DNS server to deny the request to resolve that domain, making it impossible for the malware or malicious activity to reach its destination.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q3', event)">Show Solution</button>

        <!-- New Question 4 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fourth flag you receive after successfully detecting sample4.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q4" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="email4.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl4[.]exe to see what we can find.</p>
            <img src="registrac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does even worse things, such as modifying the registry at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Real-Time Protection. This is the key for Windows Defender's Real-Time Protection. By tampering with it, the virus disables Windows Defender, preventing it from alerting the user to any malicious activity.</p>
            <img src="sigmarule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect this type of event, Sigma rules are a standardized, flexible way to define detection logic for various security events across different security platforms. They are designed to be platform-agnostic, meaning they can be used with any SIEM (Security Information and Event Management) system to identify suspicious activities.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q4', event)">Show Solution</button>
        
        <!-- New Question 5 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fifth flag you receive after successfully detecting sample5.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q5" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a log file</p>
            <img src="mail5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="logfile.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl5[.]exe to see what we can find.</p>
            <img src="sample5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is even worse because it makes a lot of POST requests to a specific IP. To avoid detection, it establishes a connection every 30 minutes and sends a request of size 97 bytes. It's like it's communicating with a C2 (Command and Control) server</p>
            <img src="c2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect and block any attempts to connect to this specific Command and Control (C2) server. Sigma rules allow us to define detection patterns for suspicious activities across different security platforms. In this case, the rule would be designed to identify any network traffic trying to establish a connection with the identified C2 server, and then block it to prevent the malware from communicating with its attacker. By implementing this rule, we can strengthen our defenses and prevent the malware from receiving further commands or exfiltrating data</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q5', event)">Show Solution</button>

        <!-- New Question 6 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the final flag you receive from Sphinx?</p>
        </div>

        <div class="solution-section" id="solution-room1-q6" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a  Commands log file </p>
            <img src="sample6.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="commandlog.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="comvir.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is running a series of commands on the infected system to gather important information. It collects system details and network configuration data, likely to be used for reconnaissance or further exploitation.</p>
            <img src="sigmareco.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect a specific string being run, in this case: %temp%\exfiltr8[.]log.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q6', event)">Show Solution</button>
    </div>
</div>





<!-- Room 2 -->
<div class="room-section">
    <h2 onclick="toggleContent('room2')">Room 2: Defcon üõ°Ô∏è</h2>
    <div id="room2" class="collapsible-content">
        <p><strong>Description:</strong> Explore and analyze traffic from a network-based challenge with real-time logs.</p>
        <p><strong>Challenge Approach:</strong> Investigate and identify network traffic anomalies and provide the appropriate solutions based on your analysis.</p>
        <div class="question-section">
            <p><strong>Question:</strong> Which protocol was used for the malicious activity detected in the logs?</p>
        </div>

        <div class="solution-section" id="solution-room2" style="display: none;">
            <p><strong>Solution:</strong></p>
            <pre><code>TCP</code></pre>
            
            <!-- Adding an image for room 2 demonstration inside the solution -->
            <div>
                <h3>Example Demonstration for Room 2:</h3>
                <img src="https://via.placeholder.com/500" alt="Room 2 Demonstration" style="max-width: 100%; height: auto;">
            </div>
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room2', event)">Show Solution</button>
    </div>
</div>

<script>
    function toggleContent(room) {
        var content = document.getElementById(room);
        content.style.display = (content.style.display === 'none' || content.style.display === '') ? 'block' : 'none';
    }

    function toggleSolution(room, event) {
        var solution = document.getElementById("solution-" + room);
        var button = event.target;

        if (solution.style.display === 'none' || solution.style.display === '') {
            solution.style.display = 'block';
            button.textContent = "Hide Solution";
        } else {
            solution.style.display = 'none';
            button.textContent = "Show Solution";
        }
    }
</script>
</body>
</html>
