<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <title>CTF Rooms</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Background container for animated GIF */
        .background-container {
    position: fixed; /* Cover the entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color:  #14161E; /* Dracula dark background */
    color: #f8f8f2; /* Light text color for contrast */
    font-family: 'Courier New', Courier, monospace; /* Monospace font for hacker aesthetic */
    z-index: -1; /* Ensure it stays behind other content */
}

        /* Main page styling */
        body {
            color: #00ff00;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            background: rgba(0, 0, 0, 0.85);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-x: hidden; /* Hide horizontal overflow */
            overflow-y: auto; /* Allow vertical scrolling */
        }

        /* Content styling */
        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-top: 120px;
            width: 100%;
        }

        /* Glitch Text Effect */
        .glitch-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            padding-top: 20px;
        }

        .glitch {
            font-size: 2.5em;
            color: #00ff00;
            animation: glitch 1s infinite;
            white-space: nowrap;
            position: relative;
        }

        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            color: #ff00ff;
            opacity: 0.8;
            clip: rect(0, 900px, 0, 0);
            animation: glitch 1s infinite;
        }

        .glitch::after {
            color: #00ffff;
            left: 2px;
            animation: glitch 1.2s infinite;
        }

        @keyframes glitch {
            0% { clip: rect(42px, 9999px, 44px, 0); transform: translate(0px, 0px); }
            20% { clip: rect(0px, 9999px, 44px, 0); transform: translate(2px, -2px); }
            40% { clip: rect(10px, 9999px, 38px, 0); transform: translate(-2px, 0px); }
            60% { clip: rect(15px, 9999px, 44px, 0); transform: translate(0px, 2px); }
            80% { clip: rect(30px, 9999px, 40px, 0); transform: translate(-1px, -1px); }
            100% { clip: rect(20px, 9999px, 40px, 0); transform: translate(1px, 1px); }
        }

        /* Room Section Styling */
        .room-section {
            border: 1px solid #00ff00;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            text-align: left;
            transition: transform 0.3s ease-in-out, margin 0.3s ease;
            width: 100%;
            max-width: 800px; /* Constrain width for larger screens */
        }

        /* When room section is expanded */
        .room-section.open {
            transform: scale(1.05);
            margin-bottom: 40px;
        }

        h2 {
            font-size: 1.5em;
            cursor: pointer;
        }

        h2:hover {
            color: #ffff00;
        }

        /* Collapsible content */
        .collapsible-content {
            display: none;
            padding-top: 10px;
            position: relative;
            animation: fadeIn 0.5s ease-in;
        }

        /* Fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hacking themed Back Button */
.back-button {
    background-color: transparent; /* Transparent background */
    color: white; /* White text by default */
    border: none; /* No border initially */
    padding: 12px 24px;
    border-radius: 5px;
    font-size: 1.2em;
    cursor: pointer;
    text-align: center;
    position: relative;
    overflow: hidden;
    outline: none; /* Remove the default outline (browser specific) */
    transition: color 0.3s, box-shadow 0.3s; /* Smooth transition for color and shadow */
}

/* Normal link hover (for back button) */
.back-button:hover {
    color: #2AF7A5; /* Change text color to #2AF7A5 */
    animation: pulse 1s infinite; /* Apply pulse effect */
    box-shadow: 0 0 10px #2AF7A5, 0 0 20px #2AF7A5, 0 0 30px #2AF7A5; /* Glowing effect */
    border: 2px solid #2AF7A5; /* Border appears only when hovering */
}

/* Pulse animation for hacker vibes */
@keyframes pulse {
    0% { 
        transform: scale(1);
        opacity: 1; 
    }
    50% { 
        transform: scale(1.1); 
        opacity: 0.8; 
    }
    100% { 
        transform: scale(1); 
        opacity: 1; 
    }
}

/* Back Button Container */
.back-button-container {
    position: relative;
    text-align: center;
    margin-top: 130px; /* Keep the position as it was */
}

        /* Navigation links styling */
        nav {
            display: inline-block;
            position: relative;
        }

        nav a {
            margin: 5px;
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            transition: background 0.3s;
        }

        nav a:hover {
            background: #00ff00;
            color: #1c1c1c;
        }

        /* Responsive styling for small screens (iPhone) */
        @media only screen and (max-width: 600px) {
            .glitch {
                font-size: 2em;
            }

            .glitch-container {
                padding-top: 10px;
            }

            h2 {
                font-size: 1.2em;
            }

            .room-section {
                padding: 10px;
                width: 90%;
                margin: 10px;
            }

            .back-button {
                font-size: 1em;
                margin-top: 70px;
                padding: 8px 16px;
            }

            .back-button-container {
                margin-top: 20px;
            }

            /* Ensure the back button stays centered */
            .content {
                margin-top: 70px;
            }

            .room-section h2 {
                font-size: 1.2em;
            }

            .collapsible-content {
                font-size: 0.9em;
                padding: 8px;
            }
        }
        .solution-button {
            background-color: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            margin-top: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: color 0.4s, background-color 0.4s;
            box-shadow: 0 0 5px #00ff00;
        }

        .solution-button:hover {
            color: #1c1c1c;
            background-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        .terminal {
      background-color: #1e1e1e; /* Dark terminal background */
      color: #d4d4d4; /* Light text for contrast */
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', Courier, monospace; /* Monospace font for terminal look */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); /* Subtle shadow for depth */
      overflow-x: auto; /* Handles long commands gracefully */
    }
    .prompt {
      color: #00ff00; /* Green color for the terminal prompt */
    }
    </style>
</head>
<body>
    <!-- Background Container -->
    <div class="background-container"></div>

    <!-- Glitch Heading -->
    <div class="glitch-container">
        <h1 class="glitch" data-text="CTF Rooms & Sec Tips">CTF Rooms & Sec Tips</h1>
    </div>

    <div class="back-button-container">
        <button class="back-button" onclick="window.location.href='community.html'">
            <i class="fas fa-users"></i> Back
        </button>
    </div>
    

    <!-- Content with Room Sections -->
    <div class="content">

<!-- Room 1 -->
<div class="room-section">
    <h2 onclick="toggleContent('room1')">Tryhackme: Summit 🚀</h2>
    <div id="room1" class="collapsible-content">
        <img src="summit.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Can you chase a simulated adversary up the Pyramid of Pain until they finally back down?</p>
        <p><strong>Challenge Approach:</strong> The tester will be attempting to execute malware samples on a simulated internal user workstation. At the same time, you will need to configure PicoSecure's security tools to detect and prevent the malware from executing.</p>
        
        <!-- Question 1 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the first flag you receive after successfully detecting sample1.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q1" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl1[.]exe to see what we can find.</p>
            <img src="sample1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus doesn't do much damage, so we can block it by using its hash: MD5 cbda8ae000aa9cbe7c8b982bae006c2a</p>
            <img src="hasblock.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q1', event)">Show Solution</button>

        <!-- New Question 2 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the second flag you receive after successfully detecting sample2.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q2" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="sample2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="sample22.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does more things, such as networking activity like making GET requests to an IP and establishing connections.</p>
            <img src="firewal.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a firewall rule to block any connection to a specific IP.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q2', event)">Show Solution</button>

        <!-- New Question 3 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the third flag you receive after successfully detecting sample3.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q3" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl3[.]exe to see what we can find.</p>
            <img src="dnns.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus also makes requests, but this time to specific domains instead of direct IP addresses. This method is advantageous for hackers because it helps them hide their true IP address, making it harder for security systems to trace the origin of the attack. By using domain names, attackers can also leverage techniques like Dynamic DNS or cloud-based services to further obscure their location.</p>
            <img src="dnsrule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a DNS rule to block any connection to this Domain, Creating a DNS rule to block a domain involves configuring your network or firewall to prevent any device on your network from resolving a specific domain to its associated IP address. When a device tries to access a domain, the DNS server translates the domain name into an IP address. By creating a DNS block rule, you're essentially telling the DNS server to deny the request to resolve that domain, making it impossible for the malware or malicious activity to reach its destination.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q3', event)">Show Solution</button>

        <!-- New Question 4 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fourth flag you receive after successfully detecting sample4.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q4" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="email4.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl4[.]exe to see what we can find.</p>
            <img src="registrac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does even worse things, such as modifying the registry at Microsoft\Windows Defender\Real-Time Protection. This is the key for Windows Defender's Real-Time Protection. By tampering with it, the virus disables Windows Defender, preventing it from alerting the user to any malicious activity.</p>
            <img src="sigmarule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect this type of event, Sigma rules are a standardized, flexible way to define detection logic for various security events across different security platforms. They are designed to be platform-agnostic, meaning they can be used with any SIEM (Security Information and Event Management) system to identify suspicious activities.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q4', event)">Show Solution</button>
        
        <!-- New Question 5 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fifth flag you receive after successfully detecting sample5.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q5" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a log file</p>
            <img src="mail5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="logfile.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl5[.]exe to see what we can find.</p>
            <img src="sample5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is even worse because it makes a lot of POST requests to a specific IP. To avoid detection, it establishes a connection every 30 minutes and sends a request of size 97 bytes. It's like it's communicating with a C2 (Command and Control) server</p>
            <img src="c2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect and block any attempts to connect to this specific Command and Control (C2) server. Sigma rules allow us to define detection patterns for suspicious activities across different security platforms. In this case, the rule would be designed to identify any network traffic trying to establish a connection with the identified C2 server, and then block it to prevent the malware from communicating with its attacker. By implementing this rule, we can strengthen our defenses and prevent the malware from receiving further commands or exfiltrating data</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q5', event)">Show Solution</button>

        <!-- New Question 6 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the final flag you receive from Sphinx?</p>
        </div>

        <div class="solution-section" id="solution-room1-q6" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a  Commands log file </p>
            <img src="sample6.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="commandlog.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="comvir.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is running a series of commands on the infected system to gather important information. It collects system details and network configuration data, likely to be used for reconnaissance or further exploitation.</p>
            <img src="sigmareco.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect a specific string being run, in this case: %temp%\exfiltr8[.]log.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q6', event)">Show Solution</button>
    </div>
</div>





<!-- Room 2 -->
<div class="room-section">
    <h2 onclick="toggleContent('room2')">Tactical Detection 🛡️</h2>
    <div id="room2" class="collapsible-content">
        <img src="tacticaldetection.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> understand the mindset behind choosing a tactical approach in alerting and detecting threats, IOAs, IOCs, etc.</p>
        <p><strong>Challenge Approach:</strong> the most efficient ways to bolster an organization's security posture by leveraging detection mechanisms and walking the user through setting them up tactically. This should serve as a baseline where the user will be able to learn the basics, implement them in their functions, and make them truly their own.</p>
        <div class="question-section">
            <p><strong>Setting up a Basic Tripwire</strong></p>
        </div>

        <div class="solution-section" id="solution-room2" style="display: none;">
            <p><strong>Info:</strong> Open The local security policy application, then navigate to Security Settings → Local Policies → Audit Policy and Open the Audit object access policy.</p>
            <img src="localapplication.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Check the boxes next to Success and Failure, then click Apply and OK to ensure that all access attempts—whether successful or not—will be logged. Once you're done, you can close the Local Security Policy application.</p>
            <img src="succandfai.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> After configuring the Local Security Policy, monitoring won’t start automatically. We need to specify which files or folders to track. To set this up, right-click on the desktop, choose New → Text Document, and name the file Secret Document.</p>
            <img src="note.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Infor:</strong>  Then, right-click the file, select Properties → Security → Advanced → Auditing to set up monitoring for this document in our tripwire configuration</p>
            <img src="properties.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This is where we will create and specify an audit entry for our Secret Document. Click on Add → Select a principal.</p>
            <img src="propertiesname.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This pop-up allows us to specify which users or groups we want to be notified about when they access the Secret Document. While you can be very specific, for this example, we’ll keep it simple. In the text box, type "Everyone" and press Enter to monitor all users.</p>
            <img src="propn.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="donevery.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> The Principal should now show "Everyone," and the permissions will allow you to specify which actions to audit on the Secret Document. For a broader selection, click Show advanced permissions in the top-right corner. Once you're done, click OK, then Apply and OK on the Audit entry page, and finally, click OK on the Secret Document properties. If you're tracking multiple files, it’s recommended to organize them into folders for easier auditing. The setup is now complete, and auditing is active for the Secret Document. Any access attempts will be logged in the Security event log with Event ID 4663, which can be filtered and used to generate alerts, allowing analysts to quickly detect when a tripwire is triggered, thereby enhancing the organization's security.</p>
            <img src="done.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Detecting:</strong> Now it's time to detect it.</p>
            <p><strong>Info:</strong> Let's open this file using CMD.</p>
            <img src="notcm.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Now, let's use the FullEventLogView application to view the logs.</p>
            <img src="loappl.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Lessons Learned:</strong> Applying tactical detection is important because it enables proactive monitoring of system activities and potential security threats in real-time. By auditing access to sensitive files, such as the Secret Document, and logging every interaction with them, you can quickly identify suspicious or unauthorized behavior. This helps in detecting potential security breaches early, enabling swift response and mitigation.</p>
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room2', event)">Show Solution</button>
    </div>
</div>

<!-- Room 3 -->
<div class="room-section">
    <h2 onclick="toggleContent('room3')">Tryhackme: Friday Overtime 🐼</h2>
    <div id="room3" class="collapsible-content">
        <img src="evilpanda.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> It's a Friday evening at PandaProbe Intelligence when a notification appears on your CTI platform. While most are already looking forward to the weekend, you realise you must pull overtime because SwiftSpend Finance has opened a new ticket, raising concerns about potential malware threats. The finance company, known for its meticulous security measures, stumbled upon something suspicious and wanted immediate expert analysis.</p>
        <p><strong>Challenge Approach:</strong> As the only remaining CTI Analyst on shift at PandaProbe Intelligence, you quickly took charge of the situation, realising the gravity of a potential breach at a financial institution. The ticket contained multiple file attachments, presumed to be malware samples. With a deep breath, a focused mind, and the longing desire to go home, you began the process of:</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room3" style="display: none;">
            <p><strong>Question:</strong> Who shared the malware samples?</p>
            <img src="emailpanda1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the file "pRsm.dll" inside samples.zip?</p>
            <img src="unzisam.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="shh1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Which MITRE ATT&CK Technique is linked to using pRsm.dll in this malware framework?</p>
            <img src="techniq.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="techni2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the CyberChef defanged URL of the malicious download location first seen on 2020-11-02? let's visit this site: hxxps[://]tinyurl[.]com/AptGroup for more information</p>
            <img src="url.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="urllin.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the CyberChef defanged IP address of the C&C server first detected on 2020-09-14 using these modules?</p>
            <img src="ippand.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the spyagent family spyware hosted on the same IP targeting Android devices on November 16, 2022?</p>
            <img src="checckip.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="androtar.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="andrhas.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room3', event)">Show Solution</button>
    </div>
</div>

<!-- Room 4 -->
<div class="room-section">
    <h2 onclick="toggleContent('room4')">Tryhackme: Trooper 
        <img src="https://flagcdn.com/w40/cn.png" alt="China Flag" width="20" height="15">
    </h2>
    <div id="room4" class="collapsible-content">
        <img src="grouptropper.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> A multinational technology company has been the target of several cyber attacks in the past few months. The attackers have been successful in stealing sensitive intellectual property and causing disruptions to the company's operations. A threat advisory report about similar attacks has been shared, and as a CTI analyst, your task is to identify the Tactics, Techniques, and Procedures (TTPs) being used by the Threat group and gather as much information as possible about their identity and motive. .</p>
        <p><strong>Challenge Approach:</strong> you will utilise the OpenCTI platform as well as the MITRE ATT&CK navigator</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room4" style="display: none;">
            <p><strong>Question:</strong> What kind of phishing campaign does APT X use as part of their TTPs?</p>
            <embed src="APT X_USBFerry.pdf" type="application/pdf" width="100%" height="500px">
            <p style="font-family: 'Courier New', monospace; color: #00ff00; text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;">
                If the PDF doesn’t display, 
                <a href="APT X_USBFerry.pdf" download style="color: #00ff00; text-decoration: none;">
                    click here to download it
                </a>
                <span class="cursor">|</span>.
            </p>
            <p><strong>Question:</strong> What is the name of the malware used by APT X?</p>
            <p><strong>Question:</strong>What is the malware's STIX ID?</p>
            <img src="usbb1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="usbb2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>With the use of a USB, what technique did APT X use for initial access?</p>
            <img src="subb3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the identity of APT X? </p>
            <img src="ggrroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>On OpenCTI, how many Attack Pattern techniques are associated with the APT?</p>
            <img src="attackpattern.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the name of the tool linked to the APT?</p>
            <img src="togroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Load up the Navigator. What is the sub-technique used by the APT under Valid Accounts?</p>
            <img src="locgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Under what Tactics does the technique above fall?</p>
            <img src="iatac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="tecgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What technique is the group known for using under the tactic Collection?</p>
            <img src="autgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room4', event)">Show Solution</button>
    </div>
</div>

<!-- Room 5 -->
<div class="room-section">
    <h2 onclick="toggleContent('room5')">Snort - Intrusion Detection System (IDS) and an Intrusion Prevention System (IPS) 🐷 </h2>
    <div id="room5" class="collapsible-content">
        <img src="snort.png" alt="Room 5 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Snort is a powerful open-source network intrusion detection system (IDS) and intrusion prevention system (IPS) developed by Martin Roesch and maintained by Cisco Systems. It analyzes network traffic in real-time, identifying suspicious patterns or behaviors that may indicate a security threat. With its extensive rule-based language, Snort can detect attacks, log malicious traffic, and even block it when configured as an IPS.</p>
        <p><strong>Challenge Approach:</strong> Setting up Snort</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room5" style="display: none;">
            <p><strong>Info:</strong>Let's start by installing Snort. You can find the information on this website: snort[.]org.</p>
            <p><strong>Installation:</strong> If you're using Linux, you can install Snort by running the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo apt install snort -y
            </div>
            <p><strong>Info:</strong>  Setting up Snort using the -X option for full packet dump mode.</p>
            <p><strong>Info:</strong>  These are different switches, such as verbose mode (-v), using the interface (-i), dumping packet data mode (-d), dump (-d), and link-layer header grabbing (-e).</p>
            <p><strong>Info:</strong> Sending a ping request to the machine to check if Snort is able to detect it</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -X
            </div>
            <img src="pin1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <div class="terminal">
                <span class="prompt">$</span> ping -c 5 VICTIM-IP
            </div>
            <img src="pin2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong>  Run Snort in Logger Mode.</p>
            <p><strong>Important:</strong> Before diving into generating and analyzing logs, it's crucial to understand Linux file ownership and permissions. Snort requires superuser (root) privileges to sniff network traffic. When you run Snort using the sudo command, any log files it creates will be owned by the root account. As a result, you'll need root privileges to access and analyze these log files.</p>
            <p><strong>Info:</strong>  Logging with parameter "-l".</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -l .
            </div>
            <p><strong>Info:</strong> Snort captures and logs packets to a specified directory, which can be set in the snort.config file. Alternatively, you can use the -l option to specify a custom directory for log files. While the default log directory is ideal for ongoing monitoring, the -l option is particularly handy for testing scenarios, For example, using -l . in the command saves the logs directly to the current working directory.</p>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                snort.log.123456789
            </div>
            <p><strong>Info:</strong> Logging with parameter "-K ASCII"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -K ASCII -l .
            </div>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                192.168.43.112  172.16.87.25  snort.log.123456789
            </div>
            <p><strong>Info:</strong> On examining the generated folders, you'll notice that the logs are stored in an organized, categorized format and saved as ASCII files. This means the logs can be easily read and analyzed directly, without requiring a Snort instance to interpret them.</p>
            <p><strong>Info:</strong> In ASCII mode, logs are stored in a human-readable format and split into multiple files, making it easy to view them with a simple text editor. On the other hand, logs in binary format are not readable by humans and must be analyzed using tools like Snort or tcpdump to make sense of the data.</p>
            <p><strong>Info:</strong> Reading generated logs with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r snort.log.123456789       
                <br>
                <br>
                Running in packet dump mode

                        --== Initializing Snort ==--
                Initializing Output Plugins!
                pcap DAQ configured to read-file.
                Acquiring network traffic from "snort.log.123456789".

                        --== Initialization Complete ==--
                ...
                Commencing packet processing (pid=3025)
                WARNING: No preprocessors configured for policy 0.
                12/02-08:15:05.567834 10.0.0.5 -> 8.8.8.8
                UDP TTL:128 TOS:0x10 ID:10045 IpLen:20 DgmLen:72
                SrcPort:55444 DstPort:53  
                DNS Query: www.example.com
                =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
                WARNING: No preprocessors configured for policy 0.
                12/02-08:16:12.789654 192.168.1.101 -> 93.184.216.34
                TCP TTL:64 TOS:0x0 ID:34560 IpLen:20 DgmLen:52 DF
                Seq:123456789  Ack:987654321 Win:8192
                Flags: S  SYN Packet
                ===============================================================================
                Packet I/O Totals:
                Received:           75
                Analyzed:           75 (100.000%)
                    Dropped:            0 (  0.000%)
                Filtered:            0 (  0.000%)
                Outstanding:            0 (  0.000%)
                Injected:            0
                ===============================================================================
                Breakdown by protocol (includes rebuilt packets):
                ...
                    Total:           75
                ===============================================================================
                Snort exiting
            </div>
            <p><strong>Inportant:</strong> It's important to note that Snort can process and interpret binary-format logs, which can also be viewed using tools like tcpdump and Wireshark. However, if you generate logs using the -K ASCII parameter, Snort will be unable to read them. As shown in the output above, Snort successfully read and displayed the log file in the same way it would when operating in sniffer mode.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo tcpdump -r snort.log.123456789 -ntc 10       
                <br>
                <br>
                reading from file snort.log.123456789, link-type EN10MB (Ethernet)
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [SYN] Seq=1 Ack=0 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [SYN, ACK] Seq=1 Ack=2 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [ACK] Seq=2 Ack=1 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: HTTP GET /index.html HTTP/1.1
                IP 10.1.2.3 > 192.168.0.5: HTTP 200 OK
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [FIN, ACK] Seq=1000 Ack=2000 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [FIN, ACK] Seq=2000 Ack=1001 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: UDP 12345 > 53 Len=50
                IP 10.1.2.3 > 192.168.0.5: UDP 53 > 12345 Len=50
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [RST] Seq=1000 Win=0 Len=0
            </div>
            <p><strong>Info:</strong> The -r parameter enables users to apply filters to binary log files. By using this parameter along with Berkeley Packet Filters (BPF), you can narrow down the processed logs to view only specific packets that match your filter criteria.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r myfile.log -X
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log icmp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log tcp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log 'udp and port 53'
            </div>
            <p><strong>Inportant:</strong> The result will be similar to the previous one, but it will display only packets that match the specified protocol. You can also control how many packets to process by using the -n parameter. For example, the following command will process just the first 10 packets from the log: </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dvr logname.log -n 10
            </div>
            <p><strong>Resources about BPF:</strong> https://tinyurl.com/42kymtty <br>https://tinyurl.com/2k4ha737<br>https://tinyurl.com/3nx43hpp<br></p>
            <p><strong>Important:</strong> IDS/IPS mode helps you manage the traffic according to user-defined rules, (N)IDS/IPS mode depends on the rules and configuration.</p>
            <p><strong>Info:</strong> NIDS mode parameters</p>
            <p><strong>paramater -c:</strong> Defining the configuration file.</p>
            <p><strong>paramater -T:</strong> Testing the configuration file.</p>
            <p><strong>paramater -N:</strong> Disable logging.</p>
            <p><strong>paramater -D:</strong> Background mode.</p>
            <p><strong>paramater -A:</strong> Alert modes;<br>full: Full alert mode, providing all possible<br>information about the alert. This one also is the default mode; once you use -A and don't specify any mode, snort uses this mode.<br>fast:  Fast mode shows the alert message, timestamp, source and destination IP, along with port numbers.<br>console: Provides fast style alerts on the console screen.<br>cmg: CMG style, basic header details with payload in hex and text format.<br>none: Disabling alerting<br></p>
            <p><strong>Info:</strong> Once you start running IDS/IPS mode, you need to use rules.</p>
            <p><strong>Rule ICMP:</strong> pre-defined ICMP rule as an example</p>
            <div class="terminal">
                <span class="prompt"></span> alert icmp any any <> any any  (msg: "ICMP Packet Found"; sid: 100001; rev:1;)
            </div>
            <p><strong>Info:</strong> This rule is located in "/etc/snort/rules/local.rules"</p>
            <p><strong>Info:</strong> Snort generates an "alert" file whenever it detects traffic that matches one of its alert rules. Additionally, when you run Snort in IPS (Intrusion Prevention System) or IDS (Intrusion Detection System) mode, its sniffing and logging functions operate in a semi-passive manner by default. To fully utilize these features, you can enable them explicitly using various parameters, such as:</p>
            <p><strong>paramaters:</strong><br>-i: Specify the network interface to monitor.<br>-v: Run in verbose mode to display packet details.<br>-d: Decode application layer data.<br>-e: Include link-layer information.<br>-X: Display full packet details in hexadecimal and ASCII.<br>-l: Define the logging directory.<br>-K ASCII: Save logs in plain text format for easier reading.<br></p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-N" (disable logging)</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -N
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump), the requested information will be displayed directly in the terminal. However, this means Snort won't save any logs to the designated log folder. Essentially, enabling these options redirects the output to the console instead of creating log files.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-D" background mode</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump) with packet logger mode (-l) you will still have the logs in the logs folder, but there will be no output in the console.</p>
            <p><strong>Info:</strong> Background mode will create a process, and you can check this process by executing this command in Linux:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -Dps -ef | grep snort
                <br>
                <br>
                root        1030    1800  0 02:05 ?        00:00:00 snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Info:</strong> If you want to kill this process, you need to execute the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo kill 1030
            </div>
            <p><strong>Important:</strong> It is not recommended to use this mode unless you have a working knowledge of Snort and stable configuration.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A console" </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A console
            </div>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A cmg"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A cmg
            </div>
            <p><strong>cmg mode:</strong> Cmg mode provides full packet details along with rule information.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A fast"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A fast
            </div>
            <p><strong>fast mode:</strong> fast style alerts contain summary information on the action like direction and alert header.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A full"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A full
            </div>
            <p><strong>full mode:</strong> full style alerts contain all possible information on the action.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A none"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A none
            </div>
            <p><strong>Important:</strong> here is no alert file. Snort only generated the log file.</p>
            <p><strong>Info:</strong> IDS/IPS mode: "Using rule file without configuration file"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/rules/local.rules -A console
            </div>
            <p><strong>Info:</strong> IPS mode and dropping packets</p>
            <p><strong>Note:</strong> To activate Snort in IPS mode, you can use the -Q parameter along with --daq afpacket. Alternatively, you can enable IPS mode by modifying the snort.conf file. The Data Acquisition (DAQ) modules are essential for IPS functionality. Using the afpacket module allows Snort to act as an IPS. For example, specify the interfaces like this: -i eth0:eth1. It's important to note that Snort in IPS mode requires at least two network interfaces—one for incoming traffic and another for outgoing traffic.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -Q --daq afpacket -i eth0:eth1 -A console
                <br>
                <br>
                10/14-02:30:50.80000  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.180.100.15 -> 192.180.100.114
            </div>
            <p><strong>Important:</strong> Snort is not just for monitoring network traffic, logging data, or identifying and blocking threats. It also has a feature called "PCAP read/investigate mode," which allows you to analyze PCAP files. When you load a PCAP file into Snort, it processes the data and provides you with traffic statistics by default, along with any alerts based on the rules you've set up. This means you can investigate network traffic that has already been captured in a PCAP file, not just live traffic.</p>
            <p><strong>Info:</strong> When you read a PCAP file without using any specific settings or parameters, Snort will just give you a basic overview of the packets and provide general statistics about the file. This is usually not very helpful. The real advantage of using Snort to analyze a PCAP file comes when you apply Snort's rules, which allow you to identify known threat patterns. This makes the investigation process faster and more efficient by automatically detecting potential threats based on these predefined patterns.</p>
            <p><strong>Snort Mode:</strong> PCAP mode parameters</p>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>-r / --pcap-single=  </td>
                        <td>    Read a single pcap</td>
                    </tr>
                    <tr>
                        <td>--pcap-list=""  </td>
                        <td>    Read pcaps provided in command (space separated).</td>
                    </tr>
                    <tr>
                        <td>--pcap-show</td>
                        <td>    Show pcap name on console during processing.</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>Info:</strong> Investigating single PCAP with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n 10
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-list"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-show"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show 
                <br>
                <br>
                Reading network traffic from "icmp-test.pcap" with snaplen = 1514
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                Reading network traffic from "http2.pcap" with snaplen = 1514
                12/12-12:13:35.213176  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong>  snort identified the traffic, distinguished each pcap file and prompted the alerts according to our ruleset. </p>
            <p><strong>Question:</strong> How does a Snort rule really work?</p>
            <img src="snorul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> A Snort rule defines an action, protocol, source and destination IPs, source and destination ports, and options to specify conditions for detecting or responding to network traffic.</p>
            <p><strong>Important:</strong> By default, Snort operates in passive mode, meaning it only monitors network traffic and alerts you about suspicious activity, functioning as an Intrusion Detection System (IDS). To enable Intrusion Prevention System (IPS) functionality, where Snort can actively block malicious traffic, you need to switch it to "inline mode."</p>
            <p><strong>Info:</strong> The Snort rule structure is easy to understand but difficult to produce. You should be familiar with rule options and related details to create efficient rules. </p>
            <p><strong>Info:</strong> Rules cannot be processed without a header, which is mandatory, while rule options are optional. However, without using rule options, it becomes nearly impossible to detect complex or advanced attacks.</p>
            <table border="1">
                <tr>
                  <th>Component</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Action</b></td>
                  <td>There are different actions a rule can take. It's important to understand how they work and test them before applying rules to live systems. Common actions include:</td>
                </tr>
                <tr>
                  <td>Alert</td>
                  <td>Triggers an alert and logs the packet.</td>
                </tr>
                <tr>
                  <td>Log</td>
                  <td>Simply logs the packet without triggering an alert.</td>
                </tr>
                <tr>
                  <td>Drop</td>
                  <td>Blocks the packet and logs it for review.</td>
                </tr>
                <tr>
                  <td>Reject</td>
                  <td>Blocks the packet, logs it, and also terminates the session associated with the packet.</td>
                </tr>
                <tr>
                  <td><b>Protocol</b></td>
                  <td>This defines the type of protocol that the rule is designed to filter. Snort supports four protocols in the rules: IP, TCP, UDP, and ICMP. While specific protocols like FTP aren't directly available, you can filter traffic based on port numbers, such as TCP traffic on port 21 to detect FTP traffic.</td>
                </tr>
              </table>
            <p><strong>Info:</strong> IP and Port Numbers</p>
            <p><strong>Note:</strong> These parameters identify the source and destination IP addresses and associated port numbers filtered for the rule.</p>
            <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>IP Filtering</b></td>
                  <td>This rule creates an alert for each ICMP packet originating from the 192.168.1.56 IP address.</td>
                </tr>
                <tr>
                  <td><b>Filter an IP Range</b></td>
                  <td>This rule creates an alert for each ICMP packet from the 192.168.1.0/24 subnet.</td>
                </tr>
                <tr>
                  <td><b>Filter Multiple IP Ranges</b></td>
                  <td>This rule creates an alert for each ICMP packet from either the 192.168.1.0/24 or 10.1.1.0/24 subnets.</td>
                </tr>
                <tr>
                  <td><b>Exclude IP Addresses/Ranges</b></td>
                  <td>This rule creates an alert for each ICMP packet not originating from the 192.168.1.0/24 subnet.</td>
                </tr>
                <tr>
                  <td><b>Port Filtering</b></td>
                  <td>This rule creates an alert for each TCP packet sent to port 21.</td>
                </tr>
                <tr>
                  <td><b>Exclude a Specific Port</b></td>
                  <td>This rule creates an alert for each TCP packet not sent to port 21.</td>
                </tr>
                <tr>
                  <td><b>Filter a Port Range (Type 1)</b></td>
                  <td>This rule creates an alert for each TCP packet sent to ports between 1-1024.</td>
                </tr>
                <tr>
                  <td><b>Filter a Port Range (Type 2)</b></td>
                  <td>This rule creates an alert for each TCP packet sent to ports less than or equal to 1024.</td>
                </tr>
                <tr>
                  <td><b>Filter a Port Range (Type 3)</b></td>
                  <td>This rule creates an alert for each TCP packet sent to source ports higher than or equal to 1025.</td>
                </tr>
                <tr>
                  <td><b>Filter a Port Range (Type 4)</b></td>
                  <td>This rule creates an alert for each TCP packet sent to port 21 or 23.</td>
                </tr>
              </table>
              <p><strong>Info:</strong> The direction operator indicates the traffic flow to be filtered by Snort. The left side of the rule shows the source, and the right side shows the destination. see the picture above</p>
              <table border="1" style="width: 30%;">
                <tr>
                  <th>Flow Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>-></b></td>
                  <td>Source to destination flow.</td>
                </tr>
                <tr>
                  <td><b><></b></td>
                  <td>Bidirectional flow.</td>
                </tr>
              </table>              
              <p><strong>Note:</strong> that there is no "<-" operator in Snort.</p>
              <p><strong>Info:</strong> three main rule options in Snort</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Option Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>General Rule Options</b></td>
                  <td>Fundamental rule options for Snort.</td>
                </tr>
                <tr>
                  <td><b>Payload Rule Options</b></td>
                  <td>Rule options that help investigate the payload data and detect specific payload patterns.</td>
                </tr>
                <tr>
                  <td><b>Non-Payload Rule Options</b></td>
                  <td>Rule options that focus on non-payload data to create specific patterns and identify network issues.</td>
                </tr>
              </table>
              <p><strong>Info:</strong> General Rule Options</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Msg</b></td>
                  <td>The message field is a basic prompt and identifier for the rule. When triggered, it displays a summary of the event in the console or log.</td>
                </tr>
                <tr>
                  <td><b>Sid</b></td>
                  <td>Snort rule IDs (SID) must have a proper format and unique value. There are three scopes for SIDs:
                    <ul>
                      <li>&lt;100: Reserved rules</li>
                      <li>100-999,999: Rules that come with the build</li>
                      <li>&gt;=1,000,000: User-created rules</li>
                    </ul>
                    Rules created by users should have SIDs greater than 100,000,000, and each SID must be unique.</td>
                </tr>
                <tr>
                  <td><b>Reference</b></td>
                  <td>This field provides additional information or references, such as CVE IDs or external links, explaining the purpose of the rule or associated threat patterns. It helps analysts during alert investigations.</td>
                </tr>
                <tr>
                  <td><b>Rev</b></td>
                  <td>The rev field tracks rule revisions. Analysts can use this to understand rule improvements, as each rule has a unique revision number. No auto-backup is available, so analysts must maintain rule history manually.</td>
                </tr>
                <tr>
                  <td><b>Example Rule</b></td>
                  <td>alert icmp any any &lt;&gt; any any (msg: "ICMP Packet Found"; sid: 100001; reference: cve, CVE-XXXX; rev: 1;)</td>
                </tr>
              </table>              
              <p><strong>Info:</strong> Payload Detection Rule Options</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Content</b></td>
                  <td>Matches specific payload data by ASCII, HEX, or both. This option can be used multiple times in a rule. However, the more specific patterns you add, the more time it takes to investigate packets.</td>
                </tr>
                <tr>
                  <td><b>Example: ASCII Mode</b></td>
                  <td>Creates an alert for each HTTP packet containing the keyword "GET". Case-sensitive.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ASCII)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Example: HEX Mode</b></td>
                  <td>Creates an alert for HTTP packets with the HEX representation of "GET".</td>
                </tr>
                <tr>
                  <td><b>Example Rule (HEX)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"|47 45 54|"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Nocase</b></td>
                  <td>Disables case sensitivity in the content match, making searches more flexible.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Nocase)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; nocase; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Fast_pattern</b></td>
                  <td>Optimizes the content search by prioritizing a specific content match for faster packet analysis. It is case-insensitive and can only be used once per rule. It's especially useful when there are multiple content options.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Fast_pattern)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; fast_pattern; content:"www"; sid: 100001; rev:1;)</td>
                </tr>
              </table>              
              <p><strong>Info:</strong> Non-Payload Detection Rule Options</p>
              <p><strong>Note:</strong> There are rule options that focus on non-payload data. These options will help create specific patterns and identify network issues.</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>ID</b></td>
                  <td>Filters based on the IP ID field. The ID field can be used to identify packets with a specific IP identification number.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ID)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "ID TEST"; id:123456; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Flags</b></td>
                  <td>Filters based on TCP flags. The following flags can be used:
                    <ul>
                      <li>F - FIN</li>
                      <li>S - SYN</li>
                      <li>R - RST</li>
                      <li>P - PSH</li>
                      <li>A - ACK</li>
                      <li>U - URG</li>
                    </ul>
                  </td>
                </tr>
                <tr>
                  <td><b>Example Rule (Flags)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "FLAG TEST"; flags:S; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Dsize</b></td>
                  <td>Filters based on the packet payload size. You can define a size range or use conditions like greater than or less than a specified size.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Dsize)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SEQ TEST"; dsize:100<>300; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Sameip</b></td>
                  <td>Filters for duplication of source and destination IP addresses in the packet.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Sameip)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SAME-IP TEST"; sameip; sid: 100001; rev:1;)</td>
                </tr>
              </table>              
              <p><strong>Important:</strong>  once you create a rule, it is a local rule and should be in your "local.rules" file. This file is located under "/etc/snort/rules/local.rules". </p>
              <div class="terminal">
                <span class="prompt">$</span> sudo nano /etc/snort/rules/local.rules 
            </div>
              <p><strong>Info:</strong>  That is your "local.rules" file. </p>
              <img src="locrul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>Info:</strong> Note that there are some default rules activated with snort instance. </p>
              <br>
              <br>
              <br>
              <br>
              <H1>Hands-on experience challenge.</H1>
              <p><strong>Problem:</strong> Write a single rule to detect "all TCP port 80 traffic" packets in the given pcap file.</p>
              <p><strong>My Rule:</strong> This is the rule that I have come for this challenge.
              <img src="mysnorule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <div class="terminal">
                <span class="prompt">$</span> alert tcp any any <> any 80 (msg: "detect port 80 trafic"; sid: 100001; rev:1;)
              </div>
              <p><strong>1:</strong> What is the number of detected packets?
              <img src="solvpac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="numbofpack.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>2:</strong> What is the destination address of packet 63?
              <p><strong>Info:</strong> Investigate the log file.
              <p><strong>Note:</strong> Remember that we have a lot of packages to analyze, so we need to find packet 63. This can be shortened by using the switch
              <img src="ques3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>3:</strong> What is the ACK number of packet 64?
              <img src="ques64.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>4:</strong> What is the SEQ number of packet 62?
              <img src="seq62.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>5:</strong> What is the TTL of packet 65??
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>6:</strong> What is the source IP of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>7:</strong> What is the source port of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a single rule to detect "all TCP port 21"
                <p><strong>8:</strong> What is the number of detected packets?
              <img src="detec21.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>9:</strong> What is the FTP service name?
              <img src="commandforx.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="readingservice.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect failed FTP login attempts
              <p><strong>10:</strong> What is the number of detected packets?
              <p><strong>Important:</strong> "For this, I would recommend using this link: https://tinyurl.com/ms9njv75
              <img src="530login.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect successful FTP logins
              <p><strong>11:</strong> What is the number of detected packets?
              <img src="230.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with a valid username but no password entered yet.
              <p><strong>12:</strong> What is the number of detected packets?
              <img src="331.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with the "Administrator" username but no password entered yet.
                <p><strong>13:</strong> What is the number of detected packets?
                <img src="ADMINYAYA.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room5', event)">Show Solution</button>
    </div>
</div>

<script>
    function toggleContent(room) {
        var content = document.getElementById(room);
        content.style.display = (content.style.display === 'none' || content.style.display === '') ? 'block' : 'none';
    }

    function toggleSolution(room, event) {
        var solution = document.getElementById("solution-" + room);
        var button = event.target;

        if (solution.style.display === 'none' || solution.style.display === '') {
            solution.style.display = 'block';
            button.textContent = "Hide Solution";
        } else {
            solution.style.display = 'none';
            button.textContent = "Show Solution";
        }
    }
</script>
</body>
</html>
