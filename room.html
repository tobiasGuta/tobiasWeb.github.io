<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <title>CTF Rooms</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Background container for animated GIF */
        .background-container {
    position: fixed; /* Cover the entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color:  #14161E; /* Dracula dark background */
    color: #f8f8f2; /* Light text color for contrast */
    font-family: 'Courier New', Courier, monospace; /* Monospace font for hacker aesthetic */
    z-index: -1; /* Ensure it stays behind other content */
}

h3 {
  color: #50FA7B; /* Replace with your desired color */
}

strong {
  color: red; /* Replace with your desired color */
}

        /* Main page styling */
        body {
            color: #F8F8F2;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            background: rgba(0, 0, 0, 0.85);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-x: hidden; /* Hide horizontal overflow */
            overflow-y: auto; /* Allow vertical scrolling */
        }

        /* Content styling */
        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-top: 60px;
            width: 100%;
        }

        /* Glitch Text Effect */
        .glitch-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            padding-top: 20px;
        }

        .glitch {
            font-size: 2.5em;
            color: #00ff00;
            animation: glitch 1s infinite;
            white-space: nowrap;
            position: relative;
        }

        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            color: #ff00ff;
            opacity: 0.8;
            clip: rect(0, 900px, 0, 0);
            animation: glitch 1s infinite;
        }

        .glitch::after {
            color: #00ffff;
            left: 2px;
            animation: glitch 1.2s infinite;
        }

        @keyframes glitch {
            0% { clip: rect(42px, 9999px, 44px, 0); transform: translate(0px, 0px); }
            20% { clip: rect(0px, 9999px, 44px, 0); transform: translate(2px, -2px); }
            40% { clip: rect(10px, 9999px, 38px, 0); transform: translate(-2px, 0px); }
            60% { clip: rect(15px, 9999px, 44px, 0); transform: translate(0px, 2px); }
            80% { clip: rect(30px, 9999px, 40px, 0); transform: translate(-1px, -1px); }
            100% { clip: rect(20px, 9999px, 40px, 0); transform: translate(1px, 1px); }
        }

        /* Room Section Styling */
        .room-section {
            border: 1px solid #00ff00;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            text-align: left;
            transition: transform 0.3s ease-in-out, margin 0.3s ease;
            width: 100%;
            max-width: 800px; /* Constrain width for larger screens */
        }

        /* When room section is expanded */
        .room-section.open {
            transform: scale(1.05);
            margin-bottom: 40px;
        }

        h2 {
            font-size: 1.5em;
            cursor: pointer;
        }

        h2:hover {
            color: #F1FA8C;
        }

        /* Collapsible content */
        .collapsible-content {
            display: none;
            padding-top: 10px;
            position: relative;
            animation: fadeIn 0.5s ease-in;
        }

        /* Fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hacking themed Back Button */
.back-button {
    background-color: transparent; /* Transparent background */
    color: white; /* White text by default */
    border: none; /* No border initially */
    padding: 12px 24px;
    border-radius: 5px;
    font-size: 1.2em;
    cursor: pointer;
    text-align: center;
    position: relative;
    overflow: hidden;
    outline: none; /* Remove the default outline (browser specific) */
    transition: color 0.3s, box-shadow 0.3s; /* Smooth transition for color and shadow */
}

/* Normal link hover (for back button) */
.back-button:hover {
    color: #2AF7A5; /* Change text color to #2AF7A5 */
    animation: pulse 1s infinite; /* Apply pulse effect */
    box-shadow: 0 0 10px #2AF7A5, 0 0 20px #2AF7A5, 0 0 30px #2AF7A5; /* Glowing effect */
    border: 2px solid #2AF7A5; /* Border appears only when hovering */
}

/* Pulse animation for hacker vibes */
@keyframes pulse {
    0% { 
        transform: scale(1);
        opacity: 1; 
    }
    50% { 
        transform: scale(1.1); 
        opacity: 0.8; 
    }
    100% { 
        transform: scale(1); 
        opacity: 1; 
    }
}

/* Back Button Container */
.back-button-container {
    position: relative;
    text-align: center;
    margin-top: 130px; /* Keep the position as it was */
}

        /* Navigation links styling */
        nav {
            display: inline-block;
            position: relative;
        }

        nav a {
            margin: 5px;
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            transition: background 0.3s;
        }

        nav a:hover {
            background: #00ff00;
            color: #1c1c1c;
        }

        /* Responsive styling for small screens (iPhone) */
        @media only screen and (max-width: 600px) {
            .glitch {
                font-size: 2em;
            }

            .glitch-container {
                padding-top: 10px;
            }

            h2 {
                font-size: 1.2em;
            }

            .room-section {
                padding: 10px;
                width: 90%;
                margin: 10px;
            }

            .back-button {
                font-size: 1em;
                margin-top: 70px;
                padding: 8px 16px;
            }

            .back-button-container {
                margin-top: 20px;
            }

            /* Ensure the back button stays centered */
            .content {
                margin-top: 70px;
            }

            .room-section h2 {
                font-size: 1.2em;
            }

            .collapsible-content {
                font-size: 0.9em;
                padding: 8px;
            }
        }
        .solution-button {
            background-color: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            margin-top: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: color 0.4s, background-color 0.4s;
            box-shadow: 0 0 5px #00ff00;
        }

        .solution-button:hover {
            color: #1c1c1c;
            background-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        .terminal {
      background-color: #1e1e1e; /* Dark terminal background */
      color: #d4d4d4; /* Light text for contrast */
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', Courier, monospace; /* Monospace font for terminal look */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); /* Subtle shadow for depth */
      overflow-x: auto; /* Handles long commands gracefully */
    }
    .prompt {
      color: #00ff00; /* Green color for the terminal prompt */
    }

/* General table styling */
table {
      width: 100%; /* Full-width table */
      margin: 20px auto;
      border-collapse: collapse;
      background-color: black;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Table header styling */
    th {
      background-color: #4CAF50;
      color: white;
      padding: 12px;
      text-align: left;
      font-size: 16px;
    }

    /* Table cell styling */
    td {
      padding: 7px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
    }

    /* Hover effect for rows */
    tr:hover {
      background-color: black;
    }

    /* Styling for the first row */
    tr:first-child {
      border-top: 2px solid #4CAF50;
    }

    /* Responsive design for small screens */
    @media (max-width: 600px) {
      table {
        width: 100%; /* Full width */
        font-size: 12px; /* Smaller text */
        margin: 10px; /* Smaller margin */
      }

      th, td {
        padding: 8px; /* Less padding */
      }

      th {
        font-size: 14px;
      }

      td {
        font-size: 12px;
      }

      /* Add horizontal scrolling for small screens */
      .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on mobile */
      }

      table {
        min-width: 600px; /* Prevent table from getting too small */
      }
    }

    /* Media Query for very small screens */
@media (max-width: 480px) {
  .ide-terminal {
    width: 100%; /* Take up full width on very small screens */
    padding: 6px; /* Adjust padding further */
  }

  .ide-prompt {
    font-size: 10px; /* Even smaller font size for very small screens */
  }

  .ide-code {
    font-size: 10px; /* Even smaller font size for very small screens */
    padding: 6px; /* Smaller padding */
  }
}

    /* Base button styling */
    .controls-wrapper {
  display: flex;
  flex-direction: column; /* Stack items vertically */
  justify-content: center; /* Center the items horizontally */
  align-items: center; /* Center the items vertically */
  gap: 10px; /* Adds space between the items */
  margin-top: 30px; /* Adjust this value to add gap from the top */
  margin-bottom: 0px;
}

#toggle-read-aloud {
  background-color: #111;
  color: white;
  font-family: 'Courier New', Courier, monospace;
  border: 2px solid #2AF7A5;
  padding: 3px 8px;
  text-transform: uppercase;
  font-size: 10px;
  cursor: pointer;
  outline: none;
  position: relative;
  transition: all 0.3s ease;
  display: inline-block;
  white-space: nowrap;
  width: auto;
  max-width: 150px;
  flex-shrink: 0;
}

#toggle-read-aloud:hover {
  background-color: #2AF7A5;
  color: #111;
  box-shadow: 0 0 8px 2px #2AF7A5;
}

#toggle-read-aloud:active {
  transform: scale(0.95);
}

select, input[type="range"] {
  background-color: #222;
  color: white;
  border: 2px solid #2AF7A5;
  padding: 8px 15px;
  font-family: 'Courier New', Courier, monospace;
  font-size: 15px;
  outline: none;
  width: auto;
  max-width: 150px;
  display: inline-block;
}

select:focus, input[type="range"]:focus {
  box-shadow: 0 0 5px 1px #2AF7A5;
}

/* IDE Terminal container */
.ide-terminal {
      background-color: #14161E; /* Dark background for the terminal */
      color: #abb2bf; /* Light text */
      border-radius: 8px;
      padding: 20px;
      width: 95%;
      max-width: 800px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
      font-size: 16px;
      line-height: 1.6;
      border: 1px solid #444c56; /* Light border for a subtle effect */
    }

    /* Style the prompt to look like an IDE */
    .ide-prompt {
      color: #56b6c2; /* Cyan color for prompt */
      font-weight: bold;
      display: inline;
    }

    /* Styling for the actual code content */
    .ide-code {
      display: block;
      margin-top: 10px;
      white-space: pre-wrap; /* Allow wrapping */
      word-wrap: break-word;
      font-size: 14px;
    }

    /* Style for keywords like 'ascii_values' and 'flag' */
    .keyword {
      color: #c678dd; /* Purple color for keywords */
      font-weight: bold;
    }

    /* Style for strings */
    .string {
      color: #98c379; /* Green color for strings */
    }

    /* Style for numbers */
    .number {
      color: #d19a66; /* Orange color for numbers */
    }

    /* Style for comments */
    .comment {
      color: #7f848e; /* Gray color for comments */
      font-style: italic;
    }

    /* Add subtle syntax highlighting for the entire line */
    .line {
      margin-bottom: 8px;
    }

    /* Optional: Add a subtle blink effect for the cursor */
    .ide-terminal::after {
      content: '|';
      display: inline-block;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% {
        opacity: 0;
      }
    }

    /* Responsive Design */
    @media screen and (max-width: 600px) {
      .ide-terminal {
        padding: 9px;
        font-size: 14px;
      }

      .ide-code {
        font-size: 12px; /* Smaller font size on mobile */
      }

      .ide-prompt {
        font-size: 14px; /* Slightly smaller prompt on small screens */
      }

      /* Adjust margins and padding for smaller screens */
      body {
        padding: 5px;
      }

      .line {
        margin-bottom: 5px; /* Reduce line spacing on smaller screens */
      }
    }

    /* Larger devices (Desktop and tablets) */
    @media screen and (min-width: 601px) {
      .ide-terminal {
        padding: 20px;
        font-size: 16px;
      }

      .ide-code {
        font-size: 14px;
      }

      .ide-prompt {
        font-size: 16px;
      }
    }


    </style>
</head>
<body>
    <!-- Background Container -->
    <div class="background-container"></div>

    <!-- Glitch Heading -->
    <div class="glitch-container">
        <h1 class="glitch" data-text="CTF Rooms & Sec Tips">CTF Rooms & Sec Tips</h1>
    </div>

    <div class="back-button-container">
        <button class="back-button" onclick="window.location.href='index.html'">
            <i class="fas fa-home"></i> Intro
        </button>
    </div>

    <!-- read aloud -->
    <div class="controls-wrapper">
      <button id="toggle-read-aloud" class="off" onclick="toggleReadAloud()">Toggle Read Aloud</button>
      <select id="voiceSelect"></select>
      <label for="pitch">Pitch: </label>
      <input type="range" id="pitch" min="0" max="2" step="0.1" value="1">
      <label for="rate">Rate: </label>
      <input type="range" id="rate" min="0.5" max="2" step="0.1" value="1">
    </div>
    

    <!-- Content with Room Sections -->
    <div class="content">

<!-- Room 1 -->
<div class="room-section">
    <h2 onclick="toggleContent('room1')">Tryhackme: Summit 🚀</h2>
    <div id="room1" class="collapsible-content">
        <img src="summit.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Can you chase a simulated adversary up the Pyramid of Pain until they finally back down?</p>
        <p><strong>Challenge Approach:</strong> The tester will be attempting to execute malware samples on a simulated internal user workstation. At the same time, you will need to configure PicoSecure's security tools to detect and prevent the malware from executing.</p>
        
        <!-- Question 1 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the first flag you receive after successfully detecting sample1.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q1" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl1[.]exe to see what we can find.</p>
            <img src="sample1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus doesn't do much damage, so we can block it by using its hash: MD5 cbda8ae000aa9cbe7c8b982bae006c2a</p>
            <img src="hasblock.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q1', event)">Show Solution</button>

        <!-- New Question 2 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the second flag you receive after successfully detecting sample2.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q2" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="sample2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="sample22.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does more things, such as networking activity like making GET requests to an IP and establishing connections.</p>
            <img src="firewal.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a firewall rule to block any connection to a specific IP.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q2', event)">Show Solution</button>

        <!-- New Question 3 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the third flag you receive after successfully detecting sample3.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q3" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="mail3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl3[.]exe to see what we can find.</p>
            <img src="dnns.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus also makes requests, but this time to specific domains instead of direct IP addresses. This method is advantageous for hackers because it helps them hide their true IP address, making it harder for security systems to trace the origin of the attack. By using domain names, attackers can also leverage techniques like Dynamic DNS or cloud-based services to further obscure their location.</p>
            <img src="dnsrule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's set up a DNS rule to block any connection to this Domain, Creating a DNS rule to block a domain involves configuring your network or firewall to prevent any device on your network from resolving a specific domain to its associated IP address. When a device tries to access a domain, the DNS server translates the domain name into an IP address. By creating a DNS block rule, you're essentially telling the DNS server to deny the request to resolve that domain, making it impossible for the malware or malicious activity to reach its destination.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q3', event)">Show Solution</button>

        <!-- New Question 4 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fourth flag you receive after successfully detecting sample4.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q4" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. </p>
            <img src="email4.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl4[.]exe to see what we can find.</p>
            <img src="registrac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus does even worse things, such as modifying the registry at Microsoft\Windows Defender\Real-Time Protection. This is the key for Windows Defender's Real-Time Protection. By tampering with it, the virus disables Windows Defender, preventing it from alerting the user to any malicious activity.</p>
            <img src="sigmarule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect this type of event, Sigma rules are a standardized, flexible way to define detection logic for various security events across different security platforms. They are designed to be platform-agnostic, meaning they can be used with any SIEM (Security Information and Event Management) system to identify suspicious activities.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q4', event)">Show Solution</button>
        
        <!-- New Question 5 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the fifth flag you receive after successfully detecting sample5.exe?</p>
        </div>

        <div class="solution-section" id="solution-room1-q5" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a log file</p>
            <img src="mail5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="logfile.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl5[.]exe to see what we can find.</p>
            <img src="sample5.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is even worse because it makes a lot of POST requests to a specific IP. To avoid detection, it establishes a connection every 30 minutes and sends a request of size 97 bytes. It's like it's communicating with a C2 (Command and Control) server</p>
            <img src="c2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect and block any attempts to connect to this specific Command and Control (C2) server. Sigma rules allow us to define detection patterns for suspicious activities across different security platforms. In this case, the rule would be designed to identify any network traffic trying to establish a connection with the identified C2 server, and then block it to prevent the malware from communicating with its attacker. By implementing this rule, we can strengthen our defenses and prevent the malware from receiving further commands or exfiltrating data</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q5', event)">Show Solution</button>

        <!-- New Question 6 -->
        <div class="question-section" style="margin-top: 60px;">
            <p><strong>Question:</strong> What is the final flag you receive from Sphinx?</p>
        </div>

        <div class="solution-section" id="solution-room1-q6" style="display: none;">
            <p><strong>Info:</strong> We got this email from Sphinx. He also provided a  Commands log file </p>
            <img src="sample6.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="commandlog.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> First, we need to run a scan on the virus sample sampl2[.]exe to see what we can find.</p>
            <img src="comvir.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> This virus is running a series of commands on the infected system to gather important information. It collects system details and network configuration data, likely to be used for reconnaissance or further exploitation.</p>
            <img src="sigmareco.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Solution:</strong> Let's create a Sigma rule to detect a specific string being run, in this case: %temp%\exfiltr8[.]log.</p>
        </div>

        <button class="solution-button" onclick="toggleSolution('room1-q6', event)">Show Solution</button>
    </div>
</div>





<!-- Room 2 -->
<div class="room-section">
    <h2 onclick="toggleContent('room2')">Tactical Detection 🛡️</h2>
    <div id="room2" class="collapsible-content">
        <img src="tacticaldetection.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> understand the mindset behind choosing a tactical approach in alerting and detecting threats, IOAs, IOCs, etc.</p>
        <p><strong>Challenge Approach:</strong> the most efficient ways to bolster an organization's security posture by leveraging detection mechanisms and walking the user through setting them up tactically. This should serve as a baseline where the user will be able to learn the basics, implement them in their functions, and make them truly their own.</p>
        <div class="question-section">
            <p><strong>Setting up a Basic Tripwire</strong></p>
        </div>

        <div class="solution-section" id="solution-room2" style="display: none;">
            <p><strong>Info:</strong> Open The local security policy application, then navigate to Security Settings → Local Policies → Audit Policy and Open the Audit object access policy.</p>
            <img src="localapplication.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Check the boxes next to Success and Failure, then click Apply and OK to ensure that all access attempts—whether successful or not—will be logged. Once you're done, you can close the Local Security Policy application.</p>
            <img src="succandfai.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> After configuring the Local Security Policy, monitoring won’t start automatically. We need to specify which files or folders to track. To set this up, right-click on the desktop, choose New → Text Document, and name the file Secret Document.</p>
            <img src="note.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Infor:</strong>  Then, right-click the file, select Properties → Security → Advanced → Auditing to set up monitoring for this document in our tripwire configuration</p>
            <img src="properties.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This is where we will create and specify an audit entry for our Secret Document. Click on Add → Select a principal.</p>
            <img src="propertiesname.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> This pop-up allows us to specify which users or groups we want to be notified about when they access the Secret Document. While you can be very specific, for this example, we’ll keep it simple. In the text box, type "Everyone" and press Enter to monitor all users.</p>
            <img src="propn.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="donevery.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> The Principal should now show "Everyone," and the permissions will allow you to specify which actions to audit on the Secret Document. For a broader selection, click Show advanced permissions in the top-right corner. Once you're done, click OK, then Apply and OK on the Audit entry page, and finally, click OK on the Secret Document properties. If you're tracking multiple files, it’s recommended to organize them into folders for easier auditing. The setup is now complete, and auditing is active for the Secret Document. Any access attempts will be logged in the Security event log with Event ID 4663, which can be filtered and used to generate alerts, allowing analysts to quickly detect when a tripwire is triggered, thereby enhancing the organization's security.</p>
            <img src="done.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Detecting:</strong> Now it's time to detect it.</p>
            <p><strong>Info:</strong> Let's open this file using CMD.</p>
            <img src="notcm.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> Now, let's use the FullEventLogView application to view the logs.</p>
            <img src="loappl.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Lessons Learned:</strong> Applying tactical detection is important because it enables proactive monitoring of system activities and potential security threats in real-time. By auditing access to sensitive files, such as the Secret Document, and logging every interaction with them, you can quickly identify suspicious or unauthorized behavior. This helps in detecting potential security breaches early, enabling swift response and mitigation.</p>
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room2', event)">Show Solution</button>
    </div>
</div>

<!-- Room 3 -->
<div class="room-section">
    <h2 onclick="toggleContent('room3')">Tryhackme: Friday Overtime 🐼</h2>
    <div id="room3" class="collapsible-content">
        <img src="evilpanda.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> It's a Friday evening at PandaProbe Intelligence when a notification appears on your CTI platform. While most are already looking forward to the weekend, you realise you must pull overtime because SwiftSpend Finance has opened a new ticket, raising concerns about potential malware threats. The finance company, known for its meticulous security measures, stumbled upon something suspicious and wanted immediate expert analysis.</p>
        <p><strong>Challenge Approach:</strong> As the only remaining CTI Analyst on shift at PandaProbe Intelligence, you quickly took charge of the situation, realising the gravity of a potential breach at a financial institution. The ticket contained multiple file attachments, presumed to be malware samples. With a deep breath, a focused mind, and the longing desire to go home, you began the process of:</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room3" style="display: none;">
            <p><strong>Question:</strong> Who shared the malware samples?</p>
            <img src="emailpanda1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the file "pRsm.dll" inside samples.zip?</p>
            <img src="unzisam.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="shh1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Which MITRE ATT&CK Technique is linked to using pRsm.dll in this malware framework?</p>
            <img src="techniq.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="techni2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the CyberChef defanged URL of the malicious download location first seen on 2020-11-02? let's visit this site: hxxps[://]tinyurl[.]com/AptGroup for more information</p>
            <img src="url.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="urllin.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the CyberChef defanged IP address of the C&C server first detected on 2020-09-14 using these modules?</p>
            <img src="ippand.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong> What is the SHA1 hash of the spyagent family spyware hosted on the same IP targeting Android devices on November 16, 2022?</p>
            <img src="checckip.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="androtar.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="andrhas.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room3', event)">Show Solution</button>
    </div>
</div>

<!-- Room 4 -->
<div class="room-section">
    <h2 onclick="toggleContent('room4')">Tryhackme: Trooper 
        <img src="https://flagcdn.com/w40/cn.png" alt="China Flag" width="20" height="15">
    </h2>
    <div id="room4" class="collapsible-content">
        <img src="grouptropper.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> A multinational technology company has been the target of several cyber attacks in the past few months. The attackers have been successful in stealing sensitive intellectual property and causing disruptions to the company's operations. A threat advisory report about similar attacks has been shared, and as a CTI analyst, your task is to identify the Tactics, Techniques, and Procedures (TTPs) being used by the Threat group and gather as much information as possible about their identity and motive. .</p>
        <p><strong>Challenge Approach:</strong> you will utilise the OpenCTI platform as well as the MITRE ATT&CK navigator</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room4" style="display: none;">
            <p><strong>Question:</strong> What kind of phishing campaign does APT X use as part of their TTPs?</p>
            <embed src="APT X_USBFerry.pdf" type="application/pdf" width="100%" height="500px">
            <p style="font-family: 'Courier New', monospace; color: #00ff00; text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;">
                If the PDF doesn’t display, 
                <a href="APT X_USBFerry.pdf" download style="color: #00ff00; text-decoration: none;">
                    click here to download it
                </a>
                <span class="cursor">|</span>.
            </p>
            <p><strong>Question:</strong> What is the name of the malware used by APT X?</p>
            <p><strong>Question:</strong>What is the malware's STIX ID?</p>
            <img src="usbb1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="usbb2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>With the use of a USB, what technique did APT X use for initial access?</p>
            <img src="subb3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the identity of APT X? </p>
            <img src="ggrroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>On OpenCTI, how many Attack Pattern techniques are associated with the APT?</p>
            <img src="attackpattern.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What is the name of the tool linked to the APT?</p>
            <img src="togroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Load up the Navigator. What is the sub-technique used by the APT under Valid Accounts?</p>
            <img src="locgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>Under what Tactics does the technique above fall?</p>
            <img src="iatac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <img src="tecgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Question:</strong>What technique is the group known for using under the tactic Collection?</p>
            <img src="autgroup.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room4', event)">Show Solution</button>
    </div>
</div>

<!-- Room 5 -->
<div class="room-section">
    <h2 onclick="toggleContent('room5')">Snort - Intrusion Detection System (IDS) and an Intrusion Prevention System (IPS) 🐷 </h2>
    <div id="room5" class="collapsible-content">
        <img src="snort.png" alt="Room 5 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Description:</strong> Snort is a powerful open-source network intrusion detection system (IDS) and intrusion prevention system (IPS) developed by Martin Roesch and maintained by Cisco Systems. It analyzes network traffic in real-time, identifying suspicious patterns or behaviors that may indicate a security threat. With its extensive rule-based language, Snort can detect attacks, log malicious traffic, and even block it when configured as an IPS.</p>
        <p><strong>Challenge Approach:</strong> Setting up Snort</p>
        <div class="question-section">
            <p><strong>Let's do it</strong></p>
        </div>

        <div class="solution-section" id="solution-room5" style="display: none;">
            <p><strong>Info:</strong>Let's start by installing Snort. You can find the information on this website: snort[.]org.</p>
            <p><strong>Installation:</strong> If you're using Linux, you can install Snort by running the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo apt install snort -y
            </div>
            <p><strong>Info:</strong>  Setting up Snort using the -X option for full packet dump mode.</p>
            <p><strong>Info:</strong>  These are different switches, such as verbose mode (-v), using the interface (-i), dumping packet data mode (-d), dump (-d), and link-layer header grabbing (-e).</p>
            <p><strong>Info:</strong> Sending a ping request to the machine to check if Snort is able to detect it</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -X
            </div>
            <img src="pin1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <div class="terminal">
                <span class="prompt">$</span> ping -c 5 VICTIM-IP
            </div>
            <img src="pin2.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong>  Run Snort in Logger Mode.</p>
            <p><strong>Important:</strong> Before diving into generating and analyzing logs, it's crucial to understand Linux file ownership and permissions. Snort requires superuser (root) privileges to sniff network traffic. When you run Snort using the sudo command, any log files it creates will be owned by the root account. As a result, you'll need root privileges to access and analyze these log files.</p>
            <p><strong>Info:</strong>  Logging with parameter "-l".</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -l .
            </div>
            <p><strong>Info:</strong> Snort captures and logs packets to a specified directory, which can be set in the snort.config file. Alternatively, you can use the -l option to specify a custom directory for log files. While the default log directory is ideal for ongoing monitoring, the -l option is particularly handy for testing scenarios, For example, using -l . in the command saves the logs directly to the current working directory.</p>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                snort.log.123456789
            </div>
            <p><strong>Info:</strong> Logging with parameter "-K ASCII"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dev -K ASCII -l .
            </div>
            <p><strong>Inportant:</strong> Note that the log file names will be different in your case. </p>
            <div class="terminal">
                <span class="prompt">$</span> ls .        
                <br>
                <br>
                192.168.43.112  172.16.87.25  snort.log.123456789
            </div>
            <p><strong>Info:</strong> On examining the generated folders, you'll notice that the logs are stored in an organized, categorized format and saved as ASCII files. This means the logs can be easily read and analyzed directly, without requiring a Snort instance to interpret them.</p>
            <p><strong>Info:</strong> In ASCII mode, logs are stored in a human-readable format and split into multiple files, making it easy to view them with a simple text editor. On the other hand, logs in binary format are not readable by humans and must be analyzed using tools like Snort or tcpdump to make sense of the data.</p>
            <p><strong>Info:</strong> Reading generated logs with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r snort.log.123456789       
                <br>
                <br>
                Running in packet dump mode

                        --== Initializing Snort ==--
                Initializing Output Plugins!
                pcap DAQ configured to read-file.
                Acquiring network traffic from "snort.log.123456789".

                        --== Initialization Complete ==--
                ...
                Commencing packet processing (pid=3025)
                WARNING: No preprocessors configured for policy 0.
                12/02-08:15:05.567834 10.0.0.5 -> 8.8.8.8
                UDP TTL:128 TOS:0x10 ID:10045 IpLen:20 DgmLen:72
                SrcPort:55444 DstPort:53  
                DNS Query: www.example.com
                =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
                WARNING: No preprocessors configured for policy 0.
                12/02-08:16:12.789654 192.168.1.101 -> 93.184.216.34
                TCP TTL:64 TOS:0x0 ID:34560 IpLen:20 DgmLen:52 DF
                Seq:123456789  Ack:987654321 Win:8192
                Flags: S  SYN Packet
                ===============================================================================
                Packet I/O Totals:
                Received:           75
                Analyzed:           75 (100.000%)
                    Dropped:            0 (  0.000%)
                Filtered:            0 (  0.000%)
                Outstanding:            0 (  0.000%)
                Injected:            0
                ===============================================================================
                Breakdown by protocol (includes rebuilt packets):
                ...
                    Total:           75
                ===============================================================================
                Snort exiting
            </div>
            <p><strong>Inportant:</strong> It's important to note that Snort can process and interpret binary-format logs, which can also be viewed using tools like tcpdump and Wireshark. However, if you generate logs using the -K ASCII parameter, Snort will be unable to read them. As shown in the output above, Snort successfully read and displayed the log file in the same way it would when operating in sniffer mode.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo tcpdump -r snort.log.123456789 -ntc 10       
                <br>
                <br>
                reading from file snort.log.123456789, link-type EN10MB (Ethernet)
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [SYN] Seq=1 Ack=0 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [SYN, ACK] Seq=1 Ack=2 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [ACK] Seq=2 Ack=1 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: HTTP GET /index.html HTTP/1.1
                IP 10.1.2.3 > 192.168.0.5: HTTP 200 OK
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [FIN, ACK] Seq=1000 Ack=2000 Win=8192 Len=0
                IP 10.1.2.3 > 192.168.0.5: TCP 12345 > 80 [FIN, ACK] Seq=2000 Ack=1001 Win=65535 Len=0
                IP 192.168.0.5 > 10.1.2.3: UDP 12345 > 53 Len=50
                IP 10.1.2.3 > 192.168.0.5: UDP 53 > 12345 Len=50
                IP 192.168.0.5 > 10.1.2.3: TCP 80 > 12345 [RST] Seq=1000 Win=0 Len=0
            </div>
            <p><strong>Info:</strong> The -r parameter enables users to apply filters to binary log files. By using this parameter along with Berkeley Packet Filters (BPF), you can narrow down the processed logs to view only specific packets that match your filter criteria.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -r myfile.log -X
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log icmp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log tcp
                <br>
                <span class="prompt">$</span> sudo snort -r myfile.log 'udp and port 53'
            </div>
            <p><strong>Inportant:</strong> The result will be similar to the previous one, but it will display only packets that match the specified protocol. You can also control how many packets to process by using the -n parameter. For example, the following command will process just the first 10 packets from the log: </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -dvr logname.log -n 10
            </div>
            <p><strong>Resources about BPF:</strong> https://tinyurl.com/42kymtty <br>https://tinyurl.com/2k4ha737<br>https://tinyurl.com/3nx43hpp<br></p>
            <p><strong>Important:</strong> IDS/IPS mode helps you manage the traffic according to user-defined rules, (N)IDS/IPS mode depends on the rules and configuration.</p>
            <p><strong>Info:</strong> NIDS mode parameters</p>
            <p><strong>paramater -c:</strong> Defining the configuration file.</p>
            <p><strong>paramater -T:</strong> Testing the configuration file.</p>
            <p><strong>paramater -N:</strong> Disable logging.</p>
            <p><strong>paramater -D:</strong> Background mode.</p>
            <p><strong>paramater -A:</strong> Alert modes;<br>full: Full alert mode, providing all possible<br>information about the alert. This one also is the default mode; once you use -A and don't specify any mode, snort uses this mode.<br>fast:  Fast mode shows the alert message, timestamp, source and destination IP, along with port numbers.<br>console: Provides fast style alerts on the console screen.<br>cmg: CMG style, basic header details with payload in hex and text format.<br>none: Disabling alerting<br></p>
            <p><strong>Info:</strong> Once you start running IDS/IPS mode, you need to use rules.</p>
            <p><strong>Rule ICMP:</strong> pre-defined ICMP rule as an example</p>
            <div class="terminal">
                <span class="prompt"></span> alert icmp any any <> any any  (msg: "ICMP Packet Found"; sid: 100001; rev:1;)
            </div>
            <p><strong>Info:</strong> This rule is located in "/etc/snort/rules/local.rules"</p>
            <p><strong>Info:</strong> Snort generates an "alert" file whenever it detects traffic that matches one of its alert rules. Additionally, when you run Snort in IPS (Intrusion Prevention System) or IDS (Intrusion Detection System) mode, its sniffing and logging functions operate in a semi-passive manner by default. To fully utilize these features, you can enable them explicitly using various parameters, such as:</p>
            <p><strong>paramaters:</strong><br>-i: Specify the network interface to monitor.<br>-v: Run in verbose mode to display packet details.<br>-d: Decode application layer data.<br>-e: Include link-layer information.<br>-X: Display full packet details in hexadecimal and ASCII.<br>-l: Define the logging directory.<br>-K ASCII: Save logs in plain text format for easier reading.<br></p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-N" (disable logging)</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -N
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump), the requested information will be displayed directly in the terminal. However, this means Snort won't save any logs to the designated log folder. Essentially, enabling these options redirects the output to the console instead of creating log files.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-D" background mode</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Inportant:</strong> When you run Snort with specific parameters like -v (verbosity) or -X (full packet dump) with packet logger mode (-l) you will still have the logs in the logs folder, but there will be no output in the console.</p>
            <p><strong>Info:</strong> Background mode will create a process, and you can check this process by executing this command in Linux:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -Dps -ef | grep snort
                <br>
                <br>
                root        1030    1800  0 02:05 ?        00:00:00 snort -c /etc/snort/snort.conf -D
            </div>
            <p><strong>Info:</strong> If you want to kill this process, you need to execute the following command:</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo kill 1030
            </div>
            <p><strong>Important:</strong> It is not recommended to use this mode unless you have a working knowledge of Snort and stable configuration.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A console" </p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A console
            </div>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A cmg"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A cmg
            </div>
            <p><strong>cmg mode:</strong> Cmg mode provides full packet details along with rule information.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A fast"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A fast
            </div>
            <p><strong>fast mode:</strong> fast style alerts contain summary information on the action like direction and alert header.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A full"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A full
            </div>
            <p><strong>full mode:</strong> full style alerts contain all possible information on the action.</p>
            <p><strong>Info:</strong> IDS/IPS mode with parameter "-A none"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -A none
            </div>
            <p><strong>Important:</strong> here is no alert file. Snort only generated the log file.</p>
            <p><strong>Info:</strong> IDS/IPS mode: "Using rule file without configuration file"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/rules/local.rules -A console
            </div>
            <p><strong>Info:</strong> IPS mode and dropping packets</p>
            <p><strong>Note:</strong> To activate Snort in IPS mode, you can use the -Q parameter along with --daq afpacket. Alternatively, you can enable IPS mode by modifying the snort.conf file. The Data Acquisition (DAQ) modules are essential for IPS functionality. Using the afpacket module allows Snort to act as an IPS. For example, specify the interfaces like this: -i eth0:eth1. It's important to note that Snort in IPS mode requires at least two network interfaces—one for incoming traffic and another for outgoing traffic.</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -Q --daq afpacket -i eth0:eth1 -A console
                <br>
                <br>
                10/14-02:30:50.80000  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.180.100.15 -> 192.180.100.114
            </div>
            <p><strong>Important:</strong> Snort is not just for monitoring network traffic, logging data, or identifying and blocking threats. It also has a feature called "PCAP read/investigate mode," which allows you to analyze PCAP files. When you load a PCAP file into Snort, it processes the data and provides you with traffic statistics by default, along with any alerts based on the rules you've set up. This means you can investigate network traffic that has already been captured in a PCAP file, not just live traffic.</p>
            <p><strong>Info:</strong> When you read a PCAP file without using any specific settings or parameters, Snort will just give you a basic overview of the packets and provide general statistics about the file. This is usually not very helpful. The real advantage of using Snort to analyze a PCAP file comes when you apply Snort's rules, which allow you to identify known threat patterns. This makes the investigation process faster and more efficient by automatically detecting potential threats based on these predefined patterns.</p>
            <p><strong>Snort Mode:</strong> PCAP mode parameters</p>
            <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>-r / --pcap-single=  </td>
                        <td>    Read a single pcap</td>
                    </tr>
                    <tr>
                        <td>--pcap-list=""  </td>
                        <td>    Read pcaps provided in command (space separated).</td>
                    </tr>
                    <tr>
                        <td>--pcap-show</td>
                        <td>    Show pcap name on console during processing.</td>
                    </tr>
                </tbody>
            </table>
            </div>
            <p><strong>Info:</strong> Investigating single PCAP with parameter "-r"</p>
            <div class="terminal">
                <span class="prompt">$</span> sudo snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n 10
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-list"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console
                <br>
                <br>
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong> snort identified the traffic and prompted the alerts according to our ruleset.</p>
            <p><strong>Info:</strong> Investigating multiple PCAPs with parameter "--pcap-show"</p>
            <div class="terminal">
                <span class="prompt">$</span>  sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show 
                <br>
                <br>
                Reading network traffic from "icmp-test.pcap" with snaplen = 1514
                12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -> 142.250.187.110
                <br>
                ...
                <br>
                Reading network traffic from "http2.pcap" with snaplen = 1514
                12/12-12:13:35.213176  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -> 192.168.175.129
            </div>
            <p><strong>Info:</strong>  snort identified the traffic, distinguished each pcap file and prompted the alerts according to our ruleset. </p>
            <p><strong>Question:</strong> How does a Snort rule really work?</p>
            <img src="snorul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
            <p><strong>Info:</strong> A Snort rule defines an action, protocol, source and destination IPs, source and destination ports, and options to specify conditions for detecting or responding to network traffic.</p>
            <p><strong>Important:</strong> By default, Snort operates in passive mode, meaning it only monitors network traffic and alerts you about suspicious activity, functioning as an Intrusion Detection System (IDS). To enable Intrusion Prevention System (IPS) functionality, where Snort can actively block malicious traffic, you need to switch it to "inline mode."</p>
            <p><strong>Info:</strong> The Snort rule structure is easy to understand but difficult to produce. You should be familiar with rule options and related details to create efficient rules. </p>
            <p><strong>Info:</strong> Rules cannot be processed without a header, which is mandatory, while rule options are optional. However, without using rule options, it becomes nearly impossible to detect complex or advanced attacks.</p>
            <div class="table-container">
            <table border="1">
                <tr>
                  <th>Component</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Action</b></td>
                  <td>There are different actions a rule can take. It's important to understand how they work and test them before applying rules to live systems. Common actions include:</td>
                </tr>
                <tr>
                  <td>Alert</td>
                  <td>Triggers an alert and logs the packet.</td>
                </tr>
                <tr>
                  <td>Log</td>
                  <td>Simply logs the packet without triggering an alert.</td>
                </tr>
                <tr>
                  <td>Drop</td>
                  <td>Blocks the packet and logs it for review.</td>
                </tr>
                <tr>
                  <td>Reject</td>
                  <td>Blocks the packet, logs it, and also terminates the session associated with the packet.</td>
                </tr>
                <tr>
                  <td><b>Protocol</b></td>
                  <td>This defines the type of protocol that the rule is designed to filter. Snort supports four protocols in the rules: IP, TCP, UDP, and ICMP. While specific protocols like FTP aren't directly available, you can filter traffic based on port numbers, such as TCP traffic on port 21 to detect FTP traffic.</td>
                </tr>
              </table>
            </div>
            <p><strong>Info:</strong> IP and Port Numbers</p>
            <p><strong>Note:</strong> These parameters identify the source and destination IP addresses and associated port numbers filtered for the rule.</p>
            <div class="table-container">
              <table border="1" style="width: 100%;">
                  <tr>
                    <th>Rule Type</th>
                    <th>Description</th>
                  </tr>
                  <tr>
                    <td><b>IP Filtering</b></td>
                    <td>This rule creates an alert for each ICMP packet originating from the 192.168.1.56 IP address.</td>
                  </tr>
                  <tr>
                    <td><b>Filter an IP Range</b></td>
                    <td>This rule creates an alert for each ICMP packet from the 192.168.1.0/24 subnet.</td>
                  </tr>
                  <tr>
                    <td><b>Filter Multiple IP Ranges</b></td>
                    <td>This rule creates an alert for each ICMP packet from either the 192.168.1.0/24 or 10.1.1.0/24 subnets.</td>
                  </tr>
                  <tr>
                    <td><b>Exclude IP Addresses/Ranges</b></td>
                    <td>This rule creates an alert for each ICMP packet not originating from the 192.168.1.0/24 subnet.</td>
                  </tr>
                  <tr>
                    <td><b>Port Filtering</b></td>
                    <td>This rule creates an alert for each TCP packet sent to port 21.</td>
                  </tr>
                  <tr>
                    <td><b>Exclude a Specific Port</b></td>
                    <td>This rule creates an alert for each TCP packet not sent to port 21.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 1)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to ports between 1-1024.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 2)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to ports less than or equal to 1024.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 3)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to source ports higher than or equal to 1025.</td>
                  </tr>
                  <tr>
                    <td><b>Filter a Port Range (Type 4)</b></td>
                    <td>This rule creates an alert for each TCP packet sent to port 21 or 23.</td>
                  </tr>
                </table>
              </div>
              <p><strong>Info:</strong> The direction operator indicates the traffic flow to be filtered by Snort. The left side of the rule shows the source, and the right side shows the destination. see the picture above</p>
              <div class="table-container">
              <table border="1" style="width: 30%;">
                <tr>
                  <th>Flow Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>-></b></td>
                  <td>Source to destination flow.</td>
                </tr>
                <tr>
                  <td><b><></b></td>
                  <td>Bidirectional flow.</td>
                </tr>
              </table>              
              <p><strong>Note:</strong> that there is no "<-" operator in Snort.</p>
              <p><strong>Info:</strong> three main rule options in Snort</p>
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Option Type</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>General Rule Options</b></td>
                  <td>Fundamental rule options for Snort.</td>
                </tr>
                <tr>
                  <td><b>Payload Rule Options</b></td>
                  <td>Rule options that help investigate the payload data and detect specific payload patterns.</td>
                </tr>
                <tr>
                  <td><b>Non-Payload Rule Options</b></td>
                  <td>Rule options that focus on non-payload data to create specific patterns and identify network issues.</td>
                </tr>
              </table>
              </div>
              <p><strong>Info:</strong> General Rule Options</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Msg</b></td>
                  <td>The message field is a basic prompt and identifier for the rule. When triggered, it displays a summary of the event in the console or log.</td>
                </tr>
                <tr>
                  <td><b>Sid</b></td>
                  <td>Snort rule IDs (SID) must have a proper format and unique value. There are three scopes for SIDs:
                    <ul>
                      <li>&lt;100: Reserved rules</li>
                      <li>100-999,999: Rules that come with the build</li>
                      <li>&gt;=1,000,000: User-created rules</li>
                    </ul>
                    Rules created by users should have SIDs greater than 100,000,000, and each SID must be unique.</td>
                </tr>
                <tr>
                  <td><b>Reference</b></td>
                  <td>This field provides additional information or references, such as CVE IDs or external links, explaining the purpose of the rule or associated threat patterns. It helps analysts during alert investigations.</td>
                </tr>
                <tr>
                  <td><b>Rev</b></td>
                  <td>The rev field tracks rule revisions. Analysts can use this to understand rule improvements, as each rule has a unique revision number. No auto-backup is available, so analysts must maintain rule history manually.</td>
                </tr>
                <tr>
                  <td><b>Example Rule</b></td>
                  <td>alert icmp any any &lt;&gt; any any (msg: "ICMP Packet Found"; sid: 100001; reference: cve, CVE-XXXX; rev: 1;)</td>
                </tr>
              </table>    
              </div>          
              <p><strong>Info:</strong> Payload Detection Rule Options</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>Content</b></td>
                  <td>Matches specific payload data by ASCII, HEX, or both. This option can be used multiple times in a rule. However, the more specific patterns you add, the more time it takes to investigate packets.</td>
                </tr>
                <tr>
                  <td><b>Example: ASCII Mode</b></td>
                  <td>Creates an alert for each HTTP packet containing the keyword "GET". Case-sensitive.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ASCII)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Example: HEX Mode</b></td>
                  <td>Creates an alert for HTTP packets with the HEX representation of "GET".</td>
                </tr>
                <tr>
                  <td><b>Example Rule (HEX)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"|47 45 54|"; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Nocase</b></td>
                  <td>Disables case sensitivity in the content match, making searches more flexible.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Nocase)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; nocase; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Fast_pattern</b></td>
                  <td>Optimizes the content search by prioritizing a specific content match for faster packet analysis. It is case-insensitive and can only be used once per rule. It's especially useful when there are multiple content options.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Fast_pattern)</b></td>
                  <td>alert tcp any any &lt;&gt; any 80 (msg: "GET Request Found"; content:"GET"; fast_pattern; content:"www"; sid: 100001; rev:1;)</td>
                </tr>
              </table>    
              </div>           
              <p><strong>Info:</strong> Non-Payload Detection Rule Options</p>
              <p><strong>Note:</strong> There are rule options that focus on non-payload data. These options will help create specific patterns and identify network issues.</p>
              <div class="table-container">
              <table border="1" style="width: 100%;">
                <tr>
                  <th>Rule Field</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td><b>ID</b></td>
                  <td>Filters based on the IP ID field. The ID field can be used to identify packets with a specific IP identification number.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (ID)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "ID TEST"; id:123456; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Flags</b></td>
                  <td>Filters based on TCP flags. The following flags can be used:
                    <ul>
                      <li>F - FIN</li>
                      <li>S - SYN</li>
                      <li>R - RST</li>
                      <li>P - PSH</li>
                      <li>A - ACK</li>
                      <li>U - URG</li>
                    </ul>
                  </td>
                </tr>
                <tr>
                  <td><b>Example Rule (Flags)</b></td>
                  <td>alert tcp any any &lt;&gt; any any (msg: "FLAG TEST"; flags:S; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Dsize</b></td>
                  <td>Filters based on the packet payload size. You can define a size range or use conditions like greater than or less than a specified size.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Dsize)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SEQ TEST"; dsize:100<>300; sid: 100001; rev:1;)</td>
                </tr>
                <tr>
                  <td><b>Sameip</b></td>
                  <td>Filters for duplication of source and destination IP addresses in the packet.</td>
                </tr>
                <tr>
                  <td><b>Example Rule (Sameip)</b></td>
                  <td>alert ip any any &lt;&gt; any any (msg: "SAME-IP TEST"; sameip; sid: 100001; rev:1;)</td>
                </tr>
              </table>
              </div>              
              <p><strong>Important:</strong>  once you create a rule, it is a local rule and should be in your "local.rules" file. This file is located under "/etc/snort/rules/local.rules". </p>
              <div class="terminal">
                <span class="prompt">$</span> sudo nano /etc/snort/rules/local.rules 
            </div>
              <p><strong>Info:</strong>  That is your "local.rules" file. </p>
              <img src="locrul.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>Info:</strong> Note that there are some default rules activated with snort instance. </p>
              <br>
              <br>
              <br>
              <br>
              <H1>Hands-on experience challenge.</H1>
              <p><strong>Problem:</strong> Write a single rule to detect "all TCP port 80 traffic" packets in the given pcap file.</p>
              <p><strong>My Rule:</strong> This is the rule that I have come for this challenge.
              <img src="mysnorule.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <div class="terminal">
                <span class="prompt">$</span> alert tcp any any <> any 80 (msg: "detect port 80 trafic"; sid: 100001; rev:1;)
              </div>
              <p><strong>1:</strong> What is the number of detected packets?
              <img src="solvpac.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="numbofpack.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>2:</strong> What is the destination address of packet 63?
              <p><strong>Info:</strong> Investigate the log file.
              <p><strong>Note:</strong> Remember that we have a lot of packages to analyze, so we need to find packet 63. This can be shortened by using the switch
              <img src="ques3.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>3:</strong> What is the ACK number of packet 64?
              <img src="ques64.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>4:</strong> What is the SEQ number of packet 62?
              <img src="seq62.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>5:</strong> What is the TTL of packet 65??
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>6:</strong> What is the source IP of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>7:</strong> What is the source port of packet 65?
              <img src="tripleques.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a single rule to detect "all TCP port 21"
                <p><strong>8:</strong> What is the number of detected packets?
              <img src="detec21.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>9:</strong> What is the FTP service name?
              <img src="commandforx.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <img src="readingservice.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect failed FTP login attempts
              <p><strong>10:</strong> What is the number of detected packets?
              <p><strong>Important:</strong> "For this, I would recommend using this link: https://tinyurl.com/ms9njv75
              <img src="530login.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect successful FTP logins
              <p><strong>11:</strong> What is the number of detected packets?
              <img src="230.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with a valid username but no password entered yet.
              <p><strong>12:</strong> What is the number of detected packets?
              <img src="331.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
              <p><strong>FTP:</strong> Write a rule to detect FTP login attempts with the "Administrator" username but no password entered yet.
                <p><strong>13:</strong> What is the number of detected packets?
                <img src="ADMINYAYA.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

        <!-- Toggle Button for Solution -->
        <button class="solution-button" onclick="toggleSolution('room5', event)">Show Solution</button>
    </div>
</div>

<!-- Room 12 -->
<div class="room-section">
  <h2 onclick="toggleContent('room12')" style="display: flex; align-items: center;">
    Our First Dashboard & Visualization
    <img src="siem.png" alt="Dashboard Image" style="width: 100px; height: 40px; margin-left: 0.5px;">
  </h2>
  

  <div id="room12" class="collapsible-content">
      <img src="firstsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> Dashboards in SIEM systems act as frameworks that hold various visualizations, enabling us to structure and present data in an insightful and organized manner.</p>

      <div class="solution-section" id="solution-room12" style="display: none;">
        <h3>1. Create a new Dashboard</h3>
        <img src="newdashboardsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <h3>2. Create a new visualization.</h3>
        <img src="newvisualization.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>When we begin creating our first visualization, a new window will open, offering various options and settings to choose from.</p>
        <p><strong>Important:</strong>Before configuring anything, we should first click the calendar icon to access the time picker. Next, we need to set the date range to "last 15 years." Once that's done, we can click the "Apply" button to apply the selected date range to the data.</p>
        <img src="befosiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="https://academy.hackthebox.com/storage/modules/211/visualization1.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>This window offers <strong>four key elements</strong> to explore. One of the most important features is the <strong>filtering option</strong>, which allows us to refine the data before creating a graph.</p>

        <ul>
          <img src="filsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>For example, if we want to focus on failed login attempts, we can set a filter to include only events with the specific ID <strong>4625</strong>, which represents failed logon attempts on a Windows system. The image below demonstrates how such a filter can be applied.</p>
          <li><strong>1. Filtering option:</strong> Customize the data to match specific criteria before visualization.</li>
          <li>Focus on event ID <strong>4625</strong> for failed logon attempts.</li>
        </ul>
        

        <img src="windotab2siemp.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">

        <p>This field represents the <strong>data set (index)</strong> that will be used. Typically, data from various infrastructure sources is organized into separate indices, such as <strong>network</strong>, <strong>Windows</strong>, or <strong>Linux</strong>.</p>

        <p>In this example, we will define <strong>windows*</strong> as the value for the "Index pattern" to focus specifically on Windows-related data.</p>

        <ul>
          <li><strong>Purpose:</strong> Select the appropriate data set to analyze.</li>
          <li><strong>Example:</strong> Use <code>windows*</code> to capture data from Windows systems.</li>
        </ul>

        <img src="usesiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>The <strong>search bar</strong> enables us to verify the presence of a specific field within our data set, acting as a helpful tool to ensure we're analyzing the correct data.</p>

        <p>For instance, if we are interested in the <code>user.name.keyword</code> field, we can use the search bar to check if this field exists and has been detected in the selected data set. This process confirms that we are accessing the right field and working with precise data.</p>

        <ul>
          <li><strong>Function:</strong> Double-check the availability of specific fields.</li>
          <li><strong>Example:</strong> Search for <code>user.name.keyword</code> to verify its existence.</li>
        </ul>
        <p>Why use </p>
        <div class="terminal">
          <span class="prompt"></span> user.name.keyword
        </div>
        <p>instead of</p> 
        <div class="terminal">
          <span class="prompt">$</span> user.name
        </div>
          <p>You might wonder. The answer lies in how <strong>aggregations</strong> work. When performing aggregations, it is recommended to use the <code>.keyword</code> version of the field.</p>

          <p>For a more detailed explanation, you can check out this related discussion on Stack Overflow. https://tinyurl.com/aggregationssiem</p>

          <p>The Stack Overflow discussion explores the difference between <strong>fields</strong> and the <span class="keyword">Field</span> class in Java. Here's a brief explanation:</p>

          <ul>
            <li><strong>Fields:</strong> These are variables declared within a class, used to store data. They can be primitive types (e.g., <span class="keyword">int</span>, <span class="keyword">boolean</span>) or reference types (e.g., objects of other classes).</li>
            <li><strong><span class="keyword">Field</span> class:</strong> Java doesn't have a "Field" keyword, but it includes a <span class="keyword">Field</span> class in the <span class="keyword">java.lang.reflect</span> package. This class is part of Java's reflection API and allows dynamic inspection and modification of class fields at runtime.</li>
          </ul>

          <p>The key distinction is that <strong>fields</strong> are fundamental components of a class, while the <span class="keyword">Field</span> class is a specialized tool for performing runtime operations like accessing or altering fields dynamically.</p>
          <p><strong>For Example:</strong></p>
          <div class="terminal">
            <span class="prompt">$</span> some_field
          </div>
          <p>and</p>
          <div class="terminal">
            <span class="prompt">$</span> some_field.keyword
          </div>
          <p>Another interesting read would be this link: https://tinyurl.com/Textvskeyword</p>
          <p>Finally, this <strong>drop-down menu</strong> lets us choose the type of visualization we want to create. The default option shown in the previous image is <span class="keyword">"Bar vertical stacked"</span>.</p>

          <p>Clicking on this button will reveal additional options (the image has been redacted as not all options are visible on the screen). From this expanded list, we can select the visualization type that best suits our needs and data presentation goals.</p>
          <img src="bar4.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>For this visualization, we will pick the <span class="keyword">"Table"</span> option. Once we've selected <span class="keyword">"Table"</span>, the next step is to click on the <span class="keyword">"Rows"</span> option.</p>

          <p>This allows us to specify which data elements we want to display within the table format.</p>
          <img src="tablsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Let's configure the "Rows" settings as follows.</p>
          <img src="rowinsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>Note:</strong> You might see "Rank by Alphabetical" instead of "Rank by Count of records" as shown in the earlier screenshot. This is completely fine. Once you proceed with the next configuration, the option to rank by "Count of records" will become available.</p>
          <p>in the "Metrics" window, let's select "count" as the desired metric.</p>
          <img src="countmetrisiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Once we choose "Count" as the metric, we will see the table fill with data, provided there are events available in the selected data set.</p>
          <img src="visualizationsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>The last step in customizing the table is to add another "Rows" setting to display the machine where the failed logon attempt took place. To achieve this, we will choose the <span class="keyword">host.hostname.keyword</span> field, which indicates the computer that logged the failed attempt. This will enable us to show the hostname or machine name alongside the count of failed logon attempts, as demonstrated in the image.</p>
          <img src="newrowsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Now, the table displays three columns with the following details:</p>
          <ul>
            <li>The usernames of individuals attempting to log in (Note: Currently, both user and computer accounts are shown. Ideally, a filter should be applied to exclude computers and display only users).</li>
            <li>The machine where the logon attempt took place.</li>
            <li>The count of how many times the event occurred, based on the selected time frame or the entire data set, depending on the configuration.</li>
          </ul>

          <p>Finally, click on <span class="keyword">"Save and return"</span>, and you’ll see the new visualization added to the dashboard, as illustrated in the next image.</p>
          <img src="savenadreturnsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Let's not forget to save the dashboard as well. We can do so by simply clicking on the "Save" button.</p>
          <img src="myfirstdashboardsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <img src="dashbaordsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <h3>let's refine the visualization</h3>
          <img src="refininigsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Let's now click on the "gear" button at the upper-right corner of our visualization, and then click on "Edit lens".</p>
          <img src="editeamssiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Top values of user.name.keyword" should be changed as follows</p>
          <img src="valueunersiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <img src="chaningsiemrow.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Top values of host.hostname.keyword" should be changed as follows</p>
          <img src="chanignseconrow.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>The "Logon Type" can be added as follows (we will use the winlog.logon.type.keyword field)</p>
          <img src="newrowlog.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Count of records" should be changed as follows.</p>
          <img src="chngingmetrixsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>We can introduce result sorting as follows</p>
          <img src="sortsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>All we have to do now is click on "Save and return"</p>
          <p><strong>The DESKTOP-DPOESND, WIN-OK9BH1BCKSD, and WIN-RMMGJA7T9TC</strong> usernames can be excluded by specifying additional filters as follows.</p>
          <img src="filterout.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <img src="filteroutcomplete.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Computer accounts can be excluded by specifying the following KQL query and clicking on the "Update" button</p>
          <div class="terminal">
            <span class="prompt">$</span> NOT user.name: *$ AND winlog.channel.keyword: Security
          </div>
          <p>The AND <strong>winlog.channel.keyword: Security</strong> part is to ensure that no unrelated logs are accounted for.</p>
          <img src="rulefilterinsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>This is our visualization after all the refinements we performed.</p>
          <p>Finally, let's give our visualization a title by clicking on "No Title"</p>
          <img src="titleforsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Don't forget to click on the "Save" button (the one on the upper-right hand side of the window)</p>
          <h3>Failed Logon Attempts (Disabled Users)</h3>
        <p>A prebaked dashboard should be visible. Let's click on the "pencil"/edit icon.</p>
        <img src="editdasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>To start building our first visualization, just click the "Create visualization" button.</p>
        <img src="createnewvisualizasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>When you begin creating your first visualization, a new window will open, presenting a range of options and settings for customization.</p>
        <img src="newvisusiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>In this window, there are four key elements to focus on:</p>
        <ul>
          <img src="disabledusers.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <li><strong>1:</strong> A filter option that lets us narrow down the data before generating a graph. For instance, our goal here is to showcase failed logon attempts specifically targeting disabled users. To achieve this, we can set up a filter that includes event IDs corresponding to 4625—representing failed logon attempts on Windows systems, similar to what we did in the previous visualization. However, in this scenario, we also need to factor in the SubStatus field (winlog.event_data.SubStatus), which should be set to 0xC0000072 to indicate that the logon failure is due to a disabled user. The image below illustrates how to configure this filter.</li>
          <img src="windowsbarsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <li><Strong>2:</Strong> This field determines the dataset, or index, that will be utilized. Data from different infrastructure components is often organized into distinct indices, such as those for network activity, Windows systems, Linux systems, and so on. For this example, we’ll define windows* in the "Index pattern" to focus on Windows-related data.</li> 
          <img src="searchbar.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <li><Strong>3:</Strong> The search bar allows us to verify whether a specific field exists within our dataset. It serves as a useful tool to ensure we're examining the right data. For instance, similar to the previous visualization, we are focused on the user.name.keyword field. By using the search bar, we can quickly check if this field is available and identified within the chosen dataset. This step helps confirm that we're accessing the correct field and working with reliable data.</li>
          <img src="barverticalsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <li><strong>4:</strong> Finally, this drop-down menu allows us to choose the type of visualization we wish to create. The default setting, as shown earlier, is "Bar vertical stacked." By clicking on this menu, a list of additional visualization options will appear (not fully shown in the image due to screen size). From this list, we can select the visualization style that best matches our data and presentation goals.</li>
        </ul>
        <p>We’ll begin by choosing the "Table" option. Once it’s selected, we can move on to click the "Rows" option. This step enables us to specify the particular data elements we want to display in the table view.</p>
        <p>Let's configure the "Rows" settings as follows.</p>
        <img src="editingrowinsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="chaningcount.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>To enhance the table further, we can add another "Rows" setting to display the machine where the failed logon attempt took place. For this, we’ll select the host.hostname.keyword field, which identifies the computer that reported the failed logon. This addition will let us show the hostname or machine name alongside the number of failed logon attempts.</p>
        <img src="nerowsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>The table now displays three columns, each providing the following details:</p>
        <ul>
          <li>The disabled user whose credentials triggered the failed logon attempt.</li>
          <li>The machine where the logon attempt was made.</li>
          <li>The frequency of these events, calculated based on the selected time frame or the entire dataset, depending on the configuration.</li>
        </ul>
        <p>To finish, click on "Save and return," and you’ll see the newly created visualization added to the dashboard.</p>
        <p><Strong>1:</Strong> What is the logon type indicated in the returned document for failed logon attempts involving disabled users?</p>
        <p>I would add the search field name to the row: <Strong>winlog.logon.type.keyword</Strong></p>
        <p><Strong>2:</Strong> What should you specify after user.name: in the KQL query to include failed logon attempt data where the username field contains the keyword "admin" anywhere within it?</p>
        <p>I would add this KQL query: <strong>user.name: *admin*</strong></p>

        <h3>Successful RDP Logon Related To Service Accounts</h3>
        <p>Our goal is to develop a visualization that tracks successful RDP logins, specifically for service accounts. In typical corporate or real-world settings, service account credentials are not utilized for RDP logins,all service accounts on the environment start with svc-.</p>
        <p>A prebaked dashboard should be visible. Let's click on the "pencil"/edit icon.</p>
        <img src="editdasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>To start building our first visualization, just click the "Create visualization" button.</p>
        <img src="createnewvisualizasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>When you begin creating your first visualization, a new window will open, presenting a range of options and settings for customization.</p>
        <img src="newvisusiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>In this window, there are five key elements to focus on:</p>
        <p><strong>1:</strong> We need a filter option to refine the data before generating a graph. Our objective is to visualize successful RDP logins that are specifically associated with service accounts. To achieve this, we can filter for event IDs corresponding to 4624 – "An account was successfully logged on." Additionally, we must consider the logon type, which should be RemoteInteractive (found in the winlog.logon.type field). The following images show how we can apply these filters.</p>
        <img src="rdproomsiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="Remoteinteractivesiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>This field specifies the data set (index) we plan to use. Typically, data from different infrastructure sources is stored in separate indices, such as network, Windows, Linux, etc. For this example, we will set the "Index pattern" to windows*.</p>
        <p>The search bar allows us to verify the presence of a specific field in our data set, providing an additional method to ensure we are working with the correct data. In this case, we are focusing on the user.name.keyword field. By using the search bar, we can quickly check if this field is available and recognized within the chosen data set, confirming that we are accessing the right field and using accurate data.</p>
        <img src="searchbarsiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>Finally, this drop-down menu lets us choose the type of visualization to create. The default option shown in the previous image is "Bar vertical stacked." Clicking on this button will display more available options (the image has been redacted as not all options fit on the screen). From this extended list, we can select the visualization type that best aligns with our needs and how we want to present the data.</p>
        <img src="barverticalsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>We’ll begin by choosing the "Table" option. Once it’s selected, we can move on to click the "Rows" option. This step enables us to specify the particular data elements we want to display in the table view.</p>
        <p>Let's configure the "Rows" settings as follows.</p>
        <img src="editingrowinsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="chaningcount.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>The last step is to add two additional "Rows" settings to the table: one to display the machine where the successful RDP logon took place and the other for the machine that initiated the successful logon. To achieve this, we will select the host.hostname.keyword field, which identifies the machine reporting the logon, and the related.ip.keyword field, which represents the IP address of the machine that initiated the logon attempt. This will allow us to show the relevant machines along with the count of successful logon attempts, as illustrated in the image.</p>
        <img src="hostnamekesiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="ipnamesiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>We aim to track successful RDP logins specifically associated with service accounts, with the understanding that all service account names in the environment begin with "svc-</p>
        <img src="kqlsiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p><strong>Note:</strong> As you can see we don't use the .keyword field in KQL queries.</p>
        <p>The table now displays four columns, each providing the following details:</p>
        <ul>
          <li>The service account responsible for the successful RDP logon event.</li>
          <li>The machine where the logon attempt took place.</li>
          <li>The IP address of the machine that initiated the logon attempt.</li>
          <li>The count of occurrences of the event (based on the selected time period or the entire data set, depending on the settings).</li>
        </ul>
        <p>Afterward, click "Save and return," and you will see the newly created visualization added to the dashboard.</p>
        <h3>Users Added Or Removed From A Local Group (Within A Specific Timeframe)</h3>
        <p>Our goal is to develop a visualization that tracks changes to the local "Administrators" group, specifically focusing on user additions or removals, from March 5th, 2023, to the present.</p>
        <p>The visualization will be based on the following Windows event logs:</p>
        <ul>
          <li><a href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4732" target="_blank">4732: A member was added to a security-enabled local group</a></li>
          <li><a href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4733" target="_blank">4733: A member was removed from a security-enabled local group</a></li>
        </ul>
        <p>A prebaked dashboard should be visible. Let's click on the "pencil"/edit icon.</p>
        <img src="editdasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>To start building our first visualization, just click the "Create visualization" button.</p>
        <img src="createnewvisualizasiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>When you begin creating your first visualization, a new window will open, presenting a range of options and settings for customization.</p>
        <img src="newvisusiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>In this window, there are five key elements to focus on:</p>
        <p>We have a filtering option that lets us refine the data before generating a graph. In this case, we aim to display changes involving user additions or removals from the local "Administrators" group. We can apply a filter to include only event IDs 4732 (member added to a security-enabled local group) and 4733 (member removed from a security-enabled local group). Additionally, we can filter the data further to focus specifically on these events where the local group in question is the "Administrators" group.</p>
        <img src="eventcode.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="eventcodeadminitartor.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>This field specifies the data set (index) we plan to use. Typically, data from different infrastructure sources is stored in separate indices, such as network, Windows, Linux, etc. For this example, we will set the "Index pattern" to windows*.</p>
        <p>The search bar allows us to verify the presence of a specific field in our data set, providing an additional method to ensure we are working with the correct data. In this case, we are focusing on the user.name.keyword field. By using the search bar, we can quickly check if this field is available and recognized within the chosen data set, confirming that we are accessing the right field and using accurate data.</p>
        <img src="searchbarsiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="barverticalsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>We’ll begin by choosing the "Table" option. Once it’s selected, we can move on to click the "Rows" option. This step enables us to specify the particular data elements we want to display in the table view.</p>
        <p>Let's configure the "Rows" settings as follows.</p>
        <img src="editingrowinsiem.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="chaningcount.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>The final step in enhancing the table is to add more "Rows" settings for a better understanding of the data:</p>
        <ul>
          <li>Which user was added or removed from the group? (using the winlog.event_data.MemberSid.keyword field)</li>
          <li>To which group was the action performed? (ensuring it’s the "Administrators" group) (using the group.name.keyword field)</li>
          <li>Was the user added or removed from the group? (using the event.action.keyword field)</li>
          <li>On which machine did the action take place? (using the host.name.keyword field)</li>
        </ul>
        <img src="moremorerows.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <p>As mentioned earlier, our goal is to track user additions or removals from the local "Administrators" group over a defined period, from March 5th, 2023, to the present</p>
        <p>We can refine the focus of our visualization in the following ways.</p>
        <img src="moreoptionssiem.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="customizetimerange.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <img src="cuztomizepaneltimerange.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        <h2>What Is Alert Triaging?</h2>

        <p>Alert triaging is a process performed by a Security Operations Center (SOC) analyst where security alerts from monitoring systems are assessed and prioritized. The objective is to determine the threat level and potential impact of these alerts on an organization’s systems and data. The analyst reviews and categorizes the alerts, enabling the organization to allocate resources efficiently and take appropriate action in response to security incidents.</p>

        <p>A key part of alert triaging is escalation. This involves notifying higher-level teams or individuals, such as supervisors or incident response units, who are authorized to make decisions and lead the response efforts. The SOC analyst provides detailed insights about the alert, including its severity and impact, along with findings from the preliminary investigation. This helps decision-makers determine the best course of action, such as involving specialized teams or initiating broader incident response procedures.</p>

        <p>Escalation ensures that critical alerts are promptly addressed and allows for effective coordination between teams. This enables the organization to respond efficiently and in a timely manner to potential threats, leveraging the expertise of those responsible for managing and mitigating more complex or high-level incidents.</p>

        <h2>What Is The Ideal Triaging Process?</h2>

        <ol>
          <li><strong>Initial Alert Review:</strong>
            <p>Analyze the alert’s details such as timestamps, source/destination IPs, affected systems, and the rule/signature that triggered the alert. Investigate related logs to understand the full context of the alert.</p>
          </li>
          
          <li><strong>Alert Classification:</strong>
            <p>Use the organization’s established system to classify the alert based on its severity, potential impact, and urgency.</p>
          </li>
          
          <li><strong>Alert Correlation:</strong>
            <p>Compare the alert with other similar events or incidents to identify patterns, connections, or possible indicators of compromise (IOCs). Use SIEM systems and threat intelligence to gather more relevant data and cross-check known attack methods.</p>
          </li>
          
          <li><strong>Enrichment of Alert Data:</strong>
            <p>Enhance the alert by gathering additional data such as network packet captures, memory dumps, or analyzing suspicious files. Use external tools, intelligence sources, or sandboxes for further investigation of suspicious files or IP addresses.</p>
          </li>
          
          <li><strong>Risk Assessment:</strong>
            <p>Evaluate the possible risk to the organization’s critical assets, data, or infrastructure, considering compliance requirements and the sensitivity of the affected systems. Assess how likely a successful attack could be and the chances of further escalation within the network.</p>
          </li>
          
          <li><strong>Contextual Analysis:</strong>
            <p>Take into account the context of the affected assets, their importance, and the type of data they handle. Review the security measures in place to determine if the alert indicates a failure in controls or an attempt to bypass security. Ensure compliance and regulatory standards are considered in the context of the alert.</p>
          </li>
          
          <li><strong>Incident Response Planning:</strong>
            <p>For significant alerts, begin an incident response plan by documenting key details, including systems impacted, behaviors, and any gathered intelligence. Assign roles and responsibilities within the incident response team and coordinate with other relevant departments.</p>
          </li>
          
          <li><strong>Consultation with IT Operations:</strong>
            <p>Engage with IT or other departments to gather further context or missing information. Discuss whether any ongoing activities or system changes could explain the alert, and gain insights on potential non-malicious causes.</p>
          </li>
          
          <li><strong>Response Execution:</strong>
            <p>Based on the assessment and consultation, determine the appropriate response. If the alert is found to be non-malicious, resolve the issue without escalation. If it remains a security concern, initiate the necessary response actions.</p>
          </li>
          
          <li><strong>Escalation:</strong>
            <p>Identify escalation triggers based on the organization's policies and the alert's severity. Triggers may include critical system compromise, ongoing attacks, sophisticated techniques, or insider threats. Follow the internal escalation procedure and notify the appropriate teams or management. In some situations, escalate to external entities, like CERTs or law enforcement, if required by legal or regulatory standards.</p>
          </li>
          
          <li><strong>Continuous Monitoring:</strong>
            <p>Keep monitoring the situation, ensuring there’s ongoing communication with escalated teams. Collaborate for a well-coordinated response to the ongoing incident.</p>
          </li>
          
          <li><strong>De-escalation:</strong>
            <p>Once the risk is mitigated and the incident is under control, assess whether de-escalation is necessary. Notify relevant stakeholders of the resolution, sharing a summary of actions, outcomes, and any lessons learned. Periodically review and update the triaging and escalation processes to keep them in line with emerging threats and changing organizational needs.</p>
          </li>
        </ol>

      </div>

      <!-- Toggle Button for Solution -->   
      <button class="solution-button" onclick="toggleSolution('room12', event)">Show Solution</button>
  </div>
</div>

<!-- Room 13 -->
<div class="room-section">
  <h2 onclick="toggleContent('room13')">
    </i> Learning C <i class="fa fa-code"></i>
  </h2>  
  <div id="room13" class="collapsible-content">
      <img src="cprogr.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> I’m about to start learning C to enhance my ability to reverse engineer malware and analyze threats at a system level. This knowledge will be essential for my SOC career, allowing me to better understand how malware operates, detect IOCs and IOAs, and build more effective detection and response strategies. By mastering C, I aim to sharpen my skills in identifying vulnerabilities and dissecting malicious code to improve security operations.</p>

      <div class="solution-section" id="solution-room13" style="display: none;">
          <p>The <strong>printf</strong> function supports special format specifiers, which allow to output numbers and  output formatting</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {<br>
                  <span class="keyword">printf</span>(<span class="string">"%d"</span>, <span class="number">256</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p><strong>%d</strong> is the format specifier, which denotes that a whole number is expected</p>
          <h3>floating point numbers</h3>
          <p><strong>%f</strong> is used to output floating point numbers</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {<br>
                  <span class="keyword">printf</span>(<span class="string">"%f"</span>, <span class="number">256</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p><strong>%c</strong> denotes a single character, while <strong>%s</strong> is used for strings</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {<br>
                  <span class="keyword">printf</span>(<span class="string">"%c"</span>, <span class="number">'G'</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p>Single characters need to be enclosed in<strong> single quotes</strong>, while strings use <strong>double quotes</strong>.</p>

          <p>you can use a combination of multiple specifiers and text in the printf() function</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {<br>
                  <span class="keyword">printf</span>(<span class="string">"Score: %f. Level: %d"</span>, <span class="number">50.2, 2</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p>Each format specifier in replaced by the corresponding value, provided to printf() separated by commas</p>
          <h3>add a new line after the output</h3>
          <p>the special character <strong>\n</strong> is used to create a new line in the output.</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {<br>
                  <span class="keyword">printf</span>(<span class="string">"Name: %s\n"</span>, <span class="number">"Tobias"</span>);<br>
                  <span class="keyword">printf</span>(<span class="string">"Age: %d"</span>, <span class="number">51</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p><strong>Note:</strong> You can use as many \n characters as you need</p>
          <p><strong>key points:</strong></p>
          <ul>
            <li>%d is for whole numbers</li>
            <li>%f is for floating point numbers</li>
            <li>%c is for single characters</li>
            <li>%s is for strings</li>
          </ul>
          <p>Remember to provide the corresponding values for each specifier, separated by commas, \n is a special character used to insert a new line into the output</p>
          <h3>Variables</h3>
          <p><strong>Description:</strong>A variable lets you store a value by assigning it to a name.</p>
          <p>Each variable has a specific category, called its type, that determines what kind of data it can store. For example, a variable might store words or text, whole numbers, decimal values, or other kinds of information.</p>
          <p>For Example</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">int</span> level; 
            </div>
          </div>
          <p>The <strong>int</strong> type is used to store whole numbers, which are numbers without any fractional or decimal parts. In programming, these are commonly referred to as integers.</p>
          <p>Once we declare a variable, we can give it a value by using the = symbol, which is called the assignment operator.</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">int</span> level; 
              <span class="keyword">level = </span>204;
            </div>
          </div>
          <p>We can display or print the value stored in our variable.</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {
                  <span class="string">int </span>= level
                  <span class="keyword">level = </span>, <span class="number">204</span><br>
                  <span class="keyword">printf</span>(<span class="string">"%d"</span>, <span class="keyword">level</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p>We used the <strong>%d</strong> format specifier because score is an integer. The <strong>printf</strong> function then replaces <strong>%d</strong> with the value of score when displaying the output.</p>
          <p>We can declare a variable and assign it a value at the same time, like this:</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {
                  <span class="string">int </span>level = <span class="number">204</span><br>
                  <span class="keyword">printf</span>(<span class="string">"%d"</span>, <span class="keyword">level</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
          <p>The value of a variable can be updated or changed multiple times while the program is running.</p>
          <div class="ide-terminal">
            <div class="ide-prompt">C</div>
            <div class="ide-code">
              <span class="keyword">#include</span> &lt;stdio.h&gt;<br>
              <span class="keyword">int</span> main() {
                  <span class="string">int </span>level = <span class="number">204</span>
                  <span class="keyword">level =</span> <span class="number">404</span>
                  <span class="keyword">printf</span>(<span class="string">"%d"</span>, <span class="keyword">level</span>);<br>
                  <span class="keyword">return</span> <span class="number">0</span>;<br>
              }<br>
            </div>
          </div>
        </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room13', event)">Show Solution</button>
  </div>
</div>

<!-- Room 15 -->
<div class="room-section">
  <h2 onclick="toggleContent('room15')">
     PicoCtf: Web Exploitation (NoSql) <i class="fas fa-database"></i>
</h2>
  <div id="room15" class="collapsible-content">
      <img src="nosqlpicoctf.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> NoSQL injection is a vulnerability where an attacker is able to interfere with the queries that an application makes to a NoSQL database. NoSQL injection may enable an attacker to:

        - Bypass authentication or protection mechanisms.
        - Extract or edit data.
        - Cause a denial of service.
        - Execute code on the server.
        
        NoSQL databases store and retrieve data in a format other than traditional SQL relational tables. They use a wide range of query languages instead of a universal standard like SQL, and have fewer relational constraints.</p>
        
      <p><strong>Challenge Approach:</strong> Can you try to get access to this website to get the flag?</p>

      <div class="solution-section" id="solution-room15" style="display: none;">
          <img src="nosqlpicoctflogin.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>Info:</strong> We have this login interface, but we need to bypass it. They also provided us with a file named server.js. Once inside this file, we can see information that we can use. For example, there is an email that we will use. We are interacting with a mongodb-memory-server.</p>
          <img src="possicredentialspicoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <img src="possfilterpicoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>Info:</strong> We can also see that there is a filter for the email input and password input, which we will look into later.</p>
          <img src="errorcredentialspicoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p><strong>Info:</strong> Let's use this email. We don't know the password yet, so we are going to get an error first.</p>
          <p>Let's explore possible payloads we can use for the password. Once we find one that works for the password input, I'll use this: {"$ne": null}.</p>
          <p><strong>Description:</strong> When you use {"$ne": null} in a MongoDB query, you're asking the database to return documents where the field being queried does not have a value of null.</p>
          <img src="burpsuitefapicoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <img src="bypasslogipicoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <p>Let's use Burp Suite for this. When we use {"$ne": null}, we get this error: {"success": false, "error": "password.startsWith is not a function"}. This is what I was talking about—the possible filter we saw in the image above, where the email starts or ends with { or }, and the same applies to the password. We need to bypass this by using \, like this: {\"$ne\": null}. As you can see, we were able to log in without a password and bypassed the login page. Now, for this challenge, the token key is the flag, which is encoded in base64. So, we decode it and get the flag.</p>
          <img src="flagbase6picoctf.PNG" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
        </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room15', event)">Show Solution</button>
  </div>
</div>

<!-- Room 18 -->
<div class="room-section">
  <h2 onclick="toggleContent('room18')">CryptoHack <i class="fas fa-lock"></i></h2>
  <div id="room18" class="collapsible-content">
      <img src="cryptohack.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> CryptoHack is a hands on platform where you can learn cryptography by solving fun and challenging puzzles. It covers everything from simple ciphers to more complex encryption techniques, helping you understand both the basics and the more advanced concepts of cryptography. Whether you're just starting out or already have some experience, CryptoHack is a great way to build your skills, all while enjoying the process.</p>
      <p><strong>Challenge Approach:</strong> Let's solve the Cryptohacks challenge.</p>


      <div class="solution-section" id="solution-room18" style="display: none;">
          <h3>ASCII</h3>
          <p><strong>Background: </strong> ASCII - is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p>
          <p><strong>Challenge: </strong> Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.</p>
          <p>[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]</p>
          <p><strong>Tip:</strong> In Python, the chr() function can be used to convert an ASCII ordinal number to a character (the ord() function does the opposite).</p>
          <div class="ide-terminal">
            <div class="ide-prompt">Python</div>
            <div class="ide-code">
              <span class="line"><span class="keyword">ascii_values =</span> [<span class="number">99</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">123</span>, <span class="number">65</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">73</span>, <span class="number">73</span>, <span class="number">95</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">52</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">51</span>, <span class="number">125</span>]</span><br>
              <span class="comment"># This is the list of ASCII values</span><br>
              <span class="line"><span class="keyword">flag =</span> ''.join([chr(value) for value in ascii_values])</span><br>
              <span class="comment"># ''.join() Method, The join() method is used to combine (join) elements of an iterable (like a list or tuple) into a single string, ''.join() means we are joining the elements with an empty string as the separator, '' is the separator, meaning there will be no space or other character between the joined elements.</span><br>
              <span class="line"><span class="keyword">print</span>(<span class="string">'This is your flag: ' + </span><span class="keyword"> flag</span>)</span><br>
              <span class="comment"># Display the flag</span><br>
            </div>
          </div>

          <h3>Hex</h3>
          <p><strong>Background: </strong> When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it's common to encode it into something more user-friendly and portable across different systems.</p>
          <p><strong>Challenge: </strong> Included below is a flag encoded as a hex string. Decode this back into bytes to get the flag.</p>
          <p>63727970746f7b596f755f77696c6c......more</p>
          <p><strong>Tip:</strong> In Python, the bytes.fromhex() function can be used to convert hex to bytes. The .hex() instance method can be called on byte strings to get the hex representation.</p>
          <div class="ide-terminal">
            <div class="ide-prompt">Python</div>
            <div class="ide-code">
              <span class="line"><span class="keyword">hex_values =</span> "<span class="number">63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d</span>"<br>
              <span class="comment"># This is hex string values</span><br>
              <span class="line"><span class="keyword">bytes_data =</span> bytes.fromhex(hex_values)</span><br>
              <span class="comment"># Convert the hex string to bytes, In computer systems, data is often represented as bytes (8 bits), not as characters or numbers. The hex string is just a human-readable way of writing bytes. By converting the hex string to bytes, you're turning it back into the actual data that the computer can process, bytes.fromhex(): This method does the actual conversion of each pair of hexadecimal digits</span><br>
              <span class="line"><span class="keyword">flag =</span><span class="string"> bytes_data.decode('ascii')</span><br>
              <span class="comment"># Convert the bytes back to an ASCII string, The bytes you get from bytes.fromhex() are the raw data, but they need to be interpreted correctly to make sense to humans. If the data represents ASCII text, you need to convert the bytes back to human-readable characters.</span><br>
              <span class="line"><span class="keyword">print</span>(<span class="string">'This is your flag: ' + </span><span class="keyword"> flag</span>)</span><br>
              <span class="comment"># Display the flag</span><br>
            </div>
          </div>
      </div>

      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room18', event)">Show Solution</button>
  </div>
</div>

<!-- Room 19 -->
<div class="room-section">
  <h2 onclick="toggleContent('room19')"> Fingerprinting <i class="fas fa-fingerprint"></i> </h2>
  <div id="room19" class="collapsible-content">
      <img src="reconhacker.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
      <p><strong>Description:</strong> Fingerprinting is the process of identifying and gathering detailed information about a target system, such as its operating system, services, software versions, and hardware.</p>
      <p><strong>Challenge Approach:</strong> we'll explore how we can fingerprint different services like FTP, SMB, and more.</p>

      <div class="solution-section" id="solution-room19" style="display: none;">
          <p><strong>Info:</strong> FTP (File Transfer Protocol) is a standard network protocol used to transfer files between a client and a server over a TCP/IP network. FTP is commonly used for uploading and downloading files to and from web servers.</p>          
          <p>Let's try to log in as an anonymous user.</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp targetip<br>
            Connected to targetip.<br>
            220 (vsFTPd 3.0.5)<br>
            Name (targetip:bigbrooklyn): Anonymous<br>
            331 Please specify the password.<br>
            Password: <br>
            530 Login incorrect.<br>
            ftp: Login failed<br>
            ftp>
          </div>
          <p>In this case, it doesn't allow logging in as anonymous. Let's change some settings to allow me to log in as an anonymous user.</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp targetip<br>    
            Connected to targetip.<br>   
            220 (vsFTPd 3.0.5)<br>   
            Name (targetip:bigbrooklyn): Anonymous<br>   
            331 Please specify the password.<br>   
            Password: <br>   
            230 Login successful.<br>   
            Remote system type is UNIX.<br>   
            Using binary mode to transfer files.<br>   
            ftp> 
          </div>
          <p>In this case, it allows logging in as an anonymous user.</p>
          <p>We always have to make sure that <Strong>anonymous_enable=NO</Strong> is set to NO </p>
          <p>If we enumerate FTP, in my case, we are not going to find anything.</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> ls<br>
            229 Entering Extended Passive Mode (|||6859|)<br>
            150 Here comes the directory listing.<br>
            226 Directory send OK.<br>
            ftp> 
          </div>
          <p>let's get an overview of the vsFTPd status:</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> status<br>
            Connected and logged into targetip.<br>
            No proxy connection.<br>
            Gate ftp: off, server (none), port ftpgate.<br>
            Passive mode: on; fallback to active mode: on.<br>
            Mode: stream; Type: binary; Form: non-print; Structure: file.<br>
            Verbose: on; Bell: off; Prompting: on; Globbing: on.<br>
            Store unique: off; Receive unique: off.<br>
            Preserve modification times: on.<br>
            Case: off; CR stripping: on.<br>
            Ntrans: off.<br>
            Nmap: off.<br>
            Hash mark printing: off; Mark count: 1024; Progress bar: on.<br>
            Get transfer rate throttle: off; maximum: 0; increment 1024.<br>
            Put transfer rate throttle: off; maximum: 0; increment 1024.<br>
            Socket buffer sizes: send 16384, receive 131072.<br>
            Use of PORT cmds: on.<br>
            Use of EPSV/EPRT cmds for IPv4: on.<br>
            Use of EPSV/EPRT cmds for IPv6: on.<br>
            Command line editing: on.<br>
            Version: tnftp 20230507<br>
            ftp>
          </div>
          <p>vsFTPd Detailed Output:</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> debug<br>
            Debugging on (debug=1).
            ftp> 
          </div>
          <br>
          <div class="terminal">
            <span class="prompt">$</span> ftp> trace<br>
            Packet tracing on.<br>
            ftp> 
          </div>
          <br>
          <div class="terminal">
            <span class="prompt">$</span> ftp> ls<br>
            ftp: setsockopt SO_DEBUG (ignored): Permission denied<br>
            ---> EPSV<br>
            229 Entering Extended Passive Mode (|||44279|)<br>
            229 Entering Extended Passive Mode (|||44279|)<br>
            ---> LIST<br>
            150 Here comes the directory listing.<br>
            226 Directory send OK.
          </div>
          <p>Let's see if <Strong>write_enable</Strong> is set to yes:</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> put myfile <br>
          local: myfile remote: myfile<br>
          229 Entering Extended Passive Mode (|||40849|)<br>
          550 Permission denied.<br>
          </div>
          <p>This is not the case, so let's change some configuration in the FTP so I can read files from a different user:</p>
          <pre><code>sudo nano /etc/vsftpd.conf</code></pre>

          <p><strong>Allow Directory Listing:</strong></p>
          <p>Ensure that anonymous users are allowed to list files:</p>
          <pre><code>list_enable=YES</code></pre>

          <p><strong>Set the Directory for Anonymous Access:</strong></p>
          <p>If you want to restrict anonymous users to a specific directory (e.g., /home/ftpuser/ or a subdirectory of it), set <code>anon_root</code>:</p>
          <pre><code>anon_root=/home/ftpuser/</code></pre>

          <p><strong>Make Files Readable but Not Writable by Anonymous Users:</strong></p>
          <p>You need to allow anonymous users to read the files uploaded by <code>ftpuser</code>, but not modify or upload their own files. To do this, ensure the following:</p>
          <pre><code>anon_world_readable_only=YES</code></pre>

          <p><strong>Allow Anonymous Users to Read, but Not Write:</strong></p>
          <p>Make sure that write access is disabled for anonymous users. You can enable this if you want anonymous uploads, but in this case, we don’t want them to upload files:</p>
          <pre><code>anon_upload_enable=NO</code></pre>

          <p><strong>Restart the Service:</strong></p>
          <pre><code>sudo systemctl restart vsftpd</code></pre>

          <p>After this, we need to give the proper permissions for the <code>ftpuser</code> directory:</p>

          <p><strong>Ensure Correct Ownership of /home/ftpuser/:</strong></p>
          <p>The <code>ftpuser</code> should own the directory where files are being uploaded, and the group should be <code>ftp</code> (or <code>www-data</code>, depending on your setup). You can check the ownership with:</p>
          <pre><code>sudo chown ftpuser:ftp /home/ftpuser/</code></pre>

          <p><strong>Set Permissions for /home/ftpuser/:</strong></p>
          <p>For anonymous users to read files, the directory permissions need to be set to allow read access to everyone, but write access only to <code>ftpuser</code>:</p>
          <pre><code>sudo chmod 755 /home/ftpuser/</code></pre>

          <p>This allows:</p>
          <ul>
            <li><code>ftpuser</code> to read, write, and execute in /home/ftpuser/.</li>
            <li>Anonymous users to read the files but not upload or delete files.</li>
          </ul>

          <p><strong>Ensure File Permissions Are Correct for Files Uploaded by ftpuser:</strong></p>
          <p>Any files uploaded by <code>ftpuser</code> should be readable by anonymous users. You should ensure that the files have the correct permissions (644 for most cases):</p>
          <pre><code>sudo chmod 644 /home/ftpuser/*</code></pre>

          <p><strong>Now, let's test the configuration:</strong></p>
          <p>As you can see on the server, I have a <code>secret.txt</code> file. Let's see if anonymous users can access this file on the FTP server:</p>
          <img src="secretserverkey.png" alt="Room 1 Demonstration" style="max-width: 100%; height: auto;">
          <div class="terminal">
            <span class="prompt">$</span> ftp> ls<br>
            229 Entering Extended Passive Mode (|||22372|)<br>
            150 Here comes the directory listing.<br>
            -rw-r--r--    1 1001     1001           23 Jan 19 14:50 secret.txt<br>
            226 Directory send OK.<br>
            ftp>
          </div>
          <p>We were able to see this file on the FTP server. Can we read it though?</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> more secret.txt<br>
            this is my private key<br>
            ftp>
          </div>
          <p>Yes, we can actually read it. Let's change this so anonymous users are able to list the file but not read its content:</p>

          <pre><code>sudo chmod 600 /home/ftpuser/secret.txt</code></pre>

          <p><strong>Explanation of <code>chmod 600</code>:</strong></p>
          <ul>
            <li><strong>6</strong> means read and write permissions for the owner (ftpuser).</li>
            <li><strong>0</strong> means no permissions for the group and others (which includes anonymous users).</li>
          </ul>

          <p>With these permissions, only ftpuser will be able to read or modify the file, and anonymous users will not have access to it.</p>

          <p>Now, let's try reading the file again:</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> more secret.txt<br>
            Failed to open file.<br>
            ftp> 
          </div>
          <p>we don't have permission to read this file, and they can't download it either.</p>
          <div class="terminal">
            <span class="prompt">$</span> ftp> get secret.txt<br>
            local: secret.txt remote: secret.txt<br>
            229 Entering Extended Passive Mode (|||14602|)<br>
            550 Failed to open file.<br>
            ftp> 
          </div>
          <p>As you can see, the anonymous user can see the ID 1001, which is the UID and GID representation of the service:</p>
          <div class="terminal">
            <span class="prompt"></span> -rw-------    1 1001     1001           23 Jan 19 14:50 secret.txt 
          </div>
          <p>Now, let's make it harder to identify with which rights these files are written and uploaded. We can do this by changing <Strong>hide_ids=YES</Strong></p>
          <div class="terminal">
            <span class="prompt"></span> ftp> ls<br>
            229 Entering Extended Passive Mode (|||36026|)<br>
            150 Here comes the directory listing.<br>
            -rw-------    1 ftp      ftp            23 Jan 19 14:50 secret.txt<br>
            226 Directory send OK.<br>
            ftp> 
          </div>
      
      
        </div>
      <!-- Toggle Button for Solution -->
      <button class="solution-button" onclick="toggleSolution('room19', event)">Show Solution</button>
      </div>
</div>

<script>
  function toggleContent(room) {
      var content = document.getElementById(room);
      content.style.display = (content.style.display === 'none' || content.style.display === '') ? 'block' : 'none';
  }

  function toggleSolution(room, event) {
      var solution = document.getElementById("solution-" + room);
      var button = event.target;

      if (solution.style.display === 'none' || solution.style.display === '') {
          solution.style.display = 'block';
          button.textContent = "Hide Solution";
      } else {
          solution.style.display = 'none';
          button.textContent = "Show Solution";
      }
  }

  // Read Aloud function
  let readAloudEnabled = false; // Flag to track if Read Aloud is on
  let toggleButton = document.getElementById('toggle-read-aloud');
  let voiceSelect = document.getElementById('voiceSelect');
  let pitch = document.getElementById('pitch');
  let rate = document.getElementById('rate');
  let voices = [];

  // Populate voice options
  function populateVoiceList() {
      voices = speechSynthesis.getVoices();
      voiceSelect.innerHTML = '';  // Clear existing options

      voices.forEach((voice, index) => {
          let option = document.createElement('option');
          option.value = index;
          option.textContent = `${voice.name} (${voice.lang})`;
          voiceSelect.appendChild(option);
      });

      // Set the default voice to the first one in the list (if available)
      if (voices.length > 0) {
          voiceSelect.selectedIndex = 82;  // Set the default selection to the first voice
      }
  }

  populateVoiceList();
  if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoiceList;
  }

  // Function to toggle Read Aloud feature
  function toggleReadAloud() {
      readAloudEnabled = !readAloudEnabled;

      if (readAloudEnabled) {
          toggleButton.classList.add('on');  // Add the 'on' class for green and power-on icon
          toggleButton.classList.remove('off'); // Remove 'off' class
      } else {
          toggleButton.classList.remove('on');  // Remove 'on' class for default appearance
          toggleButton.classList.add('off'); // Add 'off' class for red and power-off icon
      }
  }

  // Function to read selected text
  function readSelectedText() {
      const selectedText = window.getSelection().toString().trim();
      if (selectedText) {
          const speech = new SpeechSynthesisUtterance(selectedText);
          speech.voice = voices[voiceSelect.value];  // Use selected voice
          speech.pitch = pitch.value;
          speech.rate = rate.value;
          window.speechSynthesis.speak(speech);
      }
  }

  // Automatically read text when selected if Read Aloud is enabled
  document.addEventListener('mouseup', function() {
      if (readAloudEnabled) {
          readSelectedText();
      }
  });

  // Function to show content based on the URL hash (e.g., #room2)
  function checkRoomInUrl() {
      const hash = window.location.hash; // Get the current hash from the URL

      // Check if the URL hash matches a room (e.g., "#room1, #room2, etc.")
      const roomMatch = hash.substring(1); // Remove the '#' from the hash
      if (roomMatch && document.getElementById(roomMatch)) {
          toggleContent(roomMatch);  // Automatically show the room content if it matches
      }
  }

  // Call this function when the page loads or when the hash changes
  window.onload = function() {
      checkRoomInUrl(); // Check the URL hash when the page loads
  };

  // Listen for changes in the URL hash (when the user navigates through hash fragments)
  window.onhashchange = function() {
      checkRoomInUrl();
  };
</script>
</body>
</html>
